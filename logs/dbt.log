

============================== 2022-08-13 23:27:52.874166 | 7bf144e0-dd06-43ef-a43e-8c25850f7059 ==============================
[0m23:27:52.874193 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:27:52.875019 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:27:52.875468 [debug] [MainThread]: Tracking: tracking
[0m23:27:52.958204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b6e2e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b6e2e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b6e23f10>]}
[0m23:27:53.427645 [debug] [MainThread]: Executing "git --help"
[0m23:27:53.745994 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:27:53.746683 [debug] [MainThread]: STDERR: "b''"
[0m23:27:53.749326 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m23:27:53.750047 [debug] [MainThread]: Using redshift connection "debug"
[0m23:27:53.750581 [debug] [MainThread]: On debug: select 1 as id
[0m23:27:53.751090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:53.752627 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m23:27:55.835738 [debug] [MainThread]: SQL status: SELECT in 2.08 seconds
[0m23:27:55.838737 [debug] [MainThread]: On debug: Close
[0m23:27:55.840621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b5166a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b5166cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b5166f40>]}
[0m23:27:57.043526 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-14 00:28:14.611340 | b4ff67cf-71ea-454b-8b0e-7f2a448950f6 ==============================
[0m00:28:14.611364 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:28:14.612645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:28:14.613030 [debug] [MainThread]: Tracking: tracking
[0m00:28:14.699505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19225ac040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19225ac0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19225a1f40>]}
[0m00:28:15.171374 [debug] [MainThread]: Executing "git --help"
[0m00:28:15.188631 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:28:15.191633 [debug] [MainThread]: STDERR: "b''"
[0m00:28:15.194711 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m00:28:15.195354 [debug] [MainThread]: Using redshift connection "debug"
[0m00:28:15.195809 [debug] [MainThread]: On debug: select 1 as id
[0m00:28:15.196289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:15.196949 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:28:16.609939 [debug] [MainThread]: SQL status: SELECT in 1.41 seconds
[0m00:28:16.612296 [debug] [MainThread]: On debug: Close
[0m00:28:16.613680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19208c6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19208c6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19208c6c40>]}
[0m00:28:17.608139 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-14 00:31:25.051250 | a906edb8-8991-49bc-a6c0-ce96e8f20f46 ==============================
[0m00:31:25.051284 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:31:25.053877 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:31:25.055954 [debug] [MainThread]: Tracking: tracking
[0m00:31:25.093104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2135268280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2135268340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2135268370>]}
[0m00:31:25.213790 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m00:31:25.214382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213527bd90>]}
[0m00:31:25.443754 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:31:25.545555 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:31:25.585211 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:31:25.586888 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:31:25.590514 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:31:25.592491 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:31:25.601093 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:31:25.604846 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:31:25.606555 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:31:25.608089 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:31:25.610332 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:31:25.611424 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:31:25.612727 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:31:25.706240 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:31:25.712628 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:31:25.716131 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:31:25.722239 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:31:25.727441 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:31:25.730232 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:31:25.750468 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:31:25.751762 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:31:25.753446 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:31:25.758161 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:31:25.788558 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:31:25.832319 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:31:25.845476 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:31:25.853401 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:31:25.894387 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:31:25.902770 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:31:25.911318 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:31:25.932339 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:31:25.939725 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:31:25.943753 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:31:25.947207 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:31:25.976275 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:31:25.989824 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:31:25.991805 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:31:25.993799 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:31:25.995939 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:31:25.999527 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:31:26.007283 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:31:26.016768 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:31:26.024298 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:31:26.028828 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:31:26.042983 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:31:26.118100 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:31:26.140455 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:31:26.145147 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:31:26.178053 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:31:26.232949 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:31:26.275759 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:31:26.321511 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:31:26.372021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:31:26.404681 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:31:26.409816 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:31:26.428017 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:31:26.439658 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:31:26.443193 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:31:26.460453 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:31:26.466250 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:31:26.476361 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:31:26.496373 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:31:26.502677 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:31:26.509004 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:31:26.511305 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:31:26.514345 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:31:26.516859 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:31:26.519437 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:31:26.523430 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:31:26.527528 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:31:26.530340 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:31:26.536331 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:31:26.540708 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:31:26.543322 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:31:26.545932 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:31:26.548428 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:31:26.551363 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:31:26.555043 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:31:26.559725 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:31:26.577002 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:31:26.579165 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:31:26.581335 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:31:26.584183 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:31:27.379465 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m00:31:27.410573 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m00:31:27.633999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21351954f0>]}
[0m00:31:27.668711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213527bc40>]}
[0m00:31:27.669645 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:31:27.670508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213527bbe0>]}
[0m00:31:27.675780 [info ] [MainThread]: 
[0m00:31:27.678788 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m00:31:27.681915 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m00:31:27.748369 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m00:31:27.749170 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:31:27.749822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:27.750422 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:29.149868 [debug] [ThreadPool]: SQL status: SELECT in 1.4 seconds
[0m00:31:29.153392 [debug] [ThreadPool]: On list_dev: Close
[0m00:31:29.161546 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m00:31:29.181373 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:31:29.181734 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m00:31:29.182062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:29.182385 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:30.354591 [debug] [ThreadPool]: SQL status: BEGIN in 1.17 seconds
[0m00:31:30.355766 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:31:30.356556 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:31:30.486918 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m00:31:30.489848 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m00:31:30.624767 [debug] [ThreadPool]: On list_dev_public: Close
[0m00:31:30.637226 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:30.637590 [debug] [MainThread]: On master: BEGIN
[0m00:31:30.637949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:30.638314 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:31.729427 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m00:31:31.730834 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:31.732867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:31.896917 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m00:31:31.899015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213490c250>]}
[0m00:31:31.899637 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:32.020102 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:32.020518 [debug] [MainThread]: On master: BEGIN
[0m00:31:32.268969 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
[0m00:31:32.269489 [debug] [MainThread]: On master: COMMIT
[0m00:31:32.269836 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:32.270105 [debug] [MainThread]: On master: COMMIT
[0m00:31:32.398830 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m00:31:32.399380 [debug] [MainThread]: On master: Close
[0m00:31:32.400469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:32.401044 [info ] [MainThread]: 
[0m00:31:32.523238 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m00:31:32.523868 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
[0m00:31:32.524935 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:32.525462 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m00:31:32.525879 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m00:31:32.536164 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m00:31:32.540299 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:32.540938 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m00:31:32.759170 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m00:31:32.762714 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:32.763792 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m00:31:32.764380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:31:32.764714 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:33.959969 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
[0m00:31:33.960659 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:33.966664 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m00:31:34.518501 [debug] [Thread-1  ]: SQL status: SELECT in 0.55 seconds
[0m00:31:34.533389 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:34.533751 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m00:31:34.647923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m00:31:34.705818 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m00:31:34.706316 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:34.706634 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m00:31:34.866749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m00:31:34.867610 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:34.867896 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m00:31:34.989814 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m00:31:35.002630 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:35.003016 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m00:31:35.134221 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m00:31:35.135881 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m00:31:35.136199 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:35.136455 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m00:31:35.266667 [debug] [Thread-1  ]: SQL status: COMMIT in 0.13 seconds
[0m00:31:35.268212 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m00:31:35.268557 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m00:31:35.386685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m00:31:35.387968 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:35.388292 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m00:31:35.501293 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m00:31:35.502643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213491f3a0>]}
[0m00:31:35.503401 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.98s]
[0m00:31:35.504314 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m00:31:35.506672 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m00:31:35.507464 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
[0m00:31:35.508946 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:35.509734 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m00:31:35.510295 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m00:31:35.525859 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m00:31:35.527262 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:35.527739 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m00:31:35.612115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m00:31:35.612959 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:35.614377 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m00:31:35.615125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:31:35.616363 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:36.820134 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
[0m00:31:36.820573 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:36.820835 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m00:31:36.955177 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m00:31:36.964199 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:36.964670 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m00:31:37.095262 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m00:31:37.098990 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m00:31:37.099491 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:37.099948 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m00:31:37.239670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m00:31:37.240500 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:37.240760 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m00:31:37.368672 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m00:31:37.374126 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:37.374530 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m00:31:37.494630 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m00:31:37.496281 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m00:31:37.496593 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:37.496896 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m00:31:37.644904 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m00:31:37.645320 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m00:31:37.645593 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m00:31:37.766592 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m00:31:37.769136 [debug] [Thread-1  ]: finished collecting timing info
[0m00:31:37.769944 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m00:31:37.883418 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m00:31:37.884981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a906edb8-8991-49bc-a6c0-ce96e8f20f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21340682e0>]}
[0m00:31:37.887135 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.38s]
[0m00:31:37.888323 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m00:31:37.891092 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m00:31:37.891706 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:37.892141 [debug] [MainThread]: On master: BEGIN
[0m00:31:37.892571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:37.893075 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m00:31:39.293121 [debug] [MainThread]: SQL status: BEGIN in 1.4 seconds
[0m00:31:39.293572 [debug] [MainThread]: On master: COMMIT
[0m00:31:39.293930 [debug] [MainThread]: Using redshift connection "master"
[0m00:31:39.294198 [debug] [MainThread]: On master: COMMIT
[0m00:31:39.445792 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
[0m00:31:39.446315 [debug] [MainThread]: On master: Close
[0m00:31:39.503264 [info ] [MainThread]: 
[0m00:31:39.504335 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m00:31:39.505119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:39.505523 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m00:31:39.505961 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m00:31:39.541580 [info ] [MainThread]: 
[0m00:31:39.544553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:39.548233 [info ] [MainThread]: 
[0m00:31:39.555509 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:31:39.556871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213491f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21352d2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21352d2940>]}


============================== 2022-08-15 14:22:16.227249 | 9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff ==============================
[0m14:22:16.227282 [info ] [MainThread]: Running with dbt=1.2.0
[0m14:22:16.259168 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:22:16.259736 [debug] [MainThread]: Tracking: tracking
[0m14:22:16.701742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cbf6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cbf6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cbf6370>]}
[0m14:22:16.978281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:16.978773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:17.070600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7caf8e50>]}
[0m14:22:17.091843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cb6c4c0>]}
[0m14:22:17.092837 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:22:17.093452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cb6c640>]}
[0m14:22:17.098282 [info ] [MainThread]: 
[0m14:22:17.101374 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m14:22:17.104502 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m14:22:17.167530 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:22:17.168492 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m14:22:17.169060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:17.169523 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:18.795329 [debug] [ThreadPool]: SQL status: SELECT in 1.63 seconds
[0m14:22:18.798188 [debug] [ThreadPool]: On list_dev: Close
[0m14:22:18.801053 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m14:22:18.819103 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m14:22:18.819457 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m14:22:18.819773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:18.820053 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:19.905222 [debug] [ThreadPool]: SQL status: BEGIN in 1.09 seconds
[0m14:22:19.905702 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m14:22:19.905998 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:22:20.036657 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m14:22:20.045610 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m14:22:20.168395 [debug] [ThreadPool]: On list_dev_public: Close
[0m14:22:20.180228 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:20.180686 [debug] [MainThread]: On master: BEGIN
[0m14:22:20.181133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:20.181534 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:21.275882 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m14:22:21.277100 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:21.278745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:21.433020 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m14:22:21.435486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7cabc760>]}
[0m14:22:21.436364 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:21.549960 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:21.550412 [debug] [MainThread]: On master: BEGIN
[0m14:22:21.788487 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m14:22:21.789521 [debug] [MainThread]: On master: COMMIT
[0m14:22:21.790246 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:21.790863 [debug] [MainThread]: On master: COMMIT
[0m14:22:21.909404 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:22:21.910033 [debug] [MainThread]: On master: Close
[0m14:22:21.912497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:21.913373 [info ] [MainThread]: 
[0m14:22:22.019210 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m14:22:22.019847 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
[0m14:22:22.020881 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:22.021413 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m14:22:22.021964 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m14:22:22.032563 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m14:22:22.034171 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:22.034728 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m14:22:22.353898 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m14:22:22.355794 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:22.356660 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m14:22:22.357153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:22:22.357954 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:23.473017 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m14:22:23.474410 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:23.475251 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:22:23.639156 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m14:22:23.665440 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:23.666185 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:22:23.787890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:22:23.795432 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:23.796066 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:22:23.915137 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:22:23.987930 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m14:22:23.989801 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:23.990907 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m14:22:24.200946 [debug] [Thread-1  ]: SQL status: COMMIT in 0.21 seconds
[0m14:22:24.202201 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:24.202767 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m14:22:24.323724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m14:22:24.337549 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:24.337912 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:22:24.456964 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m14:22:24.460715 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m14:22:24.461406 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:24.462051 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m14:22:24.604299 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m14:22:24.605252 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m14:22:24.606085 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m14:22:24.723205 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m14:22:24.724313 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:24.724613 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m14:22:24.842085 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m14:22:24.843596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7c225490>]}
[0m14:22:24.844301 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.82s]
[0m14:22:24.845244 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m14:22:24.847445 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m14:22:24.849071 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
[0m14:22:24.850751 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:24.851320 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m14:22:24.851854 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m14:22:24.861070 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m14:22:24.862496 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:24.863252 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m14:22:24.976330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m14:22:24.977665 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:24.978169 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m14:22:24.978531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:22:24.978964 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:26.089001 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m14:22:26.089461 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.089804 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m14:22:26.215116 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m14:22:26.222675 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.223022 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:22:26.341399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:22:26.347747 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m14:22:26.348996 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.351427 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m14:22:26.497554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m14:22:26.498421 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.498792 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m14:22:26.618284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m14:22:26.622765 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.623159 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:22:26.746894 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m14:22:26.748788 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m14:22:26.749390 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.750017 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m14:22:26.886770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m14:22:26.887901 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m14:22:26.888536 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m14:22:27.008568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m14:22:27.009817 [debug] [Thread-1  ]: finished collecting timing info
[0m14:22:27.010161 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m14:22:27.127874 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m14:22:27.129522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ff4eaba-1ae0-4ae2-99c1-54c7fd53d9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7c2751f0>]}
[0m14:22:27.130297 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.28s]
[0m14:22:27.131275 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m14:22:27.135339 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m14:22:27.136096 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:27.137358 [debug] [MainThread]: On master: BEGIN
[0m14:22:27.138967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:27.139659 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m14:22:28.435170 [debug] [MainThread]: SQL status: BEGIN in 1.3 seconds
[0m14:22:28.435634 [debug] [MainThread]: On master: COMMIT
[0m14:22:28.436009 [debug] [MainThread]: Using redshift connection "master"
[0m14:22:28.436696 [debug] [MainThread]: On master: COMMIT
[0m14:22:28.558038 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:22:28.558595 [debug] [MainThread]: On master: Close
[0m14:22:28.560003 [info ] [MainThread]: 
[0m14:22:28.560620 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.46 seconds (11.46s).
[0m14:22:28.561206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:28.561631 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m14:22:28.592080 [info ] [MainThread]: 
[0m14:22:28.593532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:28.594484 [info ] [MainThread]: 
[0m14:22:28.595259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:28.596383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7caf8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7c27c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7c27d1c0>]}


============================== 2022-08-15 17:49:26.659476 | 04399823-d3b5-40d0-bac1-3798c6cad835 ==============================
[0m17:49:26.659515 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:49:26.660494 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:26.660894 [debug] [MainThread]: Tracking: tracking
[0m17:49:26.868629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d254291c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d25429280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d254292b0>]}
[0m17:49:26.967407 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:49:26.968430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04399823-d3b5-40d0-bac1-3798c6cad835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d25449e20>]}
[0m17:49:27.100391 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:49:27.204954 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:49:27.274139 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:49:27.276175 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:49:27.278126 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:49:27.280854 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:49:27.297951 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:49:27.303640 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:49:27.306920 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:49:27.309932 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:49:27.313113 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:49:27.315226 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:49:27.319663 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:49:27.412863 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:49:27.420392 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:49:27.424538 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:49:27.429146 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:49:27.433569 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:49:27.437038 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:49:27.470973 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:49:27.472828 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:49:27.476676 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:49:27.483909 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:49:27.531784 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:49:27.609582 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:49:27.623107 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:49:27.633814 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:49:27.680032 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:49:27.691143 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:49:27.701736 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:49:27.726342 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:49:27.733637 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:49:27.739462 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:49:27.743292 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:49:27.773327 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:49:27.793970 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:49:27.797446 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:49:27.802162 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:49:27.806625 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:49:27.816723 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:49:27.828322 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:49:27.846490 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:49:27.858293 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:49:27.866002 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:49:27.889733 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:49:27.964171 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:49:27.983633 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:49:27.989731 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:49:28.026253 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:49:28.076241 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:49:28.122466 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:49:28.213743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:49:28.283471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:49:28.313770 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:49:28.318160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:49:28.331476 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:49:28.342593 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:49:28.345972 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:49:28.362699 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:49:28.370657 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:49:28.378035 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:49:28.394921 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:49:28.402415 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:49:28.409115 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:49:28.411435 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:49:28.414632 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:49:28.418034 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:49:28.422437 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:49:28.424931 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:49:28.427827 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:49:28.430526 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:49:28.437094 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:49:28.439556 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:49:28.441954 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:49:28.444913 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:49:28.447876 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:49:28.451076 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:49:28.456364 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:49:28.459002 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:49:28.478297 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:49:28.480423 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:49:28.482425 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:49:28.486410 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:49:29.510287 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:49:29.545675 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:49:29.551660 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m17:49:29.790286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04399823-d3b5-40d0-bac1-3798c6cad835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d253f05e0>]}
[0m17:49:29.972861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04399823-d3b5-40d0-bac1-3798c6cad835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d254e4c70>]}
[0m17:49:29.973956 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:49:29.975004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04399823-d3b5-40d0-bac1-3798c6cad835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d25333d30>]}
[0m17:49:29.977574 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m17:49:29.987648 [info ] [MainThread]: 
[0m17:49:29.991149 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:49:30.028036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2549b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2549b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2549b2b0>]}


============================== 2022-08-15 17:50:05.476344 | af0a8e8e-aa73-4f39-b28d-aeaa04e658c1 ==============================
[0m17:50:05.476379 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:50:05.478318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:50:05.481930 [debug] [MainThread]: Tracking: tracking
[0m17:50:05.541482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94813190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94813250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94813280>]}
[0m17:50:05.699591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:05.700039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:05.717859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc946d1fa0>]}
[0m17:50:05.738484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94741880>]}
[0m17:50:05.739326 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:50:05.739957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94741910>]}
[0m17:50:05.744453 [info ] [MainThread]: 
[0m17:50:05.746738 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:50:05.762264 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m17:50:05.800512 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:50:05.801035 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:50:05.801429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.801810 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:07.674120 [debug] [ThreadPool]: SQL status: SELECT in 1.87 seconds
[0m17:50:07.678117 [debug] [ThreadPool]: On list_dev: Close
[0m17:50:07.683979 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m17:50:07.703831 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:50:07.704227 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m17:50:07.704554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:07.704860 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:08.866718 [debug] [ThreadPool]: SQL status: BEGIN in 1.16 seconds
[0m17:50:08.867738 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:50:08.868286 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:50:08.996589 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m17:50:09.001171 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m17:50:09.131318 [debug] [ThreadPool]: On list_dev_public: Close
[0m17:50:09.148310 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:09.148850 [debug] [MainThread]: On master: BEGIN
[0m17:50:09.150729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:09.152451 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:10.242203 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m17:50:10.242653 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:10.242938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:10.401399 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m17:50:10.405073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94741040>]}
[0m17:50:10.405924 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:10.525107 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:10.525668 [debug] [MainThread]: On master: BEGIN
[0m17:50:10.760193 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m17:50:10.760656 [debug] [MainThread]: On master: COMMIT
[0m17:50:10.760940 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:10.761235 [debug] [MainThread]: On master: COMMIT
[0m17:50:10.886129 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:50:10.887527 [debug] [MainThread]: On master: Close
[0m17:50:10.888771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:10.889328 [info ] [MainThread]: 
[0m17:50:10.901670 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m17:50:10.902569 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m17:50:10.904232 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:10.904885 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m17:50:10.905433 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m17:50:10.914229 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:50:10.915841 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:10.916297 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m17:50:11.224570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:50:11.225919 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:11.226363 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:50:11.226871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:11.227208 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:12.812558 [debug] [Thread-1  ]: SQL status: BEGIN in 1.59 seconds
[0m17:50:12.813108 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:12.813541 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:50:13.010472 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m17:50:13.027598 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.028051 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:50:13.141332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m17:50:13.148293 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.148843 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:50:13.273535 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:50:13.360315 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:50:13.360793 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.361147 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:50:13.551329 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m17:50:13.552261 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.552801 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:50:13.714780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m17:50:13.731009 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.731472 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:50:13.863652 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m17:50:13.865769 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:50:13.866144 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:13.866413 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:50:14.015339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:50:14.015870 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:50:14.016212 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:50:14.242984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.23 seconds
[0m17:50:14.244431 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:14.244796 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m17:50:14.363775 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m17:50:14.365345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc926080d0>]}
[0m17:50:14.366120 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 3.46s]
[0m17:50:14.367148 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m17:50:14.367739 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m17:50:14.368942 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m17:50:14.373191 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m17:50:14.373875 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m17:50:14.374471 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m17:50:14.382687 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m17:50:14.405512 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:14.406290 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m17:50:14.549273 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m17:50:14.556650 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:50:14.561525 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:50:14.562076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:14.562566 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:15.966365 [debug] [Thread-1  ]: SQL status: BEGIN in 1.4 seconds
[0m17:50:15.967126 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:50:15.967439 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with sorce_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR _PAGO,
		COMISSION AS COMISSÃO,
		SELETIME AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m17:50:16.108760 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "_PAGO"
LINE 20:   PRICEPAID AS VALOR _PAGO,
                              ^

[0m17:50:16.110108 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m17:50:16.278938 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:16.279400 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m17:50:16.281062 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  syntax error at or near "_PAGO"
  LINE 20:   PRICEPAID AS VALOR _PAGO,
                                ^
  compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:50:16.281847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc925763a0>]}
[0m17:50:16.282601 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.vw_sales ............................... [[31mERROR[0m in 1.91s]
[0m17:50:16.283643 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m17:50:16.284255 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m17:50:16.285261 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m17:50:16.286544 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:16.287047 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m17:50:16.287491 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m17:50:16.301478 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:50:16.302864 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:16.303553 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m17:50:16.319937 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:50:16.321338 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:16.321977 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:50:16.322448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:16.323068 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:17.550415 [debug] [Thread-1  ]: SQL status: BEGIN in 1.23 seconds
[0m17:50:17.551018 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:17.551353 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m17:50:17.671461 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m17:50:17.694654 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:17.695300 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:50:17.813989 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:50:17.820357 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:50:17.820954 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:17.821373 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:50:17.964907 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:50:17.965786 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:17.966094 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:50:18.082157 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:50:18.087299 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:18.087713 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:50:18.204695 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m17:50:18.208566 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:50:18.209376 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:18.210041 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:50:18.350121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:50:18.350546 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:50:18.350847 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:50:18.467885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:50:18.470753 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:18.471626 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m17:50:18.594599 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m17:50:18.599361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0a8e8e-aa73-4f39-b28d-aeaa04e658c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9363cc40>]}
[0m17:50:18.602078 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.31s]
[0m17:50:18.604880 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m17:50:18.619824 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:50:18.623781 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:18.625149 [debug] [MainThread]: On master: BEGIN
[0m17:50:18.626473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:18.628388 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:50:19.767814 [debug] [MainThread]: SQL status: BEGIN in 1.14 seconds
[0m17:50:19.768557 [debug] [MainThread]: On master: COMMIT
[0m17:50:19.769147 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:19.769633 [debug] [MainThread]: On master: COMMIT
[0m17:50:19.888713 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:50:19.889204 [debug] [MainThread]: On master: Close
[0m17:50:19.890400 [info ] [MainThread]: 
[0m17:50:19.890923 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.14 seconds (14.14s).
[0m17:50:19.891509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:19.891908 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:50:19.892205 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m17:50:19.922438 [info ] [MainThread]: 
[0m17:50:19.923071 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:19.925853 [info ] [MainThread]: 
[0m17:50:19.929693 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m17:50:19.930498 [error] [MainThread]:   syntax error at or near "_PAGO"
[0m17:50:19.931176 [error] [MainThread]:   LINE 20:   PRICEPAID AS VALOR _PAGO,
[0m17:50:19.931871 [error] [MainThread]:                                 ^
[0m17:50:19.932472 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:50:19.933215 [info ] [MainThread]: 
[0m17:50:19.933859 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:50:19.934835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc925a93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc925a93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc925a90a0>]}


============================== 2022-08-15 17:51:12.269365 | 516ef0d3-75db-4299-8bf0-a9205174a097 ==============================
[0m17:51:12.269419 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:51:12.271913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:51:12.274465 [debug] [MainThread]: Tracking: tracking
[0m17:51:12.321509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812abd6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812abd6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812abd6370>]}
[0m17:51:12.531432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:12.533628 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m17:51:12.577037 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m17:51:12.654043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812aadecd0>]}
[0m17:51:12.671682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812abec100>]}
[0m17:51:12.672563 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:51:12.673373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812ab2beb0>]}
[0m17:51:12.678203 [info ] [MainThread]: 
[0m17:51:12.679985 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:51:12.684892 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m17:51:12.733875 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:51:12.734467 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:51:12.735123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:12.735652 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:14.061926 [debug] [ThreadPool]: SQL status: SELECT in 1.33 seconds
[0m17:51:14.065794 [debug] [ThreadPool]: On list_dev: Close
[0m17:51:14.069058 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m17:51:14.088390 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:51:14.088793 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m17:51:14.089062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:14.089368 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:15.165080 [debug] [ThreadPool]: SQL status: BEGIN in 1.08 seconds
[0m17:51:15.165787 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:51:15.166173 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:51:15.295532 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m17:51:15.298179 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m17:51:15.415090 [debug] [ThreadPool]: On list_dev_public: Close
[0m17:51:15.447256 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:15.449024 [debug] [MainThread]: On master: BEGIN
[0m17:51:15.449976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:15.451011 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:16.577033 [debug] [MainThread]: SQL status: BEGIN in 1.13 seconds
[0m17:51:16.578227 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:16.579058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:16.751804 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
[0m17:51:16.760571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812aac2ac0>]}
[0m17:51:16.762930 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:16.885595 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:16.886606 [debug] [MainThread]: On master: BEGIN
[0m17:51:17.123206 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m17:51:17.124670 [debug] [MainThread]: On master: COMMIT
[0m17:51:17.125507 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:17.126212 [debug] [MainThread]: On master: COMMIT
[0m17:51:17.248962 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:51:17.250236 [debug] [MainThread]: On master: Close
[0m17:51:17.253479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:17.255329 [info ] [MainThread]: 
[0m17:51:17.282393 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m17:51:17.283195 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m17:51:17.289060 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:17.289668 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m17:51:17.290193 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m17:51:17.305272 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:51:17.306791 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:17.307395 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m17:51:17.511737 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:51:17.512781 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:17.513346 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:51:17.513739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:17.514033 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:18.712798 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
[0m17:51:18.714134 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:18.714973 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:51:18.884365 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m17:51:18.914628 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:18.915206 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:51:19.031923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:51:19.040377 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.040884 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:51:19.164918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:51:19.260616 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:51:19.260986 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.261337 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:51:19.417224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m17:51:19.418124 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.418462 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:51:19.543510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:51:19.567981 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.568526 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:51:19.689413 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m17:51:19.695121 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:51:19.696706 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.697427 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:51:19.850916 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:51:19.852052 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:51:19.852904 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:51:19.977408 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:51:19.980691 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:19.981547 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m17:51:20.101566 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m17:51:20.103764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812a2530a0>]}
[0m17:51:20.105018 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.82s]
[0m17:51:20.106619 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m17:51:20.107645 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m17:51:20.109983 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m17:51:20.118354 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m17:51:20.119409 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m17:51:20.120314 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m17:51:20.130524 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m17:51:20.132221 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:20.132710 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m17:51:20.232540 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m17:51:20.234178 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:51:20.234713 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:51:20.235047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:20.235436 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:21.321684 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m17:51:21.322761 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:51:21.323678 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with sorce_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMISSION AS COMISSÃO,
		SELETIME AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m17:51:21.443615 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "source_sales" does not exist

[0m17:51:21.444724 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m17:51:21.565772 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:21.566866 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m17:51:21.569685 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  relation "source_sales" does not exist
  compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:51:21.571367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81281a2f70>]}
[0m17:51:21.573166 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.vw_sales ............................... [[31mERROR[0m in 1.46s]
[0m17:51:21.575670 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m17:51:21.577548 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m17:51:21.580767 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m17:51:21.587859 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:21.593302 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m17:51:21.594492 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m17:51:21.607098 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:51:21.608188 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:21.608812 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m17:51:21.624191 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:51:21.625384 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:21.625855 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:51:21.626227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:21.626585 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:22.766050 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m17:51:22.767153 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:22.767914 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m17:51:22.890536 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m17:51:22.908321 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:22.909582 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:51:23.046653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m17:51:23.056067 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:51:23.056993 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:23.057740 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:51:23.234701 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m17:51:23.236618 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:23.237435 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:51:23.365284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:51:23.369642 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:23.369967 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:51:23.494420 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m17:51:23.497548 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:51:23.498156 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:23.498623 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:51:23.642523 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:51:23.643851 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:51:23.644916 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:51:23.762940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:51:23.766164 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:23.767244 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m17:51:23.888118 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m17:51:23.891871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ef0d3-75db-4299-8bf0-a9205174a097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81299fe6a0>]}
[0m17:51:23.893846 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.31s]
[0m17:51:23.897076 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m17:51:23.911126 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:51:23.912262 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:23.912762 [debug] [MainThread]: On master: BEGIN
[0m17:51:23.913094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:23.913454 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:51:25.353614 [debug] [MainThread]: SQL status: BEGIN in 1.44 seconds
[0m17:51:25.354826 [debug] [MainThread]: On master: COMMIT
[0m17:51:25.355513 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:25.356331 [debug] [MainThread]: On master: COMMIT
[0m17:51:25.481959 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:51:25.483216 [debug] [MainThread]: On master: Close
[0m17:51:25.486241 [info ] [MainThread]: 
[0m17:51:25.487773 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m17:51:25.490938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:25.493259 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m17:51:25.536731 [info ] [MainThread]: 
[0m17:51:25.537495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:25.539336 [info ] [MainThread]: 
[0m17:51:25.540114 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m17:51:25.540819 [error] [MainThread]:   relation "source_sales" does not exist
[0m17:51:25.541490 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:51:25.542175 [info ] [MainThread]: 
[0m17:51:25.542859 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:51:25.543854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81281a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81281a2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81281a2fd0>]}


============================== 2022-08-15 17:52:40.909741 | e3e6bf46-4098-4526-bcb4-720361e5cc08 ==============================
[0m17:52:40.909805 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:52:40.910668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:52:40.911347 [debug] [MainThread]: Tracking: tracking
[0m17:52:40.948894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f478190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f478250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f478280>]}
[0m17:52:41.088139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:41.089080 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m17:52:41.120921 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m17:52:41.170026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f385be0>]}
[0m17:52:41.185471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f4784c0>]}
[0m17:52:41.186178 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:52:41.186806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f3cfdc0>]}
[0m17:52:41.190715 [info ] [MainThread]: 
[0m17:52:41.192429 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:52:41.196090 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m17:52:41.245897 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:52:41.246681 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:52:41.247165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:41.247620 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:42.509435 [debug] [ThreadPool]: SQL status: SELECT in 1.26 seconds
[0m17:52:42.512339 [debug] [ThreadPool]: On list_dev: Close
[0m17:52:42.515368 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m17:52:42.530145 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:52:42.530516 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m17:52:42.530841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:42.531216 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:43.635514 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m17:52:43.636643 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:52:43.637491 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:52:43.766773 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m17:52:43.774954 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m17:52:43.893570 [debug] [ThreadPool]: On list_dev_public: Close
[0m17:52:43.923319 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:43.923685 [debug] [MainThread]: On master: BEGIN
[0m17:52:43.923943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:43.924209 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:44.993956 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m17:52:44.995433 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:44.996470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:45.152450 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m17:52:45.155370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f3ed790>]}
[0m17:52:45.156157 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:45.272969 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:45.273401 [debug] [MainThread]: On master: BEGIN
[0m17:52:45.504760 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m17:52:45.505248 [debug] [MainThread]: On master: COMMIT
[0m17:52:45.505528 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:45.505790 [debug] [MainThread]: On master: COMMIT
[0m17:52:45.622479 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:52:45.623756 [debug] [MainThread]: On master: Close
[0m17:52:45.626985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:45.628520 [info ] [MainThread]: 
[0m17:52:45.657200 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m17:52:45.659316 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m17:52:45.662911 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:45.663565 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m17:52:45.664210 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m17:52:45.683191 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:52:45.684533 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:45.685212 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m17:52:45.949216 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:52:45.950250 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:45.950724 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:52:45.951016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:45.951334 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:47.124166 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m17:52:47.125360 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.126248 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:52:47.289191 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m17:52:47.307911 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.308550 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:52:47.429225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:52:47.442628 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.443480 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:52:47.565984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:52:47.636412 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:52:47.636811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.637146 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:52:47.792698 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m17:52:47.793729 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.794164 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:52:47.914807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:52:47.924800 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:47.925148 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:52:48.044285 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m17:52:48.049490 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:52:48.050307 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:48.051172 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:52:48.197668 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:52:48.198347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:52:48.199123 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:52:48.318550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:52:48.322272 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:48.323265 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m17:52:48.441183 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m17:52:48.443030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f499f10>]}
[0m17:52:48.444184 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.78s]
[0m17:52:48.445535 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m17:52:48.446126 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m17:52:48.447171 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m17:52:48.448996 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m17:52:48.449662 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m17:52:48.450224 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m17:52:48.458412 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m17:52:48.461205 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:48.462677 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m17:52:48.626057 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m17:52:48.627254 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:52:48.627732 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:52:48.628103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:48.628531 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:49.711815 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m17:52:49.712990 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:52:49.713906 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMISSION AS COMISSÃO,
		SELETIME AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m17:52:49.836262 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "comission" does not exist in source_sales

[0m17:52:49.837412 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m17:52:49.961800 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:49.962970 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m17:52:49.965886 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  column "comission" does not exist in source_sales
  compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:52:49.967598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ca45d00>]}
[0m17:52:49.969679 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.vw_sales ............................... [[31mERROR[0m in 1.52s]
[0m17:52:49.972328 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m17:52:49.974067 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m17:52:49.977078 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m17:52:49.983531 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:49.984529 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m17:52:49.985336 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m17:52:49.999722 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:52:50.001372 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:50.002269 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m17:52:50.022763 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:52:50.023850 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:50.024397 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:52:50.024927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:50.025490 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:51.146489 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m17:52:51.147815 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.148595 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m17:52:51.275072 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m17:52:51.291986 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.292975 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:52:51.412274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:52:51.421360 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:52:51.422390 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.423172 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:52:51.565186 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:52:51.567461 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.568456 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:52:51.685781 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:52:51.692260 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.692814 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:52:51.811300 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m17:52:51.814927 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:52:51.815548 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.816072 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:52:51.954051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:52:51.955227 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:52:51.956152 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:52:52.074046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:52:52.077085 [debug] [Thread-1  ]: finished collecting timing info
[0m17:52:52.078038 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m17:52:52.197030 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m17:52:52.201097 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e6bf46-4098-4526-bcb4-720361e5cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2e2a25b0>]}
[0m17:52:52.202352 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.22s]
[0m17:52:52.203438 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m17:52:52.207011 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:52:52.207600 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:52.207950 [debug] [MainThread]: On master: BEGIN
[0m17:52:52.208280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:52.208615 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:52:53.311700 [debug] [MainThread]: SQL status: BEGIN in 1.1 seconds
[0m17:52:53.312949 [debug] [MainThread]: On master: COMMIT
[0m17:52:53.313737 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:53.314735 [debug] [MainThread]: On master: COMMIT
[0m17:52:53.435974 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:52:53.437239 [debug] [MainThread]: On master: Close
[0m17:52:53.440651 [info ] [MainThread]: 
[0m17:52:53.442202 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m17:52:53.444125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:53.445836 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m17:52:53.483988 [info ] [MainThread]: 
[0m17:52:53.484687 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:52:53.485547 [info ] [MainThread]: 
[0m17:52:53.486257 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m17:52:53.487081 [error] [MainThread]:   column "comission" does not exist in source_sales
[0m17:52:53.487802 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:52:53.488696 [info ] [MainThread]: 
[0m17:52:53.489440 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:52:53.490423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f3cfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f3cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f369ac0>]}


============================== 2022-08-15 17:53:39.013865 | eb0f9e21-ed73-4ae9-921e-4ba64a16614f ==============================
[0m17:53:39.013899 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:53:39.014620 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:53:39.015270 [debug] [MainThread]: Tracking: tracking
[0m17:53:39.049350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9a8e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9a8e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9a8e280>]}
[0m17:53:39.186141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:39.187124 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m17:53:39.218266 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m17:53:39.265635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9997be0>]}
[0m17:53:39.280601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9a8e4f0>]}
[0m17:53:39.281268 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:53:39.281864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99e5dc0>]}
[0m17:53:39.288521 [info ] [MainThread]: 
[0m17:53:39.291269 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:53:39.294012 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m17:53:39.337203 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:53:39.337902 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:53:39.338350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:39.339026 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:40.777181 [debug] [ThreadPool]: SQL status: SELECT in 1.44 seconds
[0m17:53:40.780341 [debug] [ThreadPool]: On list_dev: Close
[0m17:53:40.784052 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m17:53:40.805163 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:53:40.805572 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m17:53:40.805894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:40.806201 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:42.310722 [debug] [ThreadPool]: SQL status: BEGIN in 1.5 seconds
[0m17:53:42.311127 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:53:42.311401 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:53:42.438426 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m17:53:42.441200 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m17:53:42.563027 [debug] [ThreadPool]: On list_dev_public: Close
[0m17:53:42.597837 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:42.599319 [debug] [MainThread]: On master: BEGIN
[0m17:53:42.600197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:42.600993 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:43.909333 [debug] [MainThread]: SQL status: BEGIN in 1.31 seconds
[0m17:53:43.910069 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:43.910495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:44.170964 [debug] [MainThread]: SQL status: SELECT in 0.26 seconds
[0m17:53:44.176762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c997f9d0>]}
[0m17:53:44.178151 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:44.294783 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:44.295311 [debug] [MainThread]: On master: BEGIN
[0m17:53:44.683566 [debug] [MainThread]: SQL status: BEGIN in 0.39 seconds
[0m17:53:44.684915 [debug] [MainThread]: On master: COMMIT
[0m17:53:44.685939 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:44.686851 [debug] [MainThread]: On master: COMMIT
[0m17:53:44.813260 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m17:53:44.814574 [debug] [MainThread]: On master: Close
[0m17:53:44.817759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:44.819601 [info ] [MainThread]: 
[0m17:53:44.851127 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m17:53:44.852382 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m17:53:44.854191 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:44.854832 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m17:53:44.855264 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m17:53:44.866982 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:53:44.868098 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:44.868624 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m17:53:45.084974 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:53:45.086044 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:45.086419 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:53:45.086775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:45.087097 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:46.266774 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
[0m17:53:46.267849 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:46.268818 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:53:46.429853 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m17:53:46.470092 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:46.471214 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:53:46.589185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:53:46.604267 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:46.605203 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:53:46.739010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m17:53:46.817714 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:53:46.818088 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:46.818352 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:53:46.971066 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:53:46.971827 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:46.972109 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:53:47.094682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:53:47.120443 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:47.121123 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:53:47.245150 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m17:53:47.251808 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:53:47.253291 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:47.254636 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:53:47.408980 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:53:47.410197 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:53:47.411168 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:53:47.529623 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:53:47.532824 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:47.533737 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m17:53:47.662092 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m17:53:47.665863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9102430>]}
[0m17:53:47.667982 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.81s]
[0m17:53:47.670800 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m17:53:47.672793 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m17:53:47.676662 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m17:53:47.684267 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m17:53:47.685697 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m17:53:47.686896 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m17:53:47.702364 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m17:53:47.703577 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:47.704064 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m17:53:47.809323 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m17:53:47.828833 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:53:47.829392 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:53:47.829798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:47.830185 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:48.953687 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m17:53:48.954983 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:53:48.955867 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		SELETIME AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m17:53:49.077456 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "seletime" does not exist in source_sales

[0m17:53:49.079247 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m17:53:49.204987 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:49.206140 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m17:53:49.209240 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  column "seletime" does not exist in source_sales
  compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:53:49.210824 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c805cd00>]}
[0m17:53:49.212586 [error] [Thread-1  ]: 2 of 3 ERROR creating view model public.vw_sales ............................... [[31mERROR[0m in 1.53s]
[0m17:53:49.215295 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m17:53:49.218937 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m17:53:49.221967 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m17:53:49.226062 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:49.229873 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m17:53:49.231936 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m17:53:49.239245 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:53:49.240113 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:49.240535 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m17:53:49.274713 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:53:49.275909 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:49.276389 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:53:49.276702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:49.277042 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:50.371558 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m17:53:50.372054 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:50.372396 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m17:53:50.492485 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m17:53:50.507168 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:50.508109 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:53:50.630984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:53:50.636119 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:53:50.636661 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:50.637078 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:53:50.782712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:53:50.785255 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:50.786266 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:53:50.908882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:53:50.915997 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:50.916629 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:53:51.028371 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.11 seconds
[0m17:53:51.030232 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:53:51.030588 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:51.030820 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:53:51.172868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:53:51.173413 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:53:51.173785 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:53:51.295197 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:53:51.296346 [debug] [Thread-1  ]: finished collecting timing info
[0m17:53:51.296645 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m17:53:51.416410 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m17:53:51.420021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb0f9e21-ed73-4ae9-921e-4ba64a16614f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c88b75b0>]}
[0m17:53:51.422076 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.20s]
[0m17:53:51.424704 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m17:53:51.444254 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:53:51.445955 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:51.447785 [debug] [MainThread]: On master: BEGIN
[0m17:53:51.448997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:51.450230 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:53:52.568246 [debug] [MainThread]: SQL status: BEGIN in 1.12 seconds
[0m17:53:52.569697 [debug] [MainThread]: On master: COMMIT
[0m17:53:52.570544 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:52.571383 [debug] [MainThread]: On master: COMMIT
[0m17:53:52.690946 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:53:52.692024 [debug] [MainThread]: On master: Close
[0m17:53:52.694790 [info ] [MainThread]: 
[0m17:53:52.696358 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m17:53:52.697623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:52.698297 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m17:53:52.734899 [info ] [MainThread]: 
[0m17:53:52.735797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:52.736598 [info ] [MainThread]: 
[0m17:53:52.737363 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m17:53:52.738117 [error] [MainThread]:   column "seletime" does not exist in source_sales
[0m17:53:52.738898 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/views/vw_sales.sql
[0m17:53:52.739620 [info ] [MainThread]: 
[0m17:53:52.740355 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:53:52.741345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c997fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9117550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c910e1c0>]}


============================== 2022-08-15 17:54:43.862394 | 04f496ed-bfca-4c26-8805-584564ba2744 ==============================
[0m17:54:43.862431 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:54:43.863181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:54:43.863640 [debug] [MainThread]: Tracking: tracking
[0m17:54:43.900859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15779fc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15779fc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15779fc220>]}
[0m17:54:44.050453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:44.051308 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m17:54:44.083759 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m17:54:44.133030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1577909b80>]}
[0m17:54:44.149273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15779fc970>]}
[0m17:54:44.149927 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:54:44.150545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1577953d60>]}
[0m17:54:44.154481 [info ] [MainThread]: 
[0m17:54:44.156049 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:54:44.160209 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m17:54:44.213839 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:54:44.216401 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:54:44.218267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:44.225733 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:45.674868 [debug] [ThreadPool]: SQL status: SELECT in 1.46 seconds
[0m17:54:45.683042 [debug] [ThreadPool]: On list_dev: Close
[0m17:54:45.757502 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m17:54:45.775428 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:54:45.775792 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m17:54:45.776098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:45.776398 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:46.871353 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m17:54:46.872465 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m17:54:46.873325 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:54:47.012598 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m17:54:47.015230 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m17:54:47.149341 [debug] [ThreadPool]: On list_dev_public: Close
[0m17:54:47.183132 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:47.184548 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.185388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:47.186291 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:48.317542 [debug] [MainThread]: SQL status: BEGIN in 1.13 seconds
[0m17:54:48.318781 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:48.319994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:48.480763 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m17:54:48.487813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15778eea30>]}
[0m17:54:48.489684 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:48.610014 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:48.611230 [debug] [MainThread]: On master: BEGIN
[0m17:54:48.861250 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
[0m17:54:48.861777 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.862154 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:48.862463 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.982313 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:54:48.983521 [debug] [MainThread]: On master: Close
[0m17:54:48.986077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:48.987559 [info ] [MainThread]: 
[0m17:54:49.015350 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m17:54:49.017044 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m17:54:49.021941 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:49.022478 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m17:54:49.022932 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m17:54:49.035588 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:54:49.036709 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:49.037184 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m17:54:49.266222 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m17:54:49.267234 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:49.267572 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:54:49.267868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:49.268166 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:50.451472 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
[0m17:54:50.452718 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:50.453596 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:54:50.631307 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m17:54:50.650840 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:50.651272 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:54:50.782056 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m17:54:50.799638 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:50.801529 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:54:50.925043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:54:50.976724 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:54:50.977149 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:50.977461 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:54:51.136285 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m17:54:51.137608 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:51.138117 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:54:51.269764 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:54:51.286475 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:51.286992 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:54:51.417958 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m17:54:51.423193 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:54:51.424222 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:51.424987 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m17:54:51.575790 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m17:54:51.576968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m17:54:51.577749 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m17:54:51.699878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:54:51.703085 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:51.704673 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m17:54:51.823645 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m17:54:51.825877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15778eea90>]}
[0m17:54:51.827155 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.81s]
[0m17:54:51.828977 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m17:54:51.830129 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m17:54:51.832019 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m17:54:51.839887 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:51.842150 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m17:54:51.842756 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m17:54:51.848618 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m17:54:51.849910 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:51.850452 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m17:54:51.969630 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m17:54:51.970826 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:51.971293 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:54:51.971681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:51.972081 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:53.088575 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m17:54:53.090460 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.091922 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		SALETIME AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m17:54:53.215706 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m17:54:53.231364 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.233689 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m17:54:53.355952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m17:54:53.365467 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m17:54:53.366369 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.367136 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m17:54:53.512767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:54:53.514916 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.515789 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:54:53.634261 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:54:53.651823 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.652808 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m17:54:53.771204 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m17:54:53.773074 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m17:54:53.773396 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.773710 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m17:54:53.934698 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m17:54:53.935919 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m17:54:53.936682 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m17:54:54.054741 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:54:54.056444 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:54.056929 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m17:54:54.174855 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m17:54:54.178135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1576826400>]}
[0m17:54:54.180645 [info ] [Thread-1  ]: 2 of 3 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.34s]
[0m17:54:54.183229 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m17:54:54.184770 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m17:54:54.187091 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m17:54:54.191788 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:54.193216 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m17:54:54.194561 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m17:54:54.214406 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:54:54.215328 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:54.215730 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m17:54:54.230451 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m17:54:54.231598 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:54.232171 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:54:54.232698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:54.233216 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:55.367907 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m17:54:55.369176 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:55.370054 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m17:54:55.490400 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m17:54:55.503852 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:55.504394 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:54:55.647250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m17:54:55.650272 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:54:55.650563 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:55.650864 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:54:55.795571 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:54:55.796554 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:55.797065 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:54:55.913839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:54:55.925574 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:55.926111 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:54:56.043936 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m17:54:56.049923 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:54:56.051005 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:56.052319 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m17:54:56.190812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m17:54:56.191524 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m17:54:56.191939 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m17:54:56.318022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:54:56.321326 [debug] [Thread-1  ]: finished collecting timing info
[0m17:54:56.322289 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m17:54:56.439683 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m17:54:56.441495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f496ed-bfca-4c26-8805-584564ba2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1574fd0c10>]}
[0m17:54:56.442432 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.25s]
[0m17:54:56.443643 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m17:54:56.448045 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m17:54:56.448757 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:56.449246 [debug] [MainThread]: On master: BEGIN
[0m17:54:56.449663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:56.450124 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m17:54:57.600997 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m17:54:57.601591 [debug] [MainThread]: On master: COMMIT
[0m17:54:57.602024 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:57.602367 [debug] [MainThread]: On master: COMMIT
[0m17:54:57.720200 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m17:54:57.720703 [debug] [MainThread]: On master: Close
[0m17:54:57.722124 [info ] [MainThread]: 
[0m17:54:57.723064 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.57 seconds (13.57s).
[0m17:54:57.724147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:57.724722 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m17:54:57.758318 [info ] [MainThread]: 
[0m17:54:57.759390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:57.760497 [info ] [MainThread]: 
[0m17:54:57.761323 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:54:57.762880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1577953cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1577953d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15778eea60>]}


============================== 2022-08-15 18:18:11.056394 | ca929fef-ff4d-4b6f-8c13-5a441416a48b ==============================
[0m18:18:11.056428 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:18:11.057223 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:11.057530 [debug] [MainThread]: Tracking: tracking
[0m18:18:11.094561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea8da0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea8da160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea8da190>]}
[0m18:18:11.329785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:11.330698 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m18:18:11.362192 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m18:18:11.410154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea7d9af0>]}
[0m18:18:11.425222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea8da8e0>]}
[0m18:18:11.425846 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:18:11.426378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea827cd0>]}
[0m18:18:11.431073 [info ] [MainThread]: 
[0m18:18:11.433435 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:18:11.436379 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m18:18:11.482411 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:18:11.482943 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:18:11.483495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:11.484048 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:12.739215 [debug] [ThreadPool]: SQL status: SELECT in 1.26 seconds
[0m18:18:12.741987 [debug] [ThreadPool]: On list_dev: Close
[0m18:18:12.745091 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m18:18:12.761948 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:18:12.762305 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:18:12.762578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:12.762925 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:13.834427 [debug] [ThreadPool]: SQL status: BEGIN in 1.07 seconds
[0m18:18:13.835518 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:18:13.836280 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:18:13.963672 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m18:18:13.968112 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m18:18:14.090229 [debug] [ThreadPool]: On list_dev_public: Close
[0m18:18:14.100610 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:14.101727 [debug] [MainThread]: On master: BEGIN
[0m18:18:14.102987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:14.103829 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:15.221071 [debug] [MainThread]: SQL status: BEGIN in 1.12 seconds
[0m18:18:15.221552 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:15.221890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:15.380408 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m18:18:15.385039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea7c3940>]}
[0m18:18:15.386127 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:15.505757 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:15.506219 [debug] [MainThread]: On master: BEGIN
[0m18:18:15.739314 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m18:18:15.739842 [debug] [MainThread]: On master: COMMIT
[0m18:18:15.740290 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:15.740630 [debug] [MainThread]: On master: COMMIT
[0m18:18:15.858179 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:18:15.858983 [debug] [MainThread]: On master: Close
[0m18:18:15.860512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:15.861397 [info ] [MainThread]: 
[0m18:18:15.872905 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m18:18:15.874228 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
[0m18:18:15.875787 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:15.876394 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m18:18:15.876984 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m18:18:15.887408 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:18:15.889132 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:15.889786 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m18:18:16.151737 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:18:16.152692 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:16.153020 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:18:16.153286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:18:16.153564 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:17.252559 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m18:18:17.253642 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:17.254388 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:18:17.429154 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m18:18:17.444856 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:17.445257 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:18:17.561336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:18:17.566437 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:17.566763 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:18:17.725340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m18:18:17.808963 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:18:17.809386 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:17.809737 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:18:17.964006 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:18:17.964932 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:17.965390 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:18:18.106719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m18:18:18.131209 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:18.131904 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:18:18.250979 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m18:18:18.252692 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:18:18.253083 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:18.253459 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:18:18.402988 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:18:18.403921 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:18:18.404567 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:18:18.523179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:18:18.526005 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:18.526904 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m18:18:18.646163 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m18:18:18.647489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea7bbf10>]}
[0m18:18:18.648298 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.77s]
[0m18:18:18.649290 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m18:18:18.649804 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m18:18:18.650699 [info ] [Thread-1  ]: 2 of 3 START view model public.vw_sales ........................................ [RUN]
[0m18:18:18.652370 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:18.653010 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m18:18:18.653549 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m18:18:18.658828 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m18:18:18.659662 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:18.659939 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m18:18:18.755932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m18:18:18.757358 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:18.757718 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:18:18.758026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:18:18.758381 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:19.916488 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m18:18:19.917565 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:19.918320 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m18:18:20.036740 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:18:20.049766 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.050978 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m18:18:20.169788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:18:20.189903 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.190920 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m18:18:20.312182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:18:20.322108 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:18:20.323030 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.323830 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:18:20.471394 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:18:20.473356 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.474176 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:18:20.592111 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:18:20.599492 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.601676 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m18:18:20.721482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:18:20.724458 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:18:20.725063 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.725486 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:18:20.865512 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:18:20.866251 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:18:20.866674 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:18:20.983748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:18:20.986810 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:20.987776 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m18:18:21.106606 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m18:18:21.108808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce96fb4c0>]}
[0m18:18:21.110106 [info ] [Thread-1  ]: 2 of 3 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.46s]
[0m18:18:21.111489 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m18:18:21.112366 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m18:18:21.114061 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
[0m18:18:21.121625 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:21.122976 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m18:18:21.124083 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m18:18:21.140805 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:18:21.143417 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:21.144241 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m18:18:21.162470 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:18:21.163539 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:21.164073 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:18:21.164448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:18:21.164976 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:22.245377 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m18:18:22.246499 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.247340 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m18:18:22.368819 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:18:22.383753 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.384706 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:18:22.504900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:18:22.514198 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:18:22.515198 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.515984 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:18:22.658867 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:18:22.659656 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.659911 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:18:22.777012 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:18:22.790635 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.791674 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:18:22.910039 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:18:22.912113 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:18:22.912465 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:22.912716 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:18:23.051820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:18:23.052584 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:18:23.053121 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:18:23.171686 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:18:23.172753 [debug] [Thread-1  ]: finished collecting timing info
[0m18:18:23.173048 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m18:18:23.288462 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m18:18:23.289681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca929fef-ff4d-4b6f-8c13-5a441416a48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce862d3d0>]}
[0m18:18:23.290410 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.17s]
[0m18:18:23.291284 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m18:18:23.294786 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:18:23.295390 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:23.295811 [debug] [MainThread]: On master: BEGIN
[0m18:18:23.296248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:23.296745 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:18:24.378916 [debug] [MainThread]: SQL status: BEGIN in 1.08 seconds
[0m18:18:24.379529 [debug] [MainThread]: On master: COMMIT
[0m18:18:24.380033 [debug] [MainThread]: Using redshift connection "master"
[0m18:18:24.380471 [debug] [MainThread]: On master: COMMIT
[0m18:18:24.497665 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:18:24.498148 [debug] [MainThread]: On master: Close
[0m18:18:24.499482 [info ] [MainThread]: 
[0m18:18:24.500042 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.07 seconds (13.07s).
[0m18:18:24.500728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:24.501070 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m18:18:24.856262 [info ] [MainThread]: 
[0m18:18:24.857057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:24.857969 [info ] [MainThread]: 
[0m18:18:24.858685 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:18:24.859672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea7c3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea827c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea827c10>]}


============================== 2022-08-15 18:45:19.627830 | 80d87114-65e9-4f29-8491-d94f798db131 ==============================
[0m18:45:19.627863 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:45:19.628608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:45:19.628997 [debug] [MainThread]: Tracking: tracking
[0m18:45:19.664053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb6cd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb6cd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb6cd280>]}
[0m18:45:19.791756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:45:19.794518 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m18:45:19.832666 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m18:45:19.909813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb5d9c10>]}
[0m18:45:19.934437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb5bda30>]}
[0m18:45:19.935072 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:45:19.935647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb5bdbb0>]}
[0m18:45:19.942558 [info ] [MainThread]: 
[0m18:45:19.945522 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:45:19.948422 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m18:45:19.979815 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:45:19.980251 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:45:19.980504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:19.980789 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:21.256894 [debug] [ThreadPool]: SQL status: SELECT in 1.28 seconds
[0m18:45:21.265092 [debug] [ThreadPool]: On list_dev: Close
[0m18:45:21.271965 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m18:45:21.297236 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:45:21.297633 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:45:21.297907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:21.298169 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:22.380272 [debug] [ThreadPool]: SQL status: BEGIN in 1.08 seconds
[0m18:45:22.380790 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:45:22.381074 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:45:22.509560 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m18:45:22.519579 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m18:45:22.638931 [debug] [ThreadPool]: On list_dev_public: Close
[0m18:45:22.652796 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:22.653199 [debug] [MainThread]: On master: BEGIN
[0m18:45:22.653473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:22.653759 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:23.731678 [debug] [MainThread]: SQL status: BEGIN in 1.08 seconds
[0m18:45:23.732154 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:23.732439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:23.888564 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m18:45:23.891504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb64d8b0>]}
[0m18:45:23.893428 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:24.014470 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:24.016453 [debug] [MainThread]: On master: BEGIN
[0m18:45:24.253716 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m18:45:24.254147 [debug] [MainThread]: On master: COMMIT
[0m18:45:24.254434 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:24.254681 [debug] [MainThread]: On master: COMMIT
[0m18:45:24.375462 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:45:24.376038 [debug] [MainThread]: On master: Close
[0m18:45:24.377506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:24.378345 [info ] [MainThread]: 
[0m18:45:24.396927 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m18:45:24.398512 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m18:45:24.400302 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:24.400994 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m18:45:24.401792 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m18:45:24.416721 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:45:24.417753 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:24.418310 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m18:45:24.624680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:45:24.625864 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:24.626482 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:45:24.627115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:24.633136 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:25.826815 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
[0m18:45:25.827458 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:25.827951 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:45:25.991902 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m18:45:26.007381 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.007732 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:45:26.124127 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:45:26.133748 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.134347 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:45:26.254227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:45:26.332647 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:45:26.333667 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.334460 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:45:26.489524 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:45:26.491500 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.492150 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:45:26.612652 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:26.626279 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.626638 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:45:26.744975 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m18:45:26.750089 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:45:26.751311 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.751953 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:45:26.899211 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:45:26.901023 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:45:26.901596 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:45:27.019411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:27.020842 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:27.021273 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m18:45:27.151378 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m18:45:27.153496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abad5a040>]}
[0m18:45:27.154346 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.75s]
[0m18:45:27.155709 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m18:45:27.156293 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m18:45:27.156956 [info ] [Thread-1  ]: 2 of 4 START view model public.tb_10_compradores ............................... [RUN]
[0m18:45:27.158127 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:45:27.158583 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m18:45:27.158947 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m18:45:27.164494 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m18:45:27.168550 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:27.171790 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m18:45:27.237039 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m18:45:27.238757 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:45:27.239116 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m18:45:27.239591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:27.240031 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:28.357996 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m18:45:28.358485 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:45:28.358788 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create view "dev"."public"."tb_10_compradores__dbt_tmp" as (
    compradores as (

    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),

    top_10_compradores as (

        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  ) ;

[0m18:45:28.478841 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 5:     compradores as (
            ^

[0m18:45:28.479363 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m18:45:28.595794 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:28.596255 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m18:45:28.597336 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 5:     compradores as (
              ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m18:45:28.598180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab8c95070>]}
[0m18:45:28.599370 [error] [Thread-1  ]: 2 of 4 ERROR creating view model public.tb_10_compradores ...................... [[31mERROR[0m in 1.44s]
[0m18:45:28.602286 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m18:45:28.603825 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m18:45:28.605278 [info ] [Thread-1  ]: 3 of 4 START view model public.vw_sales ........................................ [RUN]
[0m18:45:28.606625 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:28.608369 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m18:45:28.610575 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m18:45:28.616955 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m18:45:28.619613 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:28.620332 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m18:45:28.628156 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m18:45:28.629064 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:28.629376 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:45:28.629954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:28.630320 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:29.722403 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m18:45:29.723263 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:29.724071 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m18:45:29.847338 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:45:29.855736 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:29.856122 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m18:45:29.974229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:45:29.989825 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:29.990619 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m18:45:30.110083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:45:30.113703 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:45:30.114141 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:30.114391 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:45:30.261297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:45:30.262042 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:30.262290 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:45:30.380668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:30.386545 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:30.387446 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m18:45:30.519674 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
[0m18:45:30.522554 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:45:30.522879 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:30.523150 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:45:30.663609 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:45:30.664133 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:45:30.664489 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:45:30.782213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:30.783816 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:30.785966 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m18:45:30.904697 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m18:45:30.907621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab8c95730>]}
[0m18:45:30.908398 [info ] [Thread-1  ]: 3 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.30s]
[0m18:45:30.909416 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m18:45:30.909986 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m18:45:30.910904 [info ] [Thread-1  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m18:45:30.911964 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:30.912407 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m18:45:30.912862 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m18:45:30.925436 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:45:30.926351 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:30.926638 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m18:45:30.936143 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:45:30.938863 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:30.940082 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:45:30.940608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:30.941040 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:32.054953 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m18:45:32.056318 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.056852 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m18:45:32.180155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:45:32.191816 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.192352 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:45:32.311761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:45:32.315544 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:45:32.315917 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.316293 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:45:32.461558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:45:32.462488 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.462824 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:45:32.581683 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:32.588810 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.590341 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:45:32.710615 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:45:32.713722 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:45:32.714539 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.715068 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:45:32.856059 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:45:32.857621 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:45:32.858185 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:45:32.977226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:45:32.978281 [debug] [Thread-1  ]: finished collecting timing info
[0m18:45:32.978587 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m18:45:33.095961 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m18:45:33.097210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80d87114-65e9-4f29-8491-d94f798db131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abb5882b0>]}
[0m18:45:33.097906 [info ] [Thread-1  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.19s]
[0m18:45:33.098820 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m18:45:33.101987 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:45:33.102427 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:33.102828 [debug] [MainThread]: On master: BEGIN
[0m18:45:33.103177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:33.103639 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:45:34.214578 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m18:45:34.215027 [debug] [MainThread]: On master: COMMIT
[0m18:45:34.215369 [debug] [MainThread]: Using redshift connection "master"
[0m18:45:34.215653 [debug] [MainThread]: On master: COMMIT
[0m18:45:34.333356 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:45:34.333820 [debug] [MainThread]: On master: Close
[0m18:45:34.334978 [info ] [MainThread]: 
[0m18:45:34.335554 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 14.39 seconds (14.39s).
[0m18:45:34.336350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:34.336802 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m18:45:34.365267 [info ] [MainThread]: 
[0m18:45:34.365817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:34.366537 [info ] [MainThread]: 
[0m18:45:34.367298 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m18:45:34.368013 [error] [MainThread]:   syntax error at or near "compradores"
[0m18:45:34.370299 [error] [MainThread]:   LINE 5:     compradores as (
[0m18:45:34.371319 [error] [MainThread]:               ^
[0m18:45:34.372047 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m18:45:34.372883 [info ] [MainThread]: 
[0m18:45:34.373647 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:45:34.374772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abad4e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aba4ef910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aba4efc40>]}


============================== 2022-08-15 18:46:26.452043 | 5fba2f02-118f-4626-a91b-6dcbcf1aa305 ==============================
[0m18:46:26.452078 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:46:26.452915 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:46:26.453295 [debug] [MainThread]: Tracking: tracking
[0m18:46:26.484065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793df50220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793df502e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793df50310>]}
[0m18:46:26.580884 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:46:26.581765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793df6be80>]}
[0m18:46:26.648209 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:46:26.764303 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:46:26.800237 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:46:26.801553 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:46:26.802998 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:46:26.804345 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:46:26.813687 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:46:26.816326 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:46:26.817807 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:46:26.819429 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:46:26.821422 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:46:26.822442 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:46:26.823709 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:46:26.895388 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:46:26.901177 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:46:26.904608 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:46:26.908608 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:46:26.912290 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:46:26.914727 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:46:26.932747 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:46:26.933916 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:46:26.935340 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:46:26.938210 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:46:26.962460 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:46:27.001831 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:46:27.013483 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:46:27.020828 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:46:27.055679 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:46:27.062042 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:46:27.066928 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:46:27.085473 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:46:27.091478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:46:27.095115 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:46:27.098406 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:46:27.119310 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:46:27.129706 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:46:27.131371 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:46:27.133246 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:46:27.135256 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:46:27.138459 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:46:27.143799 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:46:27.153080 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:46:27.157160 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:46:27.161375 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:46:27.172774 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:46:27.221258 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:46:27.238076 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:46:27.242067 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:46:27.270346 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:46:27.311204 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:46:27.345931 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:46:27.386964 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:46:27.429113 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:46:27.452952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:46:27.456823 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:46:27.467755 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:46:27.475982 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:46:27.479004 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:46:27.492745 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:46:27.497966 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:46:27.504586 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:46:27.519055 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:46:27.524747 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:46:27.529659 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:46:27.531881 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:46:27.534941 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:46:27.537421 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:46:27.539595 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:46:27.541757 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:46:27.544534 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:46:27.547170 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:46:27.551682 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:46:27.553804 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:46:27.555941 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:46:27.558522 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:46:27.561065 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:46:27.563974 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:46:27.566876 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:46:27.569440 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:46:27.583657 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:46:27.585563 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:46:27.587391 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:46:27.589906 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:46:28.203361 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:46:28.228828 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:46:28.234441 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m18:46:28.239821 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m18:46:28.388274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793d6065e0>]}
[0m18:46:28.463195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793dfc20d0>]}
[0m18:46:28.463933 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:46:28.464508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793e00cbb0>]}
[0m18:46:28.468011 [info ] [MainThread]: 
[0m18:46:28.469603 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:46:28.475320 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m18:46:28.525492 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:46:28.526134 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:46:28.526549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:28.527050 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:29.934065 [debug] [ThreadPool]: SQL status: SELECT in 1.41 seconds
[0m18:46:29.936524 [debug] [ThreadPool]: On list_dev: Close
[0m18:46:29.939801 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m18:46:29.956322 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:46:29.956843 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:46:29.957194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:29.957729 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:31.045194 [debug] [ThreadPool]: SQL status: BEGIN in 1.09 seconds
[0m18:46:31.046299 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:46:31.047172 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:46:31.176693 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m18:46:31.184582 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m18:46:31.303275 [debug] [ThreadPool]: On list_dev_public: Close
[0m18:46:31.328823 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:31.329373 [debug] [MainThread]: On master: BEGIN
[0m18:46:31.329826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:31.330236 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:32.418977 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m18:46:32.420294 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:32.420967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:46:32.580922 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m18:46:32.589361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793dfc22b0>]}
[0m18:46:32.590879 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:32.708777 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:32.709614 [debug] [MainThread]: On master: BEGIN
[0m18:46:32.941868 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m18:46:32.943234 [debug] [MainThread]: On master: COMMIT
[0m18:46:32.944039 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:32.944766 [debug] [MainThread]: On master: COMMIT
[0m18:46:33.061419 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:46:33.061897 [debug] [MainThread]: On master: Close
[0m18:46:33.062813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:33.063348 [info ] [MainThread]: 
[0m18:46:33.089674 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m18:46:33.090445 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m18:46:33.091672 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:33.092181 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m18:46:33.092666 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m18:46:33.110048 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:46:33.112690 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:33.114088 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m18:46:33.296122 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:46:33.297033 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:33.297367 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:46:33.297697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:33.297959 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:34.399413 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m18:46:34.400636 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:34.401461 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:46:34.564495 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m18:46:34.595111 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:34.595464 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:46:34.713081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:46:34.720898 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:34.721566 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:46:34.843762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:46:34.949197 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:46:34.949633 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:34.949993 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:46:35.123256 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m18:46:35.124448 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:35.124956 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:46:35.245467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:35.254955 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:35.255396 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:46:35.374650 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m18:46:35.379310 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:46:35.380134 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:35.380939 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:46:35.527892 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:46:35.529265 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:46:35.530207 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:46:35.649984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:35.653362 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:35.654410 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m18:46:35.776711 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m18:46:35.780487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793d6032b0>]}
[0m18:46:35.782436 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.69s]
[0m18:46:35.785841 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m18:46:35.787451 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m18:46:35.792867 [info ] [Thread-1  ]: 2 of 4 START tables model public.tb_10_compradores ............................. [RUN]
[0m18:46:35.796711 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:46:35.798272 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m18:46:35.800064 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m18:46:35.810234 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m18:46:35.812244 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:35.813507 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m18:46:35.822282 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:35.823122 [debug] [Thread-1  ]: Compilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:46:35.823595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793c537c10>]}
[0m18:46:35.824293 [error] [Thread-1  ]: 2 of 4 ERROR creating tables model public.tb_10_compradores .................... [[31mERROR[0m in 0.03s]
[0m18:46:35.825204 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m18:46:35.825776 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m18:46:35.826598 [info ] [Thread-1  ]: 3 of 4 START view model public.vw_sales ........................................ [RUN]
[0m18:46:35.827540 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:35.827931 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m18:46:35.828407 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m18:46:35.832833 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m18:46:35.833960 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:35.834498 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m18:46:35.931668 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m18:46:35.932884 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:35.933355 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:46:35.933829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:35.935105 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:37.051254 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m18:46:37.052514 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.053297 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m18:46:37.178036 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:46:37.193666 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.194803 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m18:46:37.315276 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:46:37.337044 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.337945 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m18:46:37.459252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:46:37.469354 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:46:37.470791 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.471773 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:46:37.619295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:46:37.621062 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.621949 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:46:37.742078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:37.753627 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.754804 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m18:46:37.877098 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:46:37.881900 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:46:37.882761 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:37.883532 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:46:38.025195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:46:38.026330 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:46:38.027081 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:46:38.145283 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:38.146585 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:38.147045 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m18:46:38.282646 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m18:46:38.286488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793c56b430>]}
[0m18:46:38.289372 [info ] [Thread-1  ]: 3 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.46s]
[0m18:46:38.292418 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m18:46:38.294049 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m18:46:38.311694 [info ] [Thread-1  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m18:46:38.315333 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:38.318128 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m18:46:38.319233 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m18:46:38.326828 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:46:38.328081 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:38.338493 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m18:46:38.356471 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:46:38.360667 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:38.361411 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:46:38.361930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:38.362391 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:39.448513 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m18:46:39.448977 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:39.449230 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m18:46:39.571375 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:46:39.586999 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:39.588014 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:46:39.706043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:46:39.711136 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:46:39.711682 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:39.712081 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:46:39.854088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:46:39.854837 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:39.855088 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:46:39.972755 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:39.984071 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:39.985004 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:46:40.104825 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:46:40.107286 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:46:40.107693 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:40.108042 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:46:40.247425 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:46:40.247849 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:46:40.248087 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:46:40.364441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:46:40.367450 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:40.368337 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m18:46:40.486165 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m18:46:40.489518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fba2f02-118f-4626-a91b-6dcbcf1aa305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793dfd62b0>]}
[0m18:46:40.491366 [info ] [Thread-1  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.18s]
[0m18:46:40.493650 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m18:46:40.506424 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:46:40.507969 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:40.508925 [debug] [MainThread]: On master: BEGIN
[0m18:46:40.509624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:40.510646 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:46:41.654685 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m18:46:41.655892 [debug] [MainThread]: On master: COMMIT
[0m18:46:41.656718 [debug] [MainThread]: Using redshift connection "master"
[0m18:46:41.657550 [debug] [MainThread]: On master: COMMIT
[0m18:46:41.779052 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:46:41.779769 [debug] [MainThread]: On master: Close
[0m18:46:41.781457 [info ] [MainThread]: 
[0m18:46:41.782321 [info ] [MainThread]: Finished running 1 table model, 1 tables model, 2 view models in 0 hours 0 minutes and 13.31 seconds (13.31s).
[0m18:46:41.783033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:41.783416 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m18:46:41.810695 [info ] [MainThread]: 
[0m18:46:41.811710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:46:41.812562 [info ] [MainThread]: 
[0m18:46:41.821115 [error] [MainThread]: [33mCompilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m18:46:41.822971 [error] [MainThread]:   No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:46:41.823883 [info ] [MainThread]: 
[0m18:46:41.824633 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:46:41.825703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793dfc2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793d5e0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793df23e50>]}


============================== 2022-08-15 18:50:40.622468 | f2d29cfb-4834-4301-8975-c843fc53ea98 ==============================
[0m18:50:40.622533 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:50:40.623295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:50:40.623703 [debug] [MainThread]: Tracking: tracking
[0m18:50:40.647566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46eff1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46eff2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46eff2e0>]}
[0m18:50:40.819141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:40.819964 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m18:50:40.850770 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m18:50:40.898821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46dfcf10>]}
[0m18:50:40.914943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46f0f5b0>]}
[0m18:50:40.915669 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:50:40.916223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46e55f70>]}
[0m18:50:40.919921 [info ] [MainThread]: 
[0m18:50:40.922991 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:50:40.927731 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m18:50:40.984037 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:50:40.984793 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:50:40.985291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:40.985780 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:42.550292 [debug] [ThreadPool]: SQL status: SELECT in 1.57 seconds
[0m18:50:42.553042 [debug] [ThreadPool]: On list_dev: Close
[0m18:50:42.556267 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m18:50:42.570604 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:50:42.570978 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:50:42.571210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:42.571486 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:43.779825 [debug] [ThreadPool]: SQL status: BEGIN in 1.21 seconds
[0m18:50:43.781196 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:50:43.781956 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:50:43.910226 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m18:50:43.918772 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m18:50:44.039645 [debug] [ThreadPool]: On list_dev_public: Close
[0m18:50:44.073437 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:44.074277 [debug] [MainThread]: On master: BEGIN
[0m18:50:44.075120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:44.076040 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:45.154530 [debug] [MainThread]: SQL status: BEGIN in 1.08 seconds
[0m18:50:45.155637 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:45.156523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:45.311480 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m18:50:45.314035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46f1aa60>]}
[0m18:50:45.314642 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:45.433583 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:45.434701 [debug] [MainThread]: On master: BEGIN
[0m18:50:45.677526 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m18:50:45.678401 [debug] [MainThread]: On master: COMMIT
[0m18:50:45.679147 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:45.679767 [debug] [MainThread]: On master: COMMIT
[0m18:50:45.795936 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:50:45.797650 [debug] [MainThread]: On master: Close
[0m18:50:45.802729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:45.804627 [info ] [MainThread]: 
[0m18:50:45.823593 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m18:50:45.825258 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m18:50:45.826673 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:45.827236 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m18:50:45.827838 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m18:50:45.842188 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:50:45.843164 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:45.843544 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m18:50:46.136739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:50:46.146873 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:46.147490 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:50:46.147818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:46.148127 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:47.351541 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
[0m18:50:47.351968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:47.352246 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:50:47.511803 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m18:50:47.535798 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:47.536856 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:50:47.653202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:50:47.658377 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:47.658812 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:50:47.777987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:50:47.829903 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:50:47.830499 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:47.831081 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:50:47.984153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:50:47.986470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:47.987338 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:50:48.106231 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:50:48.139089 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:48.140913 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:50:48.260525 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m18:50:48.265935 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:50:48.266780 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:48.267457 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:50:48.412317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:50:48.413479 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:50:48.414399 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:50:48.536779 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:50:48.540082 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:48.541150 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m18:50:48.660026 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m18:50:48.663475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4659b460>]}
[0m18:50:48.665746 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.84s]
[0m18:50:48.669500 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m18:50:48.673080 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m18:50:48.683213 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m18:50:48.688891 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:48.690211 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m18:50:48.691433 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m18:50:48.697532 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m18:50:48.703040 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:48.703838 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m18:50:48.797912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m18:50:48.799232 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:48.803941 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:50:48.804458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:48.804927 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:49.894914 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m18:50:49.896066 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:49.897006 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m18:50:50.024868 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m18:50:50.048033 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.049150 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m18:50:50.170475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:50:50.180979 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.181616 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m18:50:50.307026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:50:50.317380 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:50:50.318925 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.319925 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:50:50.465079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:50:50.466890 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.467609 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:50:50.592087 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:50:50.608066 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.609476 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m18:50:50.730985 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:50:50.733441 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:50:50.734040 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.734478 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:50:50.887173 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:50:50.887637 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:50:50.887897 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:50:51.013030 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:50:51.015921 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:51.016815 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m18:50:51.135277 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m18:50:51.139224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c45d28a00>]}
[0m18:50:51.141444 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.45s]
[0m18:50:51.143858 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m18:50:51.145357 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m18:50:51.147569 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m18:50:51.161191 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:51.162576 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m18:50:51.163842 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m18:50:51.182893 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:50:51.183824 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:51.184223 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m18:50:51.197051 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:50:51.199104 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:51.199701 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:50:51.200171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:51.200742 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:52.362946 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m18:50:52.363480 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:52.363802 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m18:50:52.487207 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:50:52.502770 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:52.503759 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:50:52.622879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:50:52.625955 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:50:52.626263 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:52.626507 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:50:52.802096 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m18:50:52.803273 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:52.803770 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:50:52.924809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:50:52.937408 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:52.938339 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:50:53.057607 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m18:50:53.060195 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:50:53.060716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:53.061076 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:50:53.202937 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:50:53.204208 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:50:53.205041 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:50:53.351969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m18:50:53.354887 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:53.355811 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m18:50:53.474441 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m18:50:53.476356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4659c400>]}
[0m18:50:53.477618 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.32s]
[0m18:50:53.479303 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m18:50:53.480429 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m18:50:53.481818 [info ] [Thread-1  ]: 4 of 4 START tables model public.tb_10_compradores ............................. [RUN]
[0m18:50:53.483900 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:50:53.484798 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m18:50:53.485585 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m18:50:53.502527 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m18:50:53.503979 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:53.504928 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m18:50:53.519075 [debug] [Thread-1  ]: finished collecting timing info
[0m18:50:53.520528 [debug] [Thread-1  ]: Compilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:50:53.521415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2d29cfb-4834-4301-8975-c843fc53ea98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4441eb50>]}
[0m18:50:53.522072 [error] [Thread-1  ]: 4 of 4 ERROR creating tables model public.tb_10_compradores .................... [[31mERROR[0m in 0.04s]
[0m18:50:53.522824 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m18:50:53.530637 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:50:53.531260 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:53.531679 [debug] [MainThread]: On master: BEGIN
[0m18:50:53.532057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:53.532425 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:50:54.626966 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m18:50:54.628278 [debug] [MainThread]: On master: COMMIT
[0m18:50:54.629042 [debug] [MainThread]: Using redshift connection "master"
[0m18:50:54.629914 [debug] [MainThread]: On master: COMMIT
[0m18:50:54.767912 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
[0m18:50:54.769314 [debug] [MainThread]: On master: Close
[0m18:50:54.772223 [info ] [MainThread]: 
[0m18:50:54.773836 [info ] [MainThread]: Finished running 1 table model, 2 view models, 1 tables model in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m18:50:54.776201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:54.777640 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m18:50:54.825819 [info ] [MainThread]: 
[0m18:50:54.826433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:54.827924 [info ] [MainThread]: 
[0m18:50:54.829092 [error] [MainThread]: [33mCompilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m18:50:54.831585 [error] [MainThread]:   No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:50:54.833981 [info ] [MainThread]: 
[0m18:50:54.836035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:50:54.837611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46e57040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c46e55fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c44481670>]}


============================== 2022-08-15 18:59:07.744347 | 848f8200-4467-4a5c-8250-5b72193b537c ==============================
[0m18:59:07.744384 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:59:07.745584 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:59:07.746012 [debug] [MainThread]: Tracking: tracking
[0m18:59:07.801214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5191014190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5191014250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5191014280>]}
[0m18:59:07.943939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:07.944320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:08.032235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190f170a0>]}
[0m18:59:08.050245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190f90a30>]}
[0m18:59:08.051183 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:59:08.051955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190f15e80>]}
[0m18:59:08.056295 [info ] [MainThread]: 
[0m18:59:08.057996 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:59:08.061457 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m18:59:08.116929 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:59:08.117572 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:59:08.118013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:08.118549 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:09.391956 [debug] [ThreadPool]: SQL status: SELECT in 1.27 seconds
[0m18:59:09.394867 [debug] [ThreadPool]: On list_dev: Close
[0m18:59:09.398264 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m18:59:09.414582 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:59:09.415044 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:59:09.415457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:09.416286 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:10.519028 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m18:59:10.520145 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:59:10.520908 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:59:10.651909 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m18:59:10.656664 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m18:59:10.774656 [debug] [ThreadPool]: On list_dev_public: Close
[0m18:59:10.806126 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:10.807094 [debug] [MainThread]: On master: BEGIN
[0m18:59:10.807872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:10.809530 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:11.920265 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m18:59:11.921402 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:11.922362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:59:12.082164 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m18:59:12.089420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5191026550>]}
[0m18:59:12.090941 [debug] [MainThread]: On master: ROLLBACK
[0m18:59:12.211201 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:12.212207 [debug] [MainThread]: On master: BEGIN
[0m18:59:12.448567 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m18:59:12.449072 [debug] [MainThread]: On master: COMMIT
[0m18:59:12.449331 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:12.449556 [debug] [MainThread]: On master: COMMIT
[0m18:59:12.567639 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:59:12.568970 [debug] [MainThread]: On master: Close
[0m18:59:12.571884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:12.573512 [info ] [MainThread]: 
[0m18:59:12.620297 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m18:59:12.621310 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m18:59:12.623076 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:12.623749 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m18:59:12.624410 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m18:59:12.655672 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:59:12.656992 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:12.658153 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m18:59:12.971690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m18:59:12.972639 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:12.972979 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:59:12.973342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:12.973809 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:14.080025 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m18:59:14.081117 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.081862 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:59:14.241387 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m18:59:14.275439 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.275805 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:59:14.390787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m18:59:14.403319 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.404115 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:59:14.525558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:59:14.589536 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:59:14.590048 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.590452 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:59:14.744563 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:59:14.746230 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.746830 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:59:14.869099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:59:14.898897 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:14.899259 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:59:15.017031 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m18:59:15.022926 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:59:15.023890 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:15.025043 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m18:59:15.167634 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:59:15.168978 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m18:59:15.169866 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m18:59:15.293794 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:59:15.296911 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:15.297826 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m18:59:15.415753 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m18:59:15.416960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190643a30>]}
[0m18:59:15.417698 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.79s]
[0m18:59:15.418761 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m18:59:15.419300 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m18:59:15.420519 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m18:59:15.421858 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:15.422463 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m18:59:15.422947 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m18:59:15.430833 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m18:59:15.432126 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:15.433905 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m18:59:15.522497 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m18:59:15.525810 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:15.526537 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:59:15.527008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:15.527513 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:16.605570 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m18:59:16.606724 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:16.607547 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m18:59:16.731115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m18:59:16.747868 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:16.748896 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m18:59:16.869888 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:59:16.880040 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:16.880364 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m18:59:16.997762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:59:17.008438 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:59:17.009457 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:17.010347 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:59:17.161068 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m18:59:17.163029 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:17.163843 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:59:17.283640 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:59:17.294959 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:17.295936 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m18:59:17.431493 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
[0m18:59:17.436454 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:59:17.437275 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:17.438115 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m18:59:17.578900 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:59:17.580095 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m18:59:17.580971 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m18:59:17.701478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:59:17.704377 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:17.705262 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m18:59:17.872919 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m18:59:17.874595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190698040>]}
[0m18:59:17.875697 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.45s]
[0m18:59:17.877164 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m18:59:17.878083 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m18:59:17.880292 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m18:59:17.882323 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:17.883198 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m18:59:17.883975 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m18:59:17.899089 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:59:17.899969 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:17.900312 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m18:59:17.914617 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m18:59:17.915637 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:17.915998 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:59:17.916291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:17.916591 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:19.380705 [debug] [Thread-1  ]: SQL status: BEGIN in 1.46 seconds
[0m18:59:19.382281 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:19.383695 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m18:59:19.590700 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.21 seconds
[0m18:59:19.601642 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:19.602302 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:59:19.720771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m18:59:19.725604 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:59:19.726077 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:19.726438 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:59:19.902584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m18:59:19.904025 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:19.904779 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:59:20.023213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m18:59:20.029015 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:20.029507 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:59:20.218542 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.19 seconds
[0m18:59:20.223944 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:59:20.224824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:20.225658 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m18:59:20.366152 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m18:59:20.367749 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m18:59:20.368521 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m18:59:20.557285 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m18:59:20.560456 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:20.561368 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m18:59:20.680716 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m18:59:20.684505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190579b50>]}
[0m18:59:20.686636 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.80s]
[0m18:59:20.690748 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m18:59:20.693173 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m18:59:20.695669 [info ] [Thread-1  ]: 4 of 4 START tables model public.tb_10_compradores ............................. [RUN]
[0m18:59:20.703912 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m18:59:20.705516 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m18:59:20.706775 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m18:59:20.720210 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m18:59:20.721148 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:20.721465 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m18:59:20.726138 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:20.727180 [debug] [Thread-1  ]: Compilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:59:20.727948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848f8200-4467-4a5c-8250-5b72193b537c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51906aba90>]}
[0m18:59:20.728924 [error] [Thread-1  ]: 4 of 4 ERROR creating tables model public.tb_10_compradores .................... [[31mERROR[0m in 0.03s]
[0m18:59:20.730050 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m18:59:20.734695 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m18:59:20.735332 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:20.735705 [debug] [MainThread]: On master: BEGIN
[0m18:59:20.736081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:20.736487 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m18:59:22.121678 [debug] [MainThread]: SQL status: BEGIN in 1.39 seconds
[0m18:59:22.122825 [debug] [MainThread]: On master: COMMIT
[0m18:59:22.123737 [debug] [MainThread]: Using redshift connection "master"
[0m18:59:22.124583 [debug] [MainThread]: On master: COMMIT
[0m18:59:22.243801 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m18:59:22.245042 [debug] [MainThread]: On master: Close
[0m18:59:22.248142 [info ] [MainThread]: 
[0m18:59:22.249822 [info ] [MainThread]: Finished running 1 table model, 2 view models, 1 tables model in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m18:59:22.252174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:22.253378 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m18:59:22.292491 [info ] [MainThread]: 
[0m18:59:22.293305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:59:22.294162 [info ] [MainThread]: 
[0m18:59:22.294960 [error] [MainThread]: [33mCompilation Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m18:59:22.295667 [error] [MainThread]:   No materialization 'tables' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m18:59:22.296390 [info ] [MainThread]: 
[0m18:59:22.297076 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:59:22.298020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190681d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190693d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190693940>]}


============================== 2022-08-15 19:00:19.759448 | f85772d3-93ff-48f5-85db-dd790252a3fc ==============================
[0m19:00:19.759485 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:00:19.760545 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:00:19.761047 [debug] [MainThread]: Tracking: tracking
[0m19:00:19.817502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16802fec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1680242fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168026a040>]}
[0m19:00:19.952613 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:00:19.954048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168024d580>]}
[0m19:00:20.073387 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:00:20.186290 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:00:20.232240 [debug] [MainThread]: Parsing macros/relations.sql
[0m19:00:20.233705 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:00:20.235342 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m19:00:20.236985 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:00:20.249910 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:00:20.254881 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:00:20.257719 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:00:20.259816 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:00:20.262299 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:00:20.263688 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:00:20.265336 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:00:20.349599 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:00:20.356626 [debug] [MainThread]: Parsing macros/relations.sql
[0m19:00:20.360826 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m19:00:20.365560 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:00:20.371927 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:00:20.375014 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:00:20.395733 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:00:20.397862 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:00:20.399652 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:00:20.404078 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:00:20.435723 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:00:20.485324 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:00:20.499399 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:00:20.508002 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:00:20.548788 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:00:20.556377 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:00:20.563199 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:00:20.586459 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:00:20.596539 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:00:20.602175 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:00:20.608011 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:00:20.634602 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:00:20.647127 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:00:20.649316 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:00:20.651656 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:00:20.654625 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:00:20.658887 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:00:20.665358 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:00:20.676204 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:00:20.682763 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:00:20.688148 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:00:20.705687 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:00:20.769556 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:00:20.791974 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:00:20.798073 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:00:20.834683 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:00:20.901068 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:00:20.947449 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:00:20.993083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:00:21.045198 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:00:21.075623 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:00:21.080065 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:00:21.093272 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:00:21.110496 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:00:21.114641 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:00:21.131170 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:00:21.138283 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:00:21.146103 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:00:21.162281 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:00:21.169503 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:00:21.175550 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:00:21.178196 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:00:21.182129 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:00:21.186920 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:00:21.190174 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:00:21.193022 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:00:21.196542 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:00:21.200125 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:00:21.208059 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:00:21.215749 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:00:21.218953 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:00:21.222245 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:00:21.225309 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:00:21.229674 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:00:21.237593 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:00:21.241027 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:00:21.260373 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:00:21.262425 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:00:21.264919 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:00:21.267523 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:00:22.445427 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m19:00:22.473694 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m19:00:22.478985 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m19:00:22.484275 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m19:00:22.655945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f9145e0>]}
[0m19:00:22.826098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16802d00a0>]}
[0m19:00:22.827003 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:00:22.827785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1680227850>]}
[0m19:00:22.842376 [info ] [MainThread]: 
[0m19:00:22.843698 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:00:22.846994 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:00:22.905263 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:00:22.906476 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:00:22.906839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:22.907185 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:24.165862 [debug] [ThreadPool]: SQL status: SELECT in 1.26 seconds
[0m19:00:24.169583 [debug] [ThreadPool]: On list_dev: Close
[0m19:00:24.172658 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:00:24.186678 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:00:24.187048 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:00:24.187302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:24.187557 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:25.272428 [debug] [ThreadPool]: SQL status: BEGIN in 1.09 seconds
[0m19:00:25.273526 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:00:25.274525 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:00:25.405072 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:00:25.409215 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:00:25.527700 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:00:25.554209 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:25.554782 [debug] [MainThread]: On master: BEGIN
[0m19:00:25.555243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:25.555672 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:26.657668 [debug] [MainThread]: SQL status: BEGIN in 1.1 seconds
[0m19:00:26.659047 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:26.659833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:26.818285 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m19:00:26.825136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1680326bb0>]}
[0m19:00:26.826951 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:26.946437 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:26.947583 [debug] [MainThread]: On master: BEGIN
[0m19:00:27.184771 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m19:00:27.186167 [debug] [MainThread]: On master: COMMIT
[0m19:00:27.187075 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:27.187801 [debug] [MainThread]: On master: COMMIT
[0m19:00:27.307906 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:00:27.309334 [debug] [MainThread]: On master: Close
[0m19:00:27.312269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:27.313808 [info ] [MainThread]: 
[0m19:00:27.342640 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:00:27.344579 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:00:27.347759 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:27.348360 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:00:27.348893 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:00:27.362619 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:00:27.363733 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:27.364190 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:00:27.642814 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:00:27.643863 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:27.644138 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:00:27.644410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:27.644793 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:28.768760 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m19:00:28.769187 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:28.769422 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:00:28.930832 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m19:00:28.968547 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:28.968929 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:00:29.088112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:00:29.103333 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.104292 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:00:29.225623 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:00:29.302853 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:00:29.303235 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.303468 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:00:29.458920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:00:29.460924 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.461636 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:00:29.580843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:29.598204 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.598552 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:00:29.721438 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:00:29.726628 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:00:29.727457 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.728312 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:00:29.880538 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:00:29.881698 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:00:29.882610 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:00:30.002104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:30.005280 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:30.006270 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:00:30.126442 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:00:30.130214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f90a3a0>]}
[0m19:00:30.132337 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.78s]
[0m19:00:30.134714 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:00:30.136121 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:00:30.138987 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:00:30.149195 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:30.150874 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:00:30.152202 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:00:30.176951 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:00:30.179735 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:30.180864 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:00:30.301400 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:00:30.303156 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:30.303744 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:00:30.304214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:30.304776 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:31.380196 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m19:00:31.381687 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:31.382559 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:00:31.508080 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:00:31.514119 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:31.514470 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:00:31.634787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:00:31.652559 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:31.653559 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:00:31.771850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:00:31.782344 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:00:31.783307 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:31.784070 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:00:31.929424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:00:31.931431 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:31.932333 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:00:32.049422 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:32.055034 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:32.055403 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:00:32.173827 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:00:32.176536 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:00:32.177152 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:32.177737 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:00:32.319030 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:00:32.320218 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:00:32.321106 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:00:32.440422 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:32.443366 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:32.444268 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:00:32.561602 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:00:32.564900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f8d9550>]}
[0m19:00:32.566879 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.42s]
[0m19:00:32.569839 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:00:32.571431 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:00:32.574567 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:00:32.578327 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:32.579759 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:00:32.580960 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:00:32.603699 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:00:32.604637 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:32.604974 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:00:32.619030 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:00:32.620091 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:32.620395 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:00:32.620688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:32.621086 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:33.813803 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m19:00:33.814433 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:33.814787 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:00:33.933938 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:00:33.939470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:33.939829 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:00:34.057515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:00:34.060523 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:00:34.060823 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:34.061071 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:00:34.208432 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:00:34.210391 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:34.211183 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:00:34.329544 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:34.347430 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:34.349481 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:00:34.467696 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:00:34.472695 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:00:34.473611 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:34.474335 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:00:34.613518 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:00:34.615238 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:00:34.616715 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:00:34.737026 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:00:34.741440 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:34.743291 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:00:34.872229 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:00:34.875431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f90b9d0>]}
[0m19:00:34.877565 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.30s]
[0m19:00:34.880150 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:00:34.881725 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:00:34.884443 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:00:34.893483 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:00:34.895239 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:00:34.896788 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:00:34.911059 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:00:34.912106 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:34.912530 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:00:34.924783 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:00:34.925844 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:00:34.926195 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:00:34.926502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:34.926837 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:36.040136 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m19:00:36.041227 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:00:36.042082 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
)

compradores as (

    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),

    top_10_compradores as (

        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:00:36.163129 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 14: compradores as (
         ^

[0m19:00:36.164354 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:00:36.287166 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:36.288593 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:00:36.291352 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 14: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:00:36.292803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f85772d3-93ff-48f5-85db-dd790252a3fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167d849520>]}
[0m19:00:36.294601 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.40s]
[0m19:00:36.296899 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:00:36.306901 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:00:36.308281 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:36.309633 [debug] [MainThread]: On master: BEGIN
[0m19:00:36.311078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:36.312061 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:00:37.425955 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m19:00:37.427533 [debug] [MainThread]: On master: COMMIT
[0m19:00:37.428614 [debug] [MainThread]: Using redshift connection "master"
[0m19:00:37.429835 [debug] [MainThread]: On master: COMMIT
[0m19:00:37.550116 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:00:37.551300 [debug] [MainThread]: On master: Close
[0m19:00:37.555692 [info ] [MainThread]: 
[0m19:00:37.557253 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.71 seconds (14.71s).
[0m19:00:37.559162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:37.560167 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:00:37.664304 [info ] [MainThread]: 
[0m19:00:37.664890 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:37.665455 [info ] [MainThread]: 
[0m19:00:37.666092 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m19:00:37.666704 [error] [MainThread]:   syntax error at or near "compradores"
[0m19:00:37.667418 [error] [MainThread]:   LINE 14: compradores as (
[0m19:00:37.668083 [error] [MainThread]:            ^
[0m19:00:37.668800 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:00:37.669558 [info ] [MainThread]: 
[0m19:00:37.670233 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:00:37.677532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f90b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1680242fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167f8ed3d0>]}


============================== 2022-08-15 19:01:21.030267 | 7aa4868c-3241-473f-b79d-d3be103c4a4a ==============================
[0m19:01:21.030303 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:01:21.031097 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:01:21.031683 [debug] [MainThread]: Tracking: tracking
[0m19:01:21.055915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c992100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c9920a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c992fd0>]}
[0m19:01:21.232000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:21.232843 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m19:01:21.265013 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m19:01:21.313206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c8a2f10>]}
[0m19:01:21.328074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c890cd0>]}
[0m19:01:21.328872 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:01:21.329390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c8f8fa0>]}
[0m19:01:21.333383 [info ] [MainThread]: 
[0m19:01:21.335003 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:01:21.340846 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:01:21.386088 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:01:21.386638 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:01:21.387069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:21.387424 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:23.164356 [debug] [ThreadPool]: SQL status: SELECT in 1.78 seconds
[0m19:01:23.170143 [debug] [ThreadPool]: On list_dev: Close
[0m19:01:23.176282 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:01:23.192054 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:01:23.192472 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:01:23.192813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:23.193105 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:24.301037 [debug] [ThreadPool]: SQL status: BEGIN in 1.11 seconds
[0m19:01:24.301653 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:01:24.302051 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:01:24.429164 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:01:24.433246 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:01:24.551078 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:01:24.564939 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:24.565523 [debug] [MainThread]: On master: BEGIN
[0m19:01:24.566046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:24.566543 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:25.667187 [debug] [MainThread]: SQL status: BEGIN in 1.1 seconds
[0m19:01:25.668338 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:25.669476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:25.821578 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m19:01:25.827939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c9c25b0>]}
[0m19:01:25.829693 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:26.024604 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:26.025731 [debug] [MainThread]: On master: BEGIN
[0m19:01:26.284070 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
[0m19:01:26.285219 [debug] [MainThread]: On master: COMMIT
[0m19:01:26.286152 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:26.286985 [debug] [MainThread]: On master: COMMIT
[0m19:01:26.408944 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:01:26.410134 [debug] [MainThread]: On master: Close
[0m19:01:26.412801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:26.414358 [info ] [MainThread]: 
[0m19:01:26.440769 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:01:26.443634 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:01:26.447439 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:26.448157 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:01:26.448947 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:01:26.462467 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:01:26.463411 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:26.463804 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:01:26.622270 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:01:26.623171 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:26.623464 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:01:26.623743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:26.624005 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:27.789189 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m19:01:27.789823 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:27.790299 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:01:27.962697 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m19:01:27.976289 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:27.976794 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:01:28.092203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:01:28.096993 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.097329 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:01:28.214532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:01:28.267589 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:01:28.268006 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.268307 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:01:28.424014 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m19:01:28.425968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.426714 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:01:28.545964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:28.573254 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.574246 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:01:28.692470 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:01:28.698270 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:01:28.699003 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.699683 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:01:28.842053 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:01:28.843203 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:01:28.844023 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:01:28.967426 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:28.970573 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:28.971472 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:01:29.098965 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:01:29.102246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c00d670>]}
[0m19:01:29.104218 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.66s]
[0m19:01:29.106912 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:01:29.108459 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:01:29.111694 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:01:29.117108 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:29.117963 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:01:29.118589 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:01:29.127510 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:01:29.129255 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:29.129989 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:01:29.266457 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:01:29.273558 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:29.279434 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:01:29.279849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:29.280249 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:30.388476 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m19:01:30.389814 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:30.390593 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSÃO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:01:30.516962 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m19:01:30.528611 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:30.529000 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:01:30.649345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:01:30.655130 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:30.655523 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:01:30.775201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:01:30.785013 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:01:30.785878 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:30.786699 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:01:30.935938 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:01:30.937894 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:30.938720 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:01:31.058232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:31.070404 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:31.071473 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:01:31.193692 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:01:31.198434 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:01:31.199365 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:31.200207 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:01:31.343139 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:01:31.344561 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:01:31.345716 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:01:31.468035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:31.471213 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:31.472284 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:01:31.591932 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:01:31.596191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff21f7cb7f0>]}
[0m19:01:31.598165 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.48s]
[0m19:01:31.601049 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:01:31.602670 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:01:31.605125 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:01:31.610400 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:31.611924 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:01:31.613373 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:01:31.638343 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:01:31.639557 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:31.640084 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:01:31.653622 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:01:31.654634 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:31.654936 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:01:31.655204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:31.655523 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:33.165858 [debug] [Thread-1  ]: SQL status: BEGIN in 1.51 seconds
[0m19:01:33.166993 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.167793 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:01:33.289450 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:01:33.294322 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.294634 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:01:33.413227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:01:33.420848 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:01:33.421785 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.422594 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:01:33.574507 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:01:33.576709 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.577582 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:01:33.697908 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:33.719973 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.720685 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:01:33.850932 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.13 seconds
[0m19:01:33.853240 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:01:33.853628 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.853988 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:01:33.994254 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:01:33.994893 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:01:33.995334 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:01:34.115884 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:01:34.117498 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:34.118145 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:01:34.236596 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:01:34.238245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff21f7cb8b0>]}
[0m19:01:34.239486 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.63s]
[0m19:01:34.240843 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:01:34.241462 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:01:34.242510 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:01:34.243996 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:01:34.244579 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:01:34.245090 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:01:34.263371 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:01:34.264783 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:34.265383 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:01:34.321341 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:01:34.323100 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:01:34.323598 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:01:34.323969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:34.324349 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:35.462255 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m19:01:35.463353 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:01:35.464105 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
)
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:01:35.583635 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 13: compradores as (
         ^

[0m19:01:35.584062 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:01:35.701467 [debug] [Thread-1  ]: finished collecting timing info
[0m19:01:35.702411 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:01:35.705166 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 13: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:01:35.706494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa4868c-3241-473f-b79d-d3be103c4a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff21dec7250>]}
[0m19:01:35.708056 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.46s]
[0m19:01:35.710437 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:01:35.721981 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:01:35.723008 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:35.723749 [debug] [MainThread]: On master: BEGIN
[0m19:01:35.724442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:35.725281 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:01:36.811045 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m19:01:36.812282 [debug] [MainThread]: On master: COMMIT
[0m19:01:36.812988 [debug] [MainThread]: Using redshift connection "master"
[0m19:01:36.813723 [debug] [MainThread]: On master: COMMIT
[0m19:01:36.940184 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m19:01:36.941595 [debug] [MainThread]: On master: Close
[0m19:01:36.944649 [info ] [MainThread]: 
[0m19:01:36.946129 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.61 seconds (15.61s).
[0m19:01:36.948149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:36.949410 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:01:36.996007 [info ] [MainThread]: 
[0m19:01:36.997223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:36.998109 [info ] [MainThread]: 
[0m19:01:37.013015 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m19:01:37.014887 [error] [MainThread]:   syntax error at or near "compradores"
[0m19:01:37.016518 [error] [MainThread]:   LINE 13: compradores as (
[0m19:01:37.017843 [error] [MainThread]:            ^
[0m19:01:37.019457 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:01:37.020180 [info ] [MainThread]: 
[0m19:01:37.020733 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:01:37.021451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22ca1fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22c8f8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff21df28c70>]}


============================== 2022-08-15 19:02:19.782817 | 4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56 ==============================
[0m19:02:19.782852 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:02:19.783633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:02:19.784004 [debug] [MainThread]: Tracking: tracking
[0m19:02:19.818286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac4571f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac4572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac4572e0>]}
[0m19:02:19.961797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:19.962673 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m19:02:19.994073 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m19:02:20.041622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac367f10>]}
[0m19:02:20.057355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac4698e0>]}
[0m19:02:20.058051 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:02:20.058660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac3aff10>]}
[0m19:02:20.062779 [info ] [MainThread]: 
[0m19:02:20.064583 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:02:20.068478 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:02:20.106015 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:02:20.107368 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:02:20.108243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:20.109372 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:21.239632 [debug] [ThreadPool]: SQL status: SELECT in 1.13 seconds
[0m19:02:21.247987 [debug] [ThreadPool]: On list_dev: Close
[0m19:02:21.256773 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:02:21.301701 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:02:21.302427 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:02:21.303040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:21.303431 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:22.668003 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
[0m19:02:22.669661 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:02:22.670817 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:02:22.800676 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:02:22.809290 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:02:22.932728 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:02:22.959874 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:22.960471 [debug] [MainThread]: On master: BEGIN
[0m19:02:22.960863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:22.961317 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:24.076456 [debug] [MainThread]: SQL status: BEGIN in 1.12 seconds
[0m19:02:24.077554 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:24.078403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:02:24.285495 [debug] [MainThread]: SQL status: SELECT in 0.21 seconds
[0m19:02:24.293080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac471790>]}
[0m19:02:24.294692 [debug] [MainThread]: On master: ROLLBACK
[0m19:02:24.423216 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:24.423878 [debug] [MainThread]: On master: BEGIN
[0m19:02:24.661996 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m19:02:24.663290 [debug] [MainThread]: On master: COMMIT
[0m19:02:24.664142 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:24.664986 [debug] [MainThread]: On master: COMMIT
[0m19:02:24.789608 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:02:24.790902 [debug] [MainThread]: On master: Close
[0m19:02:24.795212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:24.796764 [info ] [MainThread]: 
[0m19:02:24.817698 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:02:24.819031 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:02:24.820441 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:24.821052 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:02:24.821548 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:02:24.835921 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:02:24.837098 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:24.837640 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:02:25.055848 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:02:25.056827 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:25.057124 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:02:25.057417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:02:25.057708 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:26.147869 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m19:02:26.148581 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:26.149155 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:02:26.331977 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m19:02:26.360198 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:26.360779 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:02:26.476511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:02:26.483488 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:26.483914 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:02:26.601179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:02:26.657637 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:02:26.658089 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:26.658379 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:02:26.846553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m19:02:26.847743 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:26.848187 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:02:26.986562 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m19:02:27.020624 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:27.021699 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:02:27.208961 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.19 seconds
[0m19:02:27.213447 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:02:27.213937 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:27.214305 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:02:27.364557 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:02:27.365269 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:02:27.365693 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:02:27.550326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m19:02:27.553498 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:27.554435 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:02:27.672585 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:02:27.675742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ab299e50>]}
[0m19:02:27.677747 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.86s]
[0m19:02:27.681006 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:02:27.690502 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:02:27.693755 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:02:27.695537 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:27.695974 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:02:27.696433 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:02:27.701980 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:02:27.703221 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:27.703764 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:02:27.795855 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:02:27.797276 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:27.798044 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:02:27.798513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:02:27.799050 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:29.391625 [debug] [Thread-1  ]: SQL status: BEGIN in 1.59 seconds
[0m19:02:29.392782 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:29.393677 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:02:29.591231 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m19:02:29.611852 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:29.612828 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:02:29.775587 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m19:02:29.790415 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:29.791334 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:02:29.912851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:02:29.927986 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:02:29.929527 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:29.930569 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:02:30.079165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:02:30.081351 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:30.082276 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:02:30.265737 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m19:02:30.277058 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:30.277982 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:02:30.459303 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m19:02:30.464136 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:02:30.464988 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:30.465863 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:02:30.612280 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:02:30.613471 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:02:30.614359 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:02:30.867064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.25 seconds
[0m19:02:30.870162 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:30.871098 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:02:31.006384 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:02:31.012357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99abaeb7f0>]}
[0m19:02:31.015314 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 3.32s]
[0m19:02:31.023221 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:02:31.023941 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:02:31.024883 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:02:31.026737 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:31.027411 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:02:31.028021 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:02:31.043791 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:02:31.045022 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:31.045463 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:02:31.059676 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:02:31.060734 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:31.061150 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:02:31.061538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:02:31.061899 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:32.396581 [debug] [Thread-1  ]: SQL status: BEGIN in 1.33 seconds
[0m19:02:32.397666 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:32.398519 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:02:32.589826 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.19 seconds
[0m19:02:32.604793 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:32.605724 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:02:32.782469 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.18 seconds
[0m19:02:32.792874 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:02:32.793911 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:32.794769 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:02:32.949667 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:02:32.951664 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:32.952377 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:02:33.126125 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m19:02:33.137956 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:33.138933 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:02:33.258843 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:02:33.263526 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:02:33.264342 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:33.265188 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:02:33.436352 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m19:02:33.437526 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:02:33.438399 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:02:33.561881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:02:33.562999 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:33.563337 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:02:33.682050 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:02:33.685072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99abaeb8b0>]}
[0m19:02:33.686971 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.66s]
[0m19:02:33.689633 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:02:33.690860 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:02:33.693017 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:02:33.704810 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:02:33.705851 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:02:33.706695 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:02:33.727395 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:02:33.728821 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:33.729372 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:02:33.778838 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:02:33.780194 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:02:33.780878 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:02:33.781262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:02:33.781681 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:35.182049 [debug] [Thread-1  ]: SQL status: BEGIN in 1.4 seconds
[0m19:02:35.182641 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:02:35.183018 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
)
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:02:35.305909 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 13: compradores as (
         ^

[0m19:02:35.307036 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:02:35.429679 [debug] [Thread-1  ]: finished collecting timing info
[0m19:02:35.430821 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:02:35.433541 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 13: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:02:35.435380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8f44e2-6211-4fb4-9fd1-f9a2aedacc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a997c250>]}
[0m19:02:35.437523 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.74s]
[0m19:02:35.440385 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:02:35.449804 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:02:35.454801 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:35.455882 [debug] [MainThread]: On master: BEGIN
[0m19:02:35.457002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:35.457984 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:02:36.556419 [debug] [MainThread]: SQL status: BEGIN in 1.1 seconds
[0m19:02:36.557727 [debug] [MainThread]: On master: COMMIT
[0m19:02:36.558617 [debug] [MainThread]: Using redshift connection "master"
[0m19:02:36.559603 [debug] [MainThread]: On master: COMMIT
[0m19:02:36.679840 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:02:36.680400 [debug] [MainThread]: On master: Close
[0m19:02:36.681987 [info ] [MainThread]: 
[0m19:02:36.682870 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 16.62 seconds (16.62s).
[0m19:02:36.683625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:36.684070 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:02:36.715427 [info ] [MainThread]: 
[0m19:02:36.716793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:02:36.717638 [info ] [MainThread]: 
[0m19:02:36.718249 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m19:02:36.718898 [error] [MainThread]:   syntax error at or near "compradores"
[0m19:02:36.719467 [error] [MainThread]:   LINE 13: compradores as (
[0m19:02:36.719933 [error] [MainThread]:            ^
[0m19:02:36.720469 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:02:36.721023 [info ] [MainThread]: 
[0m19:02:36.721634 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:02:36.722491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99abaf63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a99dee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a99de580>]}


============================== 2022-08-15 19:04:01.642319 | d28f559b-6007-46bb-a88f-f7b23629a659 ==============================
[0m19:04:01.642364 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:04:01.643665 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:04:01.644786 [debug] [MainThread]: Tracking: tracking
[0m19:04:01.684706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066bce220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066bce2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066bce310>]}
[0m19:04:01.935562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:01.937960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:01.966002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066ad5160>]}
[0m19:04:02.017414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066b4fa60>]}
[0m19:04:02.020408 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:04:02.022902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066ad3f40>]}
[0m19:04:02.035227 [info ] [MainThread]: 
[0m19:04:02.039511 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:04:02.050352 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:04:02.109992 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:04:02.110962 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:04:02.115510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:02.117510 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:03.411525 [debug] [ThreadPool]: SQL status: SELECT in 1.3 seconds
[0m19:04:03.415162 [debug] [ThreadPool]: On list_dev: Close
[0m19:04:03.419452 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:04:03.446231 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:04:03.446846 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:04:03.447284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:03.448069 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:04.543374 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m19:04:04.543937 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:04:04.544351 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:04:04.672859 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:04:04.675607 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:04:04.791781 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:04:04.802169 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:04.802532 [debug] [MainThread]: On master: BEGIN
[0m19:04:04.802829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:04.803170 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:05.872900 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m19:04:05.873554 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:05.873937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:06.029035 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m19:04:06.031473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066b4f460>]}
[0m19:04:06.032109 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:06.152329 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:06.152923 [debug] [MainThread]: On master: BEGIN
[0m19:04:06.393428 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m19:04:06.394037 [debug] [MainThread]: On master: COMMIT
[0m19:04:06.394426 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:06.394778 [debug] [MainThread]: On master: COMMIT
[0m19:04:06.511358 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:04:06.511946 [debug] [MainThread]: On master: Close
[0m19:04:06.513432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:06.514146 [info ] [MainThread]: 
[0m19:04:06.523884 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:04:06.524802 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:04:06.526090 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:06.526589 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:04:06.527053 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:04:06.536725 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:04:06.538117 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:06.538764 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:04:06.859097 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:04:06.861426 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:06.861797 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:06.862255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:06.862857 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:08.042463 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
[0m19:04:08.042931 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.043297 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:04:08.200345 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m19:04:08.213031 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.213420 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:04:08.332240 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:08.338057 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.338453 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:04:08.461054 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:08.541101 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:08.541677 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.542073 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:08.694903 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:04:08.696352 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.696879 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:08.819128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:08.830284 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.830651 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:04:08.950198 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:04:08.951920 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:08.952213 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:08.952485 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:09.096615 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:09.097246 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:09.097571 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:09.215083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:09.216256 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:09.216570 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:04:09.334216 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:04:09.336098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe064a080d0>]}
[0m19:04:09.337081 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.81s]
[0m19:04:09.338172 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:04:09.338793 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:04:09.339899 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:04:09.341848 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:09.342538 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:04:09.345274 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:04:09.351912 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:04:09.353036 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:09.353552 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:04:09.449913 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:04:09.451807 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:09.452379 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:09.453455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:09.454051 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:10.557147 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m19:04:10.557946 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:10.558470 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:04:10.682131 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:04:10.689926 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:10.690382 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:04:10.808956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:10.827310 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:10.829200 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:04:10.949456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:10.954067 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:10.954481 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:10.954861 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:11.098407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:11.100451 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:11.101257 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:11.219488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:11.226242 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:11.226770 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:04:11.346471 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:04:11.351278 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:11.352165 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:11.352918 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:11.496122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:11.496676 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:11.497134 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:11.614538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:11.615951 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:11.616405 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:04:11.764280 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:04:11.767332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06624d5e0>]}
[0m19:04:11.769394 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.43s]
[0m19:04:11.772110 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:04:11.774338 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:04:11.777912 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:04:11.784071 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:11.786135 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:04:11.787408 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:04:11.798592 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:04:11.799710 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:11.800408 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:04:11.813766 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:04:11.815000 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:11.815451 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:11.815821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:11.816161 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:12.955744 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m19:04:12.956192 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:12.956465 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:04:13.076960 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:04:13.084383 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.084757 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:04:13.208470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:13.211445 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:13.211733 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.212010 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:13.358268 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:04:13.359209 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.359560 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:13.475765 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:13.481824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.482276 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:04:13.599097 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:04:13.600996 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:13.601303 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.601573 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:13.742906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:13.743472 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:13.744234 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:13.880901 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m19:04:13.882380 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:13.882927 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:04:13.999254 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:04:14.001001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe064933c10>]}
[0m19:04:14.001816 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.22s]
[0m19:04:14.002787 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:04:14.003311 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:04:14.004186 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:04:14.005178 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:14.005570 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:04:14.005947 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:04:14.013398 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:04:14.014534 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:14.015132 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:04:14.023866 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:04:14.024880 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:14.025197 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:04:14.025482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:14.025882 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:15.149097 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m19:04:15.149604 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:15.149961 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
)
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:04:15.272746 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "compradores"
LINE 13: compradores as (
         ^

[0m19:04:15.273215 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:04:15.396197 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:15.397310 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:04:15.400004 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "compradores"
  LINE 13: compradores as (
           ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:04:15.401420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28f559b-6007-46bb-a88f-f7b23629a659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0649c98e0>]}
[0m19:04:15.403185 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.40s]
[0m19:04:15.406051 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:04:15.417574 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:04:15.419375 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:15.420509 [debug] [MainThread]: On master: BEGIN
[0m19:04:15.421393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:15.422405 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:16.514738 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m19:04:16.515952 [debug] [MainThread]: On master: COMMIT
[0m19:04:16.516766 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:16.517610 [debug] [MainThread]: On master: COMMIT
[0m19:04:16.636103 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:04:16.637286 [debug] [MainThread]: On master: Close
[0m19:04:16.641971 [info ] [MainThread]: 
[0m19:04:16.643712 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.60 seconds (14.60s).
[0m19:04:16.646034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:16.648462 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:04:16.687613 [info ] [MainThread]: 
[0m19:04:16.688680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:04:16.689656 [info ] [MainThread]: 
[0m19:04:16.690489 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m19:04:16.691286 [error] [MainThread]:   syntax error at or near "compradores"
[0m19:04:16.692084 [error] [MainThread]:   LINE 13: compradores as (
[0m19:04:16.692802 [error] [MainThread]:            ^
[0m19:04:16.693426 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:04:16.694119 [info ] [MainThread]: 
[0m19:04:16.694855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:04:16.698750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066258460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066258430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066234df0>]}


============================== 2022-08-15 19:04:42.815398 | 183855de-d961-4a68-ac26-f18dc87f00df ==============================
[0m19:04:42.815446 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:04:42.825858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:04:42.826511 [debug] [MainThread]: Tracking: tracking
[0m19:04:42.896572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0b71c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0abff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0ae7040>]}
[0m19:04:43.089259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:43.091036 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m19:04:43.146738 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m19:04:43.222132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c09e4f70>]}
[0m19:04:43.242430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c09c8e20>]}
[0m19:04:43.243461 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:04:43.245180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0a2efd0>]}
[0m19:04:43.253678 [info ] [MainThread]: 
[0m19:04:43.255317 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:04:43.262053 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:04:43.311863 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:04:43.314201 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:04:43.316898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:43.317644 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:44.441291 [debug] [ThreadPool]: SQL status: SELECT in 1.12 seconds
[0m19:04:44.450650 [debug] [ThreadPool]: On list_dev: Close
[0m19:04:44.462304 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:04:44.498226 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:04:44.498713 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:04:44.499079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:44.499461 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:45.594592 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m19:04:45.595665 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:04:45.596405 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:04:45.725869 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:04:45.735285 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:04:45.854324 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:04:45.886711 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:45.887825 [debug] [MainThread]: On master: BEGIN
[0m19:04:45.888608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:45.889473 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:46.973661 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m19:04:46.974687 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:46.975429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:47.130564 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m19:04:47.134711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c09c88e0>]}
[0m19:04:47.135629 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:47.253485 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:47.254620 [debug] [MainThread]: On master: BEGIN
[0m19:04:47.488492 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m19:04:47.490284 [debug] [MainThread]: On master: COMMIT
[0m19:04:47.491452 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:47.492478 [debug] [MainThread]: On master: COMMIT
[0m19:04:47.611359 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:04:47.612691 [debug] [MainThread]: On master: Close
[0m19:04:47.615479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:47.617110 [info ] [MainThread]: 
[0m19:04:47.644340 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:04:47.645696 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:04:47.648468 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:47.649104 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:04:47.649541 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:04:47.665374 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:04:47.666608 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:47.667049 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:04:47.862955 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:04:47.863891 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:47.864233 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:47.864492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:47.864767 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:48.990883 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m19:04:48.991978 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:48.992731 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:04:49.170821 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m19:04:49.209534 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.210102 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:04:49.328879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:49.344796 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.345818 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:04:49.469214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:49.543613 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:49.543970 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.544220 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:49.698558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:04:49.699410 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.699658 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:49.833095 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m19:04:49.843289 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.843631 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:04:49.962379 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:04:49.964963 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:49.965443 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:49.965863 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:04:50.108063 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:50.108848 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:04:50.109294 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:04:50.229333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:50.233568 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:50.234929 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:04:50.355026 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:04:50.358095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c011eeb0>]}
[0m19:04:50.360467 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.71s]
[0m19:04:50.363509 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:04:50.365320 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:04:50.368439 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:04:50.376164 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:50.376839 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:04:50.377743 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:04:50.385439 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:04:50.387181 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:50.387890 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:04:50.491141 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:04:50.492504 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:50.493073 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:50.493411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:50.493708 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:51.596359 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m19:04:51.596784 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:51.597031 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:04:51.722085 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:04:51.742714 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:51.743720 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:04:51.862092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:51.870757 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:51.871460 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:04:51.989787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:52.000253 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:52.001553 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:52.002706 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:52.144223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:52.145196 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:52.145586 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:52.256577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m19:04:52.260354 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:52.260677 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:04:52.381653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:04:52.386585 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:52.387470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:52.388307 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:04:52.527869 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:52.528318 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:04:52.528609 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:04:52.647478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:52.650605 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:52.651469 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:04:52.768324 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:04:52.769543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0105850>]}
[0m19:04:52.770290 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.39s]
[0m19:04:52.771108 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:04:52.771736 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:04:52.772568 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:04:52.775448 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:52.778070 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:04:52.779763 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:04:52.804636 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:04:52.805827 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:52.806298 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:04:52.821276 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:04:52.822243 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:52.822569 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:52.822834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:52.823126 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:53.937957 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m19:04:53.939129 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:53.939892 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:04:54.062424 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:04:54.068869 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.069280 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:04:54.189278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:04:54.198180 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:54.199062 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.199724 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:54.343539 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:54.345506 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.346272 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:54.464968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:54.470895 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.471348 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:04:54.595246 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:04:54.598391 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:54.599078 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.599499 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:04:54.738959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:04:54.739996 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:04:54.740755 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:04:54.859121 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:04:54.860332 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:54.860714 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:04:54.978487 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:04:54.979873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c00d2790>]}
[0m19:04:54.980676 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.21s]
[0m19:04:54.981525 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:04:54.982095 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:04:54.982929 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:04:54.984244 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:54.984710 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:04:54.985249 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:04:54.993420 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:04:54.994399 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:54.994976 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:04:55.007867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:04:55.009322 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:55.009775 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:04:55.010328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:55.010727 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:56.136541 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m19:04:56.137621 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:04:56.138362 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            group GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:04:56.261578 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "GROUP"
LINE 26:             group GROUP BY compradores.userid, compradores.N...
                           ^

[0m19:04:56.263149 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:04:56.384868 [debug] [Thread-1  ]: finished collecting timing info
[0m19:04:56.385978 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:04:56.388100 [debug] [Thread-1  ]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  syntax error at or near "GROUP"
  LINE 26:             group GROUP BY compradores.userid, compradores.N...
                             ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:04:56.389890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183855de-d961-4a68-ac26-f18dc87f00df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b1fc82b0>]}
[0m19:04:56.391894 [error] [Thread-1  ]: 4 of 4 ERROR creating table model public.tb_10_compradores ..................... [[31mERROR[0m in 1.41s]
[0m19:04:56.394184 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:04:56.406989 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:04:56.407710 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:56.408130 [debug] [MainThread]: On master: BEGIN
[0m19:04:56.408571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:56.409296 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:04:57.561808 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m19:04:57.562953 [debug] [MainThread]: On master: COMMIT
[0m19:04:57.563819 [debug] [MainThread]: Using redshift connection "master"
[0m19:04:57.564716 [debug] [MainThread]: On master: COMMIT
[0m19:04:57.683412 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:04:57.684601 [debug] [MainThread]: On master: Close
[0m19:04:57.687475 [info ] [MainThread]: 
[0m19:04:57.690084 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m19:04:57.692327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:57.693367 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:04:57.717074 [info ] [MainThread]: 
[0m19:04:57.717773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:04:57.719711 [info ] [MainThread]: 
[0m19:04:57.721445 [error] [MainThread]: [33mDatabase Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)[0m
[0m19:04:57.722259 [error] [MainThread]:   syntax error at or near "GROUP"
[0m19:04:57.722947 [error] [MainThread]:   LINE 26:             group GROUP BY compradores.userid, compradores.N...
[0m19:04:57.723617 [error] [MainThread]:                              ^
[0m19:04:57.724304 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m19:04:57.724951 [info ] [MainThread]: 
[0m19:04:57.725627 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:04:57.726579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0b71c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0072040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0064e50>]}


============================== 2022-08-15 19:05:34.803577 | e6179dc4-e11e-43de-9383-3f5d02dfd7fb ==============================
[0m19:05:34.803611 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:05:34.804398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:05:34.804769 [debug] [MainThread]: Tracking: tracking
[0m19:05:34.838251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd1092b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd109370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd1093a0>]}
[0m19:05:35.075684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:05:35.076551 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m19:05:35.110955 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m19:05:35.175458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd008f40>]}
[0m19:05:35.192062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd124850>]}
[0m19:05:35.192796 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:05:35.193447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd05ffd0>]}
[0m19:05:35.200033 [info ] [MainThread]: 
[0m19:05:35.202731 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:05:35.208575 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m19:05:35.265317 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:05:35.265864 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m19:05:35.266325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:35.266814 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:36.551291 [debug] [ThreadPool]: SQL status: SELECT in 1.28 seconds
[0m19:05:36.554016 [debug] [ThreadPool]: On list_dev: Close
[0m19:05:36.556831 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m19:05:36.571376 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:05:36.571764 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:05:36.572034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:36.572344 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:37.654984 [debug] [ThreadPool]: SQL status: BEGIN in 1.08 seconds
[0m19:05:37.656090 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:05:37.656971 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:05:37.785013 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m19:05:37.793904 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:05:37.913943 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:05:37.947363 [debug] [MainThread]: Using redshift connection "master"
[0m19:05:37.948432 [debug] [MainThread]: On master: BEGIN
[0m19:05:37.949870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:37.950840 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:39.126676 [debug] [MainThread]: SQL status: BEGIN in 1.18 seconds
[0m19:05:39.127925 [debug] [MainThread]: Using redshift connection "master"
[0m19:05:39.128877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:39.288529 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m19:05:39.295568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd122070>]}
[0m19:05:39.297544 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:39.416955 [debug] [MainThread]: Using redshift connection "master"
[0m19:05:39.418039 [debug] [MainThread]: On master: BEGIN
[0m19:05:39.660330 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m19:05:39.661495 [debug] [MainThread]: On master: COMMIT
[0m19:05:39.662423 [debug] [MainThread]: Using redshift connection "master"
[0m19:05:39.663337 [debug] [MainThread]: On master: COMMIT
[0m19:05:39.782344 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:05:39.782835 [debug] [MainThread]: On master: Close
[0m19:05:39.784388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:39.784987 [info ] [MainThread]: 
[0m19:05:39.793343 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:05:39.794843 [info ] [Thread-1  ]: 1 of 4 START table model public.my_first_dbt_model ............................. [RUN]
[0m19:05:39.796457 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:39.797159 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:05:39.797771 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m19:05:39.811362 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:05:39.812559 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:39.813140 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:05:40.129146 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:05:40.131123 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:40.131960 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:05:40.132802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:40.133509 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:41.272337 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m19:05:41.273725 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:41.274413 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:05:41.471779 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m19:05:41.505693 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:41.506610 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:05:41.624148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:05:41.633795 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:41.635539 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:05:41.759493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:05:41.816831 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:05:41.817303 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:41.817724 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:05:41.972311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:05:41.973797 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:41.974558 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:05:42.094958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:05:42.117044 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:42.117762 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:05:42.236162 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:05:42.238056 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:05:42.238369 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:42.238703 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:05:42.391798 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m19:05:42.393125 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:05:42.393970 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:05:42.527950 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m19:05:42.531146 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:42.532104 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:05:42.656668 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:05:42.661451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc74de80>]}
[0m19:05:42.664120 [info ] [Thread-1  ]: 1 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.87s]
[0m19:05:42.666599 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:05:42.667946 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m19:05:42.670795 [info ] [Thread-1  ]: 2 of 4 START view model public.vw_sales ........................................ [RUN]
[0m19:05:42.686068 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:42.688097 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m19:05:42.689610 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m19:05:42.698317 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m19:05:42.699823 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:42.700349 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m19:05:42.894069 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m19:05:42.895751 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:42.896299 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:05:42.896709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:42.897177 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:43.980303 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m19:05:43.980717 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:43.980996 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m19:05:44.104277 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:05:44.128493 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.130177 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m19:05:44.254372 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:05:44.269595 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.270506 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m19:05:44.389172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:05:44.399169 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:05:44.400040 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.400866 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:05:44.564918 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m19:05:44.566787 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.567543 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:05:44.686591 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:05:44.699477 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.700426 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m19:05:44.822099 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:05:44.824798 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:05:44.825274 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.825714 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m19:05:44.971116 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:05:44.972260 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m19:05:44.973120 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m19:05:45.089968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:05:45.091866 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:45.092367 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m19:05:45.209908 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m19:05:45.214661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc6d07c0>]}
[0m19:05:45.217177 [info ] [Thread-1  ]: 2 of 4 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.54s]
[0m19:05:45.219956 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m19:05:45.221652 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:05:45.224988 [info ] [Thread-1  ]: 3 of 4 START view model public.my_second_dbt_model ............................. [RUN]
[0m19:05:45.229568 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:45.232014 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:05:45.233818 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m19:05:45.248346 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:05:45.249413 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:45.249861 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:05:45.264871 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:05:45.265990 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:45.266384 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:05:45.266778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:45.269837 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:46.363869 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m19:05:46.364972 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:46.365766 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m19:05:46.489519 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m19:05:46.505362 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:46.506325 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:05:46.627282 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m19:05:46.636164 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:05:46.637157 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:46.637969 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:05:46.780556 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:05:46.781505 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:46.781812 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:05:46.897608 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:05:46.902096 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:46.902432 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:05:47.018908 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m19:05:47.023015 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:05:47.023667 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:47.024291 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:05:47.162736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m19:05:47.163882 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:05:47.164559 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:05:47.284237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:05:47.287239 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:47.288146 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:05:47.405486 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:05:47.409354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc702e50>]}
[0m19:05:47.411437 [info ] [Thread-1  ]: 3 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.18s]
[0m19:05:47.414092 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:05:47.416069 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m19:05:47.419541 [info ] [Thread-1  ]: 4 of 4 START table model public.tb_10_compradores .............................. [RUN]
[0m19:05:47.427629 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:05:47.429151 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m19:05:47.430453 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m19:05:47.439778 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:05:47.440770 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:47.441240 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m19:05:47.450798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m19:05:47.451811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:05:47.452137 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:05:47.452515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:47.452823 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:05:48.541698 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m19:05:48.542670 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:05:48.543550 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m19:06:03.005470 [debug] [Thread-1  ]: SQL status: SELECT in 14.46 seconds
[0m19:06:03.011408 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.011867 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m19:06:03.138878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m19:06:03.142399 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m19:06:03.142707 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.142976 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m19:06:03.299891 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m19:06:03.300662 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.300921 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:06:03.424180 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:06:03.430238 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.430587 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m19:06:03.554111 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m19:06:03.555942 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m19:06:03.556266 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.556537 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m19:06:03.676688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m19:06:03.677144 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m19:06:03.677427 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m19:06:03.795066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m19:06:03.796310 [debug] [Thread-1  ]: finished collecting timing info
[0m19:06:03.796677 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m19:06:03.914837 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m19:06:03.916477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6179dc4-e11e-43de-9383-3f5d02dfd7fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc62d8e0>]}
[0m19:06:03.917304 [info ] [Thread-1  ]: 4 of 4 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 16.49s]
[0m19:06:03.918216 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m19:06:03.922479 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m19:06:03.923202 [debug] [MainThread]: Using redshift connection "master"
[0m19:06:03.923711 [debug] [MainThread]: On master: BEGIN
[0m19:06:03.924160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:03.924643 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m19:06:05.083324 [debug] [MainThread]: SQL status: BEGIN in 1.16 seconds
[0m19:06:05.083907 [debug] [MainThread]: On master: COMMIT
[0m19:06:05.084352 [debug] [MainThread]: Using redshift connection "master"
[0m19:06:05.084720 [debug] [MainThread]: On master: COMMIT
[0m19:06:05.201396 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m19:06:05.202079 [debug] [MainThread]: On master: Close
[0m19:06:05.204224 [info ] [MainThread]: 
[0m19:06:05.205123 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 30.00 seconds (30.00s).
[0m19:06:05.205838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:05.206252 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m19:06:05.235248 [info ] [MainThread]: 
[0m19:06:05.236145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:05.237166 [info ] [MainThread]: 
[0m19:06:05.237888 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:06:05.238974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc791400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fd063040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fc731c70>]}


============================== 2022-08-15 20:02:18.426040 | 1b585004-8bf7-4c8e-a004-ce55b24ad49a ==============================
[0m20:02:18.426085 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:02:18.428429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_trimestre_1.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:02:18.429077 [debug] [MainThread]: Tracking: tracking
[0m20:02:18.535286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c249220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c2492e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c249310>]}
[0m20:02:18.694187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:02:18.695001 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_trimestre_1.sql
[0m20:02:18.872939 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_trimestre_1.sql
[0m20:02:18.914978 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_trimestre_1.sql
[0m20:02:18.915891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c1658b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c14b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606c1af220>]}


============================== 2022-08-15 20:07:16.202641 | af18cfea-05c1-4f57-af14-ee9d8476e19c ==============================
[0m20:07:16.202675 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:07:16.203441 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:07:16.203818 [debug] [MainThread]: Tracking: tracking
[0m20:07:16.237154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2b921c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2b92280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2b922b0>]}
[0m20:07:16.506327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:07:16.507394 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_trimestre_1.sql
[0m20:07:16.548121 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_trimestre_1.sql
[0m20:07:16.578346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_trimestre_1.sql
[0m20:07:16.607389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a75f40>]}
[0m20:07:16.625836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a81220>]}
[0m20:07:16.626566 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:07:16.627119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a81e50>]}
[0m20:07:16.632849 [info ] [MainThread]: 
[0m20:07:16.634446 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:07:16.638221 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m20:07:16.681321 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:07:16.681820 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m20:07:16.682155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:16.682496 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:18.629143 [debug] [ThreadPool]: SQL status: SELECT in 1.95 seconds
[0m20:07:18.637911 [debug] [ThreadPool]: On list_dev: Close
[0m20:07:18.647530 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:07:18.672129 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:07:18.672506 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:07:18.672984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:18.673403 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:19.974908 [debug] [ThreadPool]: SQL status: BEGIN in 1.3 seconds
[0m20:07:19.976125 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:07:19.977151 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:07:20.174702 [debug] [ThreadPool]: SQL status: SELECT in 0.2 seconds
[0m20:07:20.183208 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:07:20.306225 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:07:20.342051 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:20.343131 [debug] [MainThread]: On master: BEGIN
[0m20:07:20.343492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:20.343883 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:21.630413 [debug] [MainThread]: SQL status: BEGIN in 1.29 seconds
[0m20:07:21.632490 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:21.634008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:21.856244 [debug] [MainThread]: SQL status: SELECT in 0.22 seconds
[0m20:07:21.860546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a15b80>]}
[0m20:07:21.861425 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:22.038632 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:22.039768 [debug] [MainThread]: On master: BEGIN
[0m20:07:22.345060 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
[0m20:07:22.345818 [debug] [MainThread]: On master: COMMIT
[0m20:07:22.346627 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:22.347474 [debug] [MainThread]: On master: COMMIT
[0m20:07:22.465899 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:07:22.466451 [debug] [MainThread]: On master: Close
[0m20:07:22.467484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:22.468000 [info ] [MainThread]: 
[0m20:07:22.478991 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:07:22.479890 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
[0m20:07:22.481897 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:22.482527 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:07:22.482991 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m20:07:22.495327 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:07:22.496553 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:22.497069 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:07:22.776442 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:07:22.788419 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:22.788962 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:07:22.789349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:22.789718 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:23.923659 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m20:07:23.924755 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:23.925639 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:07:24.087904 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m20:07:24.126182 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.126635 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:07:24.244431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:24.252566 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.253062 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:07:24.374284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:24.443068 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:07:24.443449 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.443707 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:07:24.603803 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:07:24.605941 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.606794 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:07:24.728611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:24.755519 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.755883 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:07:24.877185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:07:24.882067 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:07:24.882954 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:24.883896 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:07:25.038488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:07:25.039800 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:07:25.040626 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:07:25.159423 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:25.162804 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:25.163753 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:07:25.300964 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:07:25.304301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d21e00d0>]}
[0m20:07:25.306263 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.82s]
[0m20:07:25.308959 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:07:25.310421 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m20:07:25.313786 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
[0m20:07:25.320916 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:25.323322 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m20:07:25.324223 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m20:07:25.329518 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:07:25.330808 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:25.331235 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m20:07:25.435117 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m20:07:25.437220 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:25.437695 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:07:25.438079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:25.438376 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:26.540449 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:07:26.541563 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:26.542386 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m20:07:26.668914 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m20:07:26.685487 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:26.686394 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m20:07:26.808458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:26.823319 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:26.823651 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:07:26.945556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:26.955409 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:07:26.956399 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:26.957276 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:07:27.108610 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:07:27.110559 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:27.111348 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:07:27.233191 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:27.247444 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:27.248423 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:07:27.371690 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:07:27.376126 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:07:27.377437 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:27.378522 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:07:27.522523 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:07:27.523656 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:07:27.524394 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:07:27.646892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:27.649840 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:27.650733 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:07:27.766416 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m20:07:27.768285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2aa6070>]}
[0m20:07:27.769120 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.45s]
[0m20:07:27.769983 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m20:07:27.770502 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:07:27.771601 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
[0m20:07:27.773280 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:27.773843 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:07:27.774363 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m20:07:27.784711 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:07:27.785990 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:27.786486 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:07:27.801980 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:07:27.803523 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:27.804523 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:07:27.804931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:27.805608 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:29.061982 [debug] [Thread-1  ]: SQL status: BEGIN in 1.26 seconds
[0m20:07:29.063109 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.063983 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m20:07:29.193214 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m20:07:29.209342 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.210306 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:07:29.330539 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:29.340116 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:07:29.341040 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.341896 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:07:29.481492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:07:29.483563 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.484366 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:07:29.603950 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:29.607720 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.608038 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:07:29.732594 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:07:29.738130 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:07:29.739155 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.740161 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:07:29.882917 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:07:29.884192 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:07:29.885065 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:07:30.011527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m20:07:30.014492 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:30.015458 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:07:30.134941 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:07:30.139086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d0973a90>]}
[0m20:07:30.141094 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.37s]
[0m20:07:30.143456 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:07:30.145103 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:07:30.147613 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
[0m20:07:30.156049 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:30.157027 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:07:30.157705 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m20:07:30.172483 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:07:30.175147 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:30.176083 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:07:30.195427 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:07:30.197562 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:30.198162 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:07:30.198692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:30.199254 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:31.300227 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:07:31.301332 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:31.302093 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m20:07:31.782741 [debug] [Thread-1  ]: SQL status: SELECT in 0.48 seconds
[0m20:07:31.800305 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:31.801245 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
[0m20:07:31.919579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:07:31.934968 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:31.935924 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m20:07:32.067973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m20:07:32.080899 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:07:32.081841 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:32.083067 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:07:32.240622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:07:32.242334 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:32.243130 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:07:32.363251 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:32.374745 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:32.375592 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m20:07:32.499875 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:07:32.503760 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:07:32.505054 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:32.506137 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:07:32.651342 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:07:32.652646 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:07:32.653421 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:07:32.771654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:07:32.772711 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:32.773039 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:07:32.892091 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:07:32.895699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d08fd190>]}
[0m20:07:32.897592 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 2.74s]
[0m20:07:32.900209 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:07:32.901686 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:07:32.904172 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_trimestre_1 .......................... [RUN]
[0m20:07:32.909256 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:07:32.911031 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:07:32.912453 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_trimestre_1
[0m20:07:32.930965 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:07:32.935601 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:32.936324 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:07:32.951590 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:07:32.952926 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:07:32.953287 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:07:32.953587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:32.954075 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:34.568235 [debug] [Thread-1  ]: SQL status: BEGIN in 1.61 seconds
[0m20:07:34.569791 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:07:34.570724 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */


  create  table
    "dev"."public"."tb_vendas_trimestre_1__dbt_tmp"
    
    
    
  as (
    -- define as variáveis: meses e ano




-- cria a fonte com os dados de Date e converte nome das colunas
with source_date as (
    SELECT dateid as id_date,
        month as mes,
        year as ano
    FROM date
),

-- cria uma fonte de dados unindo a tebela sales com date
sales_date as (
    SELECT source_date.mes,
           sum(quantidade_vendida)
    FROM "dev"."public"."vw_sales" sales INNER JOIN source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group_by source_date.mes
)
select * from sales_date
  );
[0m20:07:34.694048 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "group_by"
LINE 31:     group_by source_date.mes
             ^

[0m20:07:34.695275 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: ROLLBACK
[0m20:07:34.817422 [debug] [Thread-1  ]: finished collecting timing info
[0m20:07:34.818628 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: Close
[0m20:07:34.821871 [debug] [Thread-1  ]: Database Error in model tb_vendas_trimestre_1 (models/tables/tb_vendas_trimestre_1.sql)
  syntax error at or near "group_by"
  LINE 31:     group_by source_date.mes
               ^
  compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_trimestre_1.sql
[0m20:07:34.823311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af18cfea-05c1-4f57-af14-ee9d8476e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d21d7100>]}
[0m20:07:34.825100 [error] [Thread-1  ]: 5 of 5 ERROR creating table model public.tb_vendas_trimestre_1 ................. [[31mERROR[0m in 1.92s]
[0m20:07:34.827573 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:07:34.840739 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:07:34.842867 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:34.843824 [debug] [MainThread]: On master: BEGIN
[0m20:07:34.845159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:34.846420 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:07:35.965175 [debug] [MainThread]: SQL status: BEGIN in 1.12 seconds
[0m20:07:35.966367 [debug] [MainThread]: On master: COMMIT
[0m20:07:35.967239 [debug] [MainThread]: Using redshift connection "master"
[0m20:07:35.968100 [debug] [MainThread]: On master: COMMIT
[0m20:07:36.085955 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:07:36.087367 [debug] [MainThread]: On master: Close
[0m20:07:36.092914 [info ] [MainThread]: 
[0m20:07:36.100190 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 19.46 seconds (19.46s).
[0m20:07:36.103526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:36.104863 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_trimestre_1' was properly closed.
[0m20:07:36.151020 [info ] [MainThread]: 
[0m20:07:36.151725 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:07:36.153286 [info ] [MainThread]: 
[0m20:07:36.156007 [error] [MainThread]: [33mDatabase Error in model tb_vendas_trimestre_1 (models/tables/tb_vendas_trimestre_1.sql)[0m
[0m20:07:36.157304 [error] [MainThread]:   syntax error at or near "group_by"
[0m20:07:36.159460 [error] [MainThread]:   LINE 31:     group_by source_date.mes
[0m20:07:36.161588 [error] [MainThread]:                ^
[0m20:07:36.162894 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/models/tables/tb_vendas_trimestre_1.sql
[0m20:07:36.163840 [info ] [MainThread]: 
[0m20:07:36.164484 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:07:36.165523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a81eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d2a81d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d0985c40>]}


============================== 2022-08-15 20:08:25.496446 | 4b1bae72-20d7-44e7-8fa6-364c916eed3c ==============================
[0m20:08:25.496487 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:08:25.497212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:08:25.497586 [debug] [MainThread]: Tracking: tracking
[0m20:08:25.538942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de90190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de90250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de90280>]}
[0m20:08:25.673444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:25.674302 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_vendas_trimestre_1.sql
[0m20:08:25.703474 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_trimestre_1.sql
[0m20:08:25.733972 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_trimestre_1.sql
[0m20:08:25.757384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dd59f40>]}
[0m20:08:25.772264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de14fd0>]}
[0m20:08:25.773254 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:08:25.773857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de904f0>]}
[0m20:08:25.777879 [info ] [MainThread]: 
[0m20:08:25.780778 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:08:25.784183 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m20:08:25.827278 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:08:25.829173 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m20:08:25.830511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:25.831730 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:27.051081 [debug] [ThreadPool]: SQL status: SELECT in 1.22 seconds
[0m20:08:27.053561 [debug] [ThreadPool]: On list_dev: Close
[0m20:08:27.056704 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:08:27.071138 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:08:27.071492 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:08:27.071759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:27.072023 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:28.163498 [debug] [ThreadPool]: SQL status: BEGIN in 1.09 seconds
[0m20:08:28.164933 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:08:28.166134 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:08:28.294940 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:08:28.302999 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:08:28.420926 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:08:28.446672 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:28.447071 [debug] [MainThread]: On master: BEGIN
[0m20:08:28.447304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:28.447559 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:29.555630 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m20:08:29.556714 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:29.557589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:08:29.737416 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
[0m20:08:29.744448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dd16af0>]}
[0m20:08:29.746112 [debug] [MainThread]: On master: ROLLBACK
[0m20:08:29.865366 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:29.866458 [debug] [MainThread]: On master: BEGIN
[0m20:08:30.105878 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:08:30.107088 [debug] [MainThread]: On master: COMMIT
[0m20:08:30.107969 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:30.108902 [debug] [MainThread]: On master: COMMIT
[0m20:08:30.229884 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:08:30.231057 [debug] [MainThread]: On master: Close
[0m20:08:30.234936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:30.236565 [info ] [MainThread]: 
[0m20:08:30.271537 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:08:30.273936 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
[0m20:08:30.276931 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:30.277667 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:08:30.278188 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m20:08:30.293974 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:08:30.295182 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:30.295761 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:08:30.613904 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:08:30.615261 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:30.615737 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:08:30.616160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:30.616541 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:31.777717 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m20:08:31.779092 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:31.780194 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:08:31.939798 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m20:08:31.981532 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:31.982527 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:08:32.141199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m20:08:32.149468 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:32.150017 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:08:32.267784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:08:32.348060 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:08:32.348433 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:32.348738 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:08:32.537119 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m20:08:32.540257 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:32.541329 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:08:32.664604 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:32.683490 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:32.684149 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:08:32.844255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.16 seconds
[0m20:08:32.847449 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:08:32.848023 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:32.848447 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:08:33.004619 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:08:33.005506 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:08:33.006084 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:08:33.186010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m20:08:33.189368 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:33.190316 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:08:33.308774 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:08:33.311244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d4df040>]}
[0m20:08:33.312418 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 3.04s]
[0m20:08:33.314095 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:08:33.315263 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m20:08:33.317119 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
[0m20:08:33.320745 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:33.321730 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m20:08:33.322609 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m20:08:33.333919 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:08:33.335093 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:33.335569 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m20:08:33.440410 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m20:08:33.442366 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:33.442887 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:08:33.443277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:33.443597 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:34.727864 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m20:08:34.728403 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:34.728876 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m20:08:34.861734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m20:08:34.868010 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:34.868525 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m20:08:35.052692 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.18 seconds
[0m20:08:35.067468 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.068458 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:08:35.244943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.18 seconds
[0m20:08:35.259957 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:08:35.264296 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.266077 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:08:35.420201 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:08:35.422246 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.423098 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:08:35.540772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:35.552133 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.553291 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:08:35.740946 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.19 seconds
[0m20:08:35.745629 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:08:35.746511 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.747221 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:08:35.930848 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m20:08:35.932052 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:08:35.932806 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:08:36.052518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:36.055220 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:36.056144 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:08:36.241840 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m20:08:36.245284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dda2f70>]}
[0m20:08:36.247171 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.93s]
[0m20:08:36.250381 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m20:08:36.252035 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:08:36.256365 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
[0m20:08:36.260693 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:36.262098 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:08:36.265366 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m20:08:36.278241 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:08:36.279606 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:36.279965 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:08:36.294349 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:08:36.295807 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:36.298475 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:08:36.299242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:36.299888 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:37.565082 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
[0m20:08:37.566085 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:37.566856 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m20:08:37.691286 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m20:08:37.703808 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:37.704548 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:08:37.824711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:08:37.832780 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:08:37.833952 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:37.834896 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:08:37.979363 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:08:37.981299 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:37.982048 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:08:38.101772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:38.113433 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:38.114404 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:08:38.233588 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:08:38.235433 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:08:38.235782 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:38.236062 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:08:38.377159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:08:38.378387 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:08:38.379559 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:08:38.501411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:38.504484 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:38.505452 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:08:38.626691 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:08:38.630672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dcf6280>]}
[0m20:08:38.632714 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.37s]
[0m20:08:38.635900 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:08:38.638149 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:08:38.640702 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
[0m20:08:38.649733 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:38.652556 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:08:38.653751 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m20:08:38.673904 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:08:38.674999 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:38.675467 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:08:38.693847 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:08:38.695901 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:38.697121 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:08:38.698126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:38.699250 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:40.356311 [debug] [Thread-1  ]: SQL status: BEGIN in 1.66 seconds
[0m20:08:40.356987 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:40.357462 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m20:08:40.611590 [debug] [Thread-1  ]: SQL status: SELECT in 0.25 seconds
[0m20:08:40.619949 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:40.620289 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
[0m20:08:40.742347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:08:40.754665 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:40.755392 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m20:08:40.874150 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:08:40.877924 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:08:40.878225 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:40.878493 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:08:41.035624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:08:41.036440 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:41.036695 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:08:41.155597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:41.168814 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:41.169909 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m20:08:41.289242 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:08:41.291999 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:08:41.292556 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:41.292941 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:08:41.438423 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:08:41.438982 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:08:41.439253 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:08:41.567184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m20:08:41.570331 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:41.571307 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:08:41.689786 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:08:41.692207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015c3fc0a0>]}
[0m20:08:41.693408 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 3.05s]
[0m20:08:41.694728 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:08:41.695829 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:08:41.697397 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_trimestre_1 .......................... [RUN]
[0m20:08:41.699811 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:41.701704 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:08:41.705751 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_trimestre_1
[0m20:08:41.727472 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:41.729445 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:41.730492 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:08:41.747768 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:41.748865 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:41.749246 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:08:41.749613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:41.750157 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:42.920879 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m20:08:42.921709 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:42.922184 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */


  create  table
    "dev"."public"."tb_vendas_trimestre_1__dbt_tmp"
    
    
    
  as (
    -- define as variáveis: meses e ano




-- cria a fonte com os dados de Date e converte nome das colunas
with source_date as (
    SELECT dateid as id_date,
        month as mes,
        year as ano
    FROM date
),

-- cria uma fonte de dados unindo a tebela sales com date
sales_date as (
    SELECT source_date.mes,
           sum(quantidade_vendida)
    FROM "dev"."public"."vw_sales" sales INNER JOIN source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
[0m20:08:56.623433 [debug] [Thread-1  ]: SQL status: SELECT in 13.7 seconds
[0m20:08:56.641079 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:56.642038 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
alter table "dev"."public"."tb_vendas_trimestre_1__dbt_tmp" rename to "tb_vendas_trimestre_1"
[0m20:08:56.760023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:08:56.769411 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:08:56.770188 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:56.771623 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:08:56.925449 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:08:56.927704 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:56.928588 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:08:57.049608 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:57.061470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:57.062561 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
drop table if exists "dev"."public"."tb_vendas_trimestre_1__dbt_backup" cascade
[0m20:08:57.182371 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:08:57.185342 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:08:57.185895 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:57.186317 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:08:57.308199 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m20:08:57.309609 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:08:57.310385 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:08:57.431599 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:08:57.434634 [debug] [Thread-1  ]: finished collecting timing info
[0m20:08:57.435596 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: ROLLBACK
[0m20:08:57.553251 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: Close
[0m20:08:57.556849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1bae72-20d7-44e7-8fa6-364c916eed3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dd16820>]}
[0m20:08:57.559095 [info ] [Thread-1  ]: 5 of 5 OK created table model public.tb_vendas_trimestre_1 ..................... [[32mSELECT[0m in 15.86s]
[0m20:08:57.561680 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:08:57.575702 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:08:57.576404 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:57.577011 [debug] [MainThread]: On master: BEGIN
[0m20:08:57.577781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:57.578544 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:08:58.684678 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m20:08:58.686222 [debug] [MainThread]: On master: COMMIT
[0m20:08:58.687329 [debug] [MainThread]: Using redshift connection "master"
[0m20:08:58.688588 [debug] [MainThread]: On master: COMMIT
[0m20:08:58.806558 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:08:58.807034 [debug] [MainThread]: On master: Close
[0m20:08:58.808404 [info ] [MainThread]: 
[0m20:08:58.809027 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 33.03 seconds (33.03s).
[0m20:08:58.809698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:58.810020 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_trimestre_1' was properly closed.
[0m20:08:58.835092 [info ] [MainThread]: 
[0m20:08:58.835762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:58.836593 [info ] [MainThread]: 
[0m20:08:58.837388 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:08:58.838419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de906a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015de90580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015c40b400>]}


============================== 2022-08-15 20:20:23.876846 | fdc6c1da-f8d3-499b-aa8f-81fd5b3be455 ==============================
[0m20:20:23.876883 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:20:23.877714 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:20:23.878227 [debug] [MainThread]: Tracking: tracking
[0m20:20:23.914366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9e44220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9e442e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9e44310>]}
[0m20:20:24.042059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:24.043053 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
[0m20:20:24.093115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc6c1da-f8d3-499b-aa8f-81fd5b3be455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9d63ca0>]}
[0m20:20:24.110897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc6c1da-f8d3-499b-aa8f-81fd5b3be455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9dcae80>]}
[0m20:20:24.111549 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:20:24.112071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc6c1da-f8d3-499b-aa8f-81fd5b3be455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9dcae50>]}
[0m20:20:24.117624 [info ] [MainThread]: 
[0m20:20:24.119278 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:20:24.126739 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:20:24.177447 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:24.177920 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:20:24.178274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:24.178694 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:25.466049 [debug] [ThreadPool]: SQL status: BEGIN in 1.29 seconds
[0m20:20:25.466644 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:25.466954 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:20:25.594874 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:20:25.597997 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:20:25.716170 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:20:25.729954 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:25.730315 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.730539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:25.730800 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:26.860034 [debug] [MainThread]: SQL status: BEGIN in 1.13 seconds
[0m20:20:26.861485 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:26.862453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:27.019588 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:20:27.022725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc6c1da-f8d3-499b-aa8f-81fd5b3be455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9dcabb0>]}
[0m20:20:27.023659 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:27.143869 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:27.145765 [debug] [MainThread]: On master: BEGIN
[0m20:20:27.381843 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:20:27.382288 [debug] [MainThread]: On master: COMMIT
[0m20:20:27.382531 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:27.382787 [debug] [MainThread]: On master: COMMIT
[0m20:20:27.500076 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:20:27.500614 [debug] [MainThread]: On master: Close
[0m20:20:27.501779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:27.502579 [info ] [MainThread]: 
[0m20:20:27.528254 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:27.529256 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:20:27.530599 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:27.531192 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:27.531737 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:27.597493 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:27.599873 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:27.600280 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:27.645664 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:27.681199 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:27.682019 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:20:27.682374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:27.682857 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:28.781340 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:20:28.782081 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:28.782584 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:20:29.044321 [debug] [Thread-1  ]: SQL status: SELECT in 0.26 seconds
[0m20:20:29.186127 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:29.186530 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:20:29.306528 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:20:29.308287 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.78s]
[0m20:20:29.311906 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:29.313932 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:20:29.315499 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:20:29.317372 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:20:29.318041 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:20:29.318589 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:20:29.334280 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:20:29.335729 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:29.336385 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:20:29.351790 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:20:29.353275 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:20:29.353813 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:20:29.354241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:29.354772 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:30.599876 [debug] [Thread-1  ]: SQL status: BEGIN in 1.25 seconds
[0m20:20:30.602895 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:20:30.604754 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:20:30.739574 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:20:30.745917 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:30.747165 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:20:30.868529 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:20:30.872781 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.56s]
[0m20:20:30.875273 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:20:30.875899 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:20:30.876482 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:20:30.878326 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:30.884063 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:20:30.884763 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:20:30.925660 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:30.934262 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:30.935001 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:20:30.941671 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:30.943716 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:30.944780 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:20:30.945742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:30.946719 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:32.069039 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m20:20:32.069598 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:32.070057 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:20:32.382424 [debug] [Thread-1  ]: SQL status: SELECT in 0.31 seconds
[0m20:20:32.388511 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:32.389186 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:20:32.505706 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:20:32.508452 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.63s]
[0m20:20:32.511453 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:20:32.512132 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:20:32.512681 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:20:32.516073 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:20:32.522494 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:20:32.522872 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:20:32.541183 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:20:32.545431 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:32.547083 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:20:32.559590 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:20:32.564945 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:20:32.566549 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:20:32.567952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:32.569690 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:33.738992 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m20:20:33.739633 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:20:33.740140 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:20:33.974332 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
[0m20:20:33.979263 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:33.980005 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:20:34.098703 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:20:34.105021 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.59s]
[0m20:20:34.106843 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:20:34.110698 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:20:34.111370 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:34.111822 [debug] [MainThread]: On master: BEGIN
[0m20:20:34.112274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:34.112826 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:20:35.245413 [debug] [MainThread]: SQL status: BEGIN in 1.13 seconds
[0m20:20:35.246043 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.246526 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:35.246971 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.371833 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:20:35.373484 [debug] [MainThread]: On master: Close
[0m20:20:35.376761 [info ] [MainThread]: 
[0m20:20:35.378392 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.26 seconds (11.26s).
[0m20:20:35.379720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:35.380195 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:20:35.448516 [info ] [MainThread]: 
[0m20:20:35.449745 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:20:35.451509 [info ] [MainThread]: 
[0m20:20:35.452981 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:20:35.453885 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:20:35.454703 [info ] [MainThread]: 
[0m20:20:35.455450 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:20:35.456119 [info ] [MainThread]: 
[0m20:20:35.456924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:20:35.457928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9dcaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9dcae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf94ca430>]}


============================== 2022-08-15 20:29:28.675572 | bb651248-f1c7-4ecc-84c8-57c8c4b71cd7 ==============================
[0m20:29:28.675604 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:29:28.676625 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:29:28.677134 [debug] [MainThread]: Tracking: tracking
[0m20:29:28.709970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da319a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da319a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da319a310>]}
[0m20:29:28.843218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:28.843586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:28.857035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da30a5910>]}
[0m20:29:28.876097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da311dfa0>]}
[0m20:29:28.876804 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:29:28.877363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3109100>]}
[0m20:29:28.881615 [info ] [MainThread]: 
[0m20:29:28.883281 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:29:28.886879 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m20:29:28.960588 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:29:28.961154 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m20:29:28.961525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:28.961908 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:30.490631 [debug] [ThreadPool]: SQL status: SELECT in 1.53 seconds
[0m20:29:30.495928 [debug] [ThreadPool]: On list_dev: Close
[0m20:29:30.501764 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:29:30.522912 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:29:30.523285 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:29:30.523579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:30.524058 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:31.625063 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m20:29:31.626189 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:29:31.626952 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:29:31.755809 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:29:31.764420 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:29:31.884463 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:29:31.898544 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:31.899030 [debug] [MainThread]: On master: BEGIN
[0m20:29:31.899260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:31.899539 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:32.991115 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:29:32.992214 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:32.992939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:33.153632 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:29:33.161205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da311ddc0>]}
[0m20:29:33.162834 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:33.282432 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:33.283665 [debug] [MainThread]: On master: BEGIN
[0m20:29:33.527974 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:29:33.529346 [debug] [MainThread]: On master: COMMIT
[0m20:29:33.530135 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:33.530838 [debug] [MainThread]: On master: COMMIT
[0m20:29:33.652945 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:29:33.654219 [debug] [MainThread]: On master: Close
[0m20:29:33.656948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:33.658541 [info ] [MainThread]: 
[0m20:29:33.696353 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:29:33.697355 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
[0m20:29:33.699064 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:33.699730 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:29:33.700300 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m20:29:33.720022 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:29:33.721490 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:33.722435 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:29:34.092257 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:29:34.093558 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:34.094017 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:29:34.094397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:34.094770 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:35.225188 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m20:29:35.225739 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:35.226142 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:29:35.408624 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m20:29:35.422028 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:35.422431 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:29:35.539388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:35.544386 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:35.544725 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:29:35.663019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:35.747483 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:29:35.747861 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:35.748193 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:29:35.905000 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:29:35.906695 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:35.907447 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:29:36.031724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:36.061041 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:36.062107 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:29:36.181944 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:29:36.186285 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:29:36.187176 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:36.187915 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:29:36.331743 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:29:36.332446 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:29:36.332894 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:29:36.451897 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:36.453071 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:36.453420 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:29:36.570540 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:29:36.571783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da0fd3100>]}
[0m20:29:36.572530 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.87s]
[0m20:29:36.573644 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:29:36.574187 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m20:29:36.574884 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
[0m20:29:36.586717 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:36.587253 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m20:29:36.587589 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m20:29:36.592499 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:29:36.593437 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:36.593991 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m20:29:36.681915 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m20:29:36.683007 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:36.683353 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:29:36.683668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:36.683981 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:37.784043 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:29:37.785118 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:37.785877 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m20:29:37.912303 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m20:29:37.926480 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:37.927063 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m20:29:38.046492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:38.051375 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.051698 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:29:38.176204 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:38.187395 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:29:38.188337 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.189313 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:29:38.334768 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:29:38.336745 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.337458 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:29:38.457205 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:38.469080 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.470004 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:29:38.591380 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:29:38.596078 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:29:38.596920 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.597701 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:29:38.741503 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:29:38.742156 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:29:38.742732 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:29:38.861321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:38.864499 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:38.865879 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:29:38.985978 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m20:29:38.990351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da2825bb0>]}
[0m20:29:38.993011 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.40s]
[0m20:29:38.995682 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m20:29:38.999573 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:29:39.003108 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
[0m20:29:39.005317 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:39.005964 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:29:39.006425 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m20:29:39.014389 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:29:39.015493 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:39.016077 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:29:39.031932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:29:39.033215 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:39.033630 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:29:39.034004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:39.034367 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:40.155675 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m20:29:40.156894 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.157578 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m20:29:40.279892 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m20:29:40.301878 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.302940 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:29:40.423192 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:40.426797 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:29:40.427210 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.427595 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:29:40.573724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:29:40.574434 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.574687 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:29:40.695698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:40.713128 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.713502 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:29:40.833054 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:29:40.835663 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:29:40.836154 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.836496 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:29:40.979337 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:29:40.979769 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:29:40.980048 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:29:41.163559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m20:29:41.166439 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:41.167343 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:29:41.286882 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:29:41.291500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da0f96100>]}
[0m20:29:41.293385 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.29s]
[0m20:29:41.296231 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:29:41.298497 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:29:41.300805 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
[0m20:29:41.306937 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:41.308641 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:29:41.310193 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m20:29:41.319501 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:29:41.320452 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:41.320809 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:29:41.332435 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:29:41.334520 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:41.335014 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:29:41.335565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:41.336239 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:42.622612 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
[0m20:29:42.623778 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:42.624540 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m20:29:42.885439 [debug] [Thread-1  ]: SQL status: SELECT in 0.26 seconds
[0m20:29:42.903599 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:42.903973 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
[0m20:29:43.095952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.19 seconds
[0m20:29:43.111159 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.112164 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m20:29:43.231973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:29:43.238383 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:29:43.238954 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.239316 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:29:43.407177 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m20:29:43.409523 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.410263 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:29:43.529895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:43.541690 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.542624 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m20:29:43.717549 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.17 seconds
[0m20:29:43.722261 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:29:43.723088 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.723766 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:29:43.871816 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:29:43.873090 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:29:43.873785 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:29:44.078154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
[0m20:29:44.081195 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:44.082540 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:29:44.336260 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:29:44.338156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da2834dc0>]}
[0m20:29:44.339487 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 3.03s]
[0m20:29:44.341262 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:29:44.342276 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:29:44.343772 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_trimestre_1 .......................... [RUN]
[0m20:29:44.346027 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:44.351085 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:29:44.353422 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_trimestre_1
[0m20:29:44.374352 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:44.375601 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:44.376167 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:29:44.393086 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:44.395601 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:44.396986 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:29:44.398054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:44.398982 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:46.088161 [debug] [Thread-1  ]: SQL status: BEGIN in 1.69 seconds
[0m20:29:46.089356 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:46.090101 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */


  create  table
    "dev"."public"."tb_vendas_trimestre_1__dbt_tmp"
    
    
    
  as (
    -- define as variáveis: meses e ano




-- cria a fonte com os dados de Date e converte nome das colunas
with source_date as (
    SELECT dateid as id_date,
        month as mes,
        year as ano
    FROM date
),

-- cria uma fonte de dados unindo a tebela sales com date
sales_date as (
    SELECT source_date.mes,
           sum(quantidade_vendida)
    FROM "dev"."public"."vw_sales" sales INNER JOIN source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
[0m20:29:46.563208 [debug] [Thread-1  ]: SQL status: SELECT in 0.47 seconds
[0m20:29:46.579616 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:46.580822 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
alter table "dev"."public"."tb_vendas_trimestre_1" rename to "tb_vendas_trimestre_1__dbt_backup"
[0m20:29:46.772680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.19 seconds
[0m20:29:46.779839 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:46.780187 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
alter table "dev"."public"."tb_vendas_trimestre_1__dbt_tmp" rename to "tb_vendas_trimestre_1"
[0m20:29:46.919067 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m20:29:46.923566 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:29:46.924479 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:46.925215 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:29:47.085584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:29:47.087862 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:47.088588 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:29:47.213914 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:29:47.224634 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:47.225153 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
drop table if exists "dev"."public"."tb_vendas_trimestre_1__dbt_backup" cascade
[0m20:29:47.391347 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.17 seconds
[0m20:29:47.393941 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:29:47.394392 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:47.394782 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:29:47.539783 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:29:47.540901 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:29:47.541729 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:29:47.703226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m20:29:47.704969 [debug] [Thread-1  ]: finished collecting timing info
[0m20:29:47.705520 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: ROLLBACK
[0m20:29:47.826047 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: Close
[0m20:29:47.828757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb651248-f1c7-4ecc-84c8-57c8c4b71cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da0f409d0>]}
[0m20:29:47.829896 [info ] [Thread-1  ]: 5 of 5 OK created table model public.tb_vendas_trimestre_1 ..................... [[32mSELECT[0m in 3.48s]
[0m20:29:47.831189 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:29:47.837451 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:29:47.838447 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:47.839237 [debug] [MainThread]: On master: BEGIN
[0m20:29:47.839929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:47.841143 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:29:49.173625 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
[0m20:29:49.174916 [debug] [MainThread]: On master: COMMIT
[0m20:29:49.175756 [debug] [MainThread]: Using redshift connection "master"
[0m20:29:49.176493 [debug] [MainThread]: On master: COMMIT
[0m20:29:49.367881 [debug] [MainThread]: SQL status: COMMIT in 0.19 seconds
[0m20:29:49.369362 [debug] [MainThread]: On master: Close
[0m20:29:49.373217 [info ] [MainThread]: 
[0m20:29:49.374731 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 20.49 seconds (20.49s).
[0m20:29:49.376783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:49.377851 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_trimestre_1' was properly closed.
[0m20:29:49.424755 [info ] [MainThread]: 
[0m20:29:49.425697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:49.426871 [info ] [MainThread]: 
[0m20:29:49.427649 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:29:49.428690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da311dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3109190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3109040>]}


============================== 2022-08-15 20:30:27.050551 | 5e7456e9-30e2-4cb6-bcb2-588d647b7ac4 ==============================
[0m20:30:27.050585 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:30:27.051467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:30:27.052309 [debug] [MainThread]: Tracking: tracking
[0m20:30:27.086056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f012916e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f012916e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f012916e250>]}
[0m20:30:27.256691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:27.257104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:27.270804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e7456e9-30e2-4cb6-bcb2-588d647b7ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0129079850>]}
[0m20:30:27.293240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e7456e9-30e2-4cb6-bcb2-588d647b7ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01290edee0>]}
[0m20:30:27.293993 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:30:27.294594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e7456e9-30e2-4cb6-bcb2-588d647b7ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01290edfd0>]}
[0m20:30:27.300140 [info ] [MainThread]: 
[0m20:30:27.302017 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:30:27.310536 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:30:27.364966 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:30:27.365850 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:30:27.367055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:27.367661 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:28.502147 [debug] [ThreadPool]: SQL status: BEGIN in 1.14 seconds
[0m20:30:28.502589 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:30:28.502904 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:30:28.630939 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:30:28.637751 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:30:28.752081 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:30:28.768314 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:28.768749 [debug] [MainThread]: On master: BEGIN
[0m20:30:28.768981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:28.769248 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:29.934661 [debug] [MainThread]: SQL status: BEGIN in 1.17 seconds
[0m20:30:29.935095 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:29.935383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:30.091134 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:30:30.094672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e7456e9-30e2-4cb6-bcb2-588d647b7ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01290edd30>]}
[0m20:30:30.095487 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:30.212361 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:30.213356 [debug] [MainThread]: On master: BEGIN
[0m20:30:30.449072 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m20:30:30.450042 [debug] [MainThread]: On master: COMMIT
[0m20:30:30.450733 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:30.451318 [debug] [MainThread]: On master: COMMIT
[0m20:30:30.590662 [debug] [MainThread]: SQL status: COMMIT in 0.14 seconds
[0m20:30:30.591434 [debug] [MainThread]: On master: Close
[0m20:30:30.594113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:30.595177 [info ] [MainThread]: 
[0m20:30:30.613418 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:30.615153 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:30:30.617804 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:30.618405 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:30.619068 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:30.720473 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:30.730813 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:30.731486 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:30.884856 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:30.896307 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:30.896835 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:30:30.897188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:30.897581 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:32.020483 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m20:30:32.020934 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:32.021175 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:30:32.162525 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
[0m20:30:32.166398 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:32.166764 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:30:32.286495 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:30:32.288063 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.67s]
[0m20:30:32.289406 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:32.290095 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:32.290686 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:30:32.292503 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:32.293100 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:32.293630 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:32.308774 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:32.310048 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:32.310720 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:32.325604 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:32.326871 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:32.327520 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:30:32.328245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:32.329022 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:33.426158 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:30:33.426710 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:33.427129 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:30:33.556080 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:30:33.560598 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:33.561522 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:30:33.689752 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:30:33.691459 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.40s]
[0m20:30:33.693087 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:33.694008 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:30:33.695113 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:30:33.700388 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:33.701505 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:30:33.702117 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:30:33.798598 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:33.799886 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:33.800460 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:30:33.813291 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:33.816668 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:33.829463 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:30:33.830776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:33.831911 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:34.941473 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:30:34.942215 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:34.942592 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:30:35.090251 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m20:30:35.094341 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:35.095052 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:30:35.217553 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:30:35.220838 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.52s]
[0m20:30:35.222288 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:30:35.223199 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:35.224403 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:30:35.226381 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:35.227225 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:35.228040 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:35.258837 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:35.259978 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:35.260478 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:35.268156 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:35.269487 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:35.269863 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:30:35.270157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:35.270456 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:36.363012 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:30:36.364223 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:36.365270 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:30:36.526291 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m20:30:36.531271 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:36.531994 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:30:36.656384 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:30:36.657638 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.43s]
[0m20:30:36.658742 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:36.661993 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:30:36.662636 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:36.663061 [debug] [MainThread]: On master: BEGIN
[0m20:30:36.663505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:36.663903 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:37.794279 [debug] [MainThread]: SQL status: BEGIN in 1.13 seconds
[0m20:30:37.795613 [debug] [MainThread]: On master: COMMIT
[0m20:30:37.796597 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:37.797359 [debug] [MainThread]: On master: COMMIT
[0m20:30:37.915767 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:30:37.916449 [debug] [MainThread]: On master: Close
[0m20:30:37.918461 [info ] [MainThread]: 
[0m20:30:37.920156 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m20:30:37.921533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:37.922230 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:30:37.954297 [info ] [MainThread]: 
[0m20:30:37.957101 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:30:37.957961 [info ] [MainThread]: 
[0m20:30:37.958628 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:30:37.959483 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:30:37.960197 [info ] [MainThread]: 
[0m20:30:37.960894 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:30:37.961684 [info ] [MainThread]: 
[0m20:30:37.962479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:30:37.968035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01290d90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01290d9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01287ddd90>]}


============================== 2022-08-15 20:30:50.427922 | e5fd5656-9644-487c-81da-7ec187d73ef3 ==============================
[0m20:30:50.427962 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:30:50.429058 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:30:50.430033 [debug] [MainThread]: Tracking: tracking
[0m20:30:50.475416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e166fb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e166fb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e166fb2b0>]}
[0m20:30:50.676336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:50.676701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:50.692896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e166058b0>]}
[0m20:30:50.714730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e1667df40>]}
[0m20:30:50.715764 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:30:50.717126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e16669100>]}
[0m20:30:50.723823 [info ] [MainThread]: 
[0m20:30:50.726747 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:30:50.731491 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m20:30:50.794831 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:30:50.795429 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m20:30:50.795830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:50.796360 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:52.259923 [debug] [ThreadPool]: SQL status: SELECT in 1.46 seconds
[0m20:30:52.262427 [debug] [ThreadPool]: On list_dev: Close
[0m20:30:52.266679 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:30:52.293255 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:30:52.293640 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:30:52.293965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:52.294323 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:53.393036 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m20:30:53.394167 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:30:53.395084 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:30:53.531625 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m20:30:53.536164 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:30:53.658399 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:30:53.671083 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:53.671516 [debug] [MainThread]: On master: BEGIN
[0m20:30:53.671760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:53.672061 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:54.760548 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:30:54.761657 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:54.762353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:54.922801 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:30:54.927161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e1667dbe0>]}
[0m20:30:54.927813 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:55.045906 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:55.046329 [debug] [MainThread]: On master: BEGIN
[0m20:30:55.281757 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:30:55.282807 [debug] [MainThread]: On master: COMMIT
[0m20:30:55.283501 [debug] [MainThread]: Using redshift connection "master"
[0m20:30:55.284177 [debug] [MainThread]: On master: COMMIT
[0m20:30:55.400916 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:30:55.401391 [debug] [MainThread]: On master: Close
[0m20:30:55.402822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:55.403469 [info ] [MainThread]: 
[0m20:30:55.413238 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:30:55.414228 [info ] [Thread-1  ]: 1 of 5 START table model public.my_first_dbt_model ............................. [RUN]
[0m20:30:55.415550 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:55.416236 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:30:55.417015 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m20:30:55.432603 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:30:55.433885 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:55.434637 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:30:55.688302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:30:55.690283 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:55.691161 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:30:55.691691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:55.692469 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:56.882860 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m20:30:56.884572 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:56.886064 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */


  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:30:57.081440 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m20:30:57.096557 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.097116 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:30:57.214290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:30:57.220321 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.220667 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:30:57.340102 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:30:57.401158 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:30:57.401649 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.402150 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:30:57.562947 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m20:30:57.564424 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.565101 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:30:57.684019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:30:57.694391 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.694807 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:30:57.812192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:30:57.817390 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:30:57.818358 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.819519 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:30:57.965495 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:30:57.966206 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:30:57.966668 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:30:58.084178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:30:58.087074 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:58.087869 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:30:58.206507 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:30:58.207933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e14550790>]}
[0m20:30:58.208764 [info ] [Thread-1  ]: 1 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT[0m in 2.79s]
[0m20:30:58.209706 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:30:58.210196 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m20:30:58.211171 [info ] [Thread-1  ]: 2 of 5 START view model public.vw_sales ........................................ [RUN]
[0m20:30:58.212799 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m20:30:58.213378 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m20:30:58.213921 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m20:30:58.219517 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:30:58.220773 [debug] [Thread-1  ]: finished collecting timing info
[0m20:30:58.221195 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m20:30:58.321729 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.vw_sales"
[0m20:30:58.323991 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:30:58.324533 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:30:58.324841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:58.325094 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:30:59.604504 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m20:30:59.605773 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:30:59.606664 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
	select *
	from sales
	
),

RENAMED AS (
	SELECT
	SALESID AS ID_VENDAS,
		LISTID AS ID_LISTA,
		SELLERID AS ID_VENDEDOR,
		BUYERID AS ID_COMPRADOR,
		EVENTID AS ID_EVENTO,
		DATEID AS ID_DATE,
		QTYSOLD AS QUANTIDADE_VENDIDA,
		PRICEPAID AS VALOR_PAGO,
		COMMISSION AS COMISSAO,
		TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA
		
	FROM SOURCE_SALES
	
)

SELECT * FROM RENAMED
  ) ;

[0m20:30:59.800131 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.19 seconds
[0m20:30:59.819783 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:30:59.820747 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m20:30:59.990376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
[0m20:31:00.000014 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.000580 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:31:00.120424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:00.127386 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:31:00.128352 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.129454 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:31:00.299228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m20:31:00.299983 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.300283 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:31:00.420702 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:00.426513 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.427036 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:31:00.715689 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.29 seconds
[0m20:31:00.719783 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:31:00.720501 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.721146 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:31:00.891275 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m20:31:00.892059 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:31:00.892450 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:31:01.013576 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:01.015006 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:01.015605 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:31:01.190162 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m20:31:01.191812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e15d8a3d0>]}
[0m20:31:01.192793 [info ] [Thread-1  ]: 2 of 5 OK created view model public.vw_sales ................................... [[32mCREATE VIEW[0m in 2.98s]
[0m20:31:01.193917 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m20:31:01.194605 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:31:01.195545 [info ] [Thread-1  ]: 3 of 5 START view model public.my_second_dbt_model ............................. [RUN]
[0m20:31:01.198297 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:01.199002 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:31:01.199602 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m20:31:01.211382 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:31:01.217334 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:01.218016 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:31:01.237896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:31:01.239213 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:01.239817 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:31:01.240155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:31:01.240700 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:31:02.619505 [debug] [Thread-1  ]: SQL status: BEGIN in 1.38 seconds
[0m20:31:02.620057 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:02.620451 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m20:31:02.816334 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m20:31:02.825936 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:02.826417 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:31:02.945464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:02.948495 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:31:02.948874 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:02.949199 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:31:03.093851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:31:03.094975 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:03.095612 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:31:03.216483 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:03.220528 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:03.220860 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:31:03.338847 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m20:31:03.340627 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:31:03.340942 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:03.341271 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:31:03.495388 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:31:03.495979 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:31:03.496404 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:31:03.613498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:03.614745 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:03.615133 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:31:03.733192 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:31:03.734782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e144672e0>]}
[0m20:31:03.735783 [info ] [Thread-1  ]: 3 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 2.54s]
[0m20:31:03.736865 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:31:03.737536 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:31:03.738424 [info ] [Thread-1  ]: 4 of 5 START table model public.tb_10_compradores .............................. [RUN]
[0m20:31:03.739733 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:03.740333 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:31:03.741393 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m20:31:03.752030 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:31:03.753134 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:03.753669 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:31:03.769968 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:31:03.771125 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:03.771463 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:31:03.771820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:31:03.772196 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:31:04.911741 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m20:31:04.912309 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:04.912691 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    SELECT * FROM "dev"."public"."vw_sales"
),
compradores as (
    select 
        (firstname ||' '|| lastname) as Nome_Completo, userid
    from users
    ),
    top_10_compradores as (
        SELECT
            compradores.Nome_Completo as Nome_Completo,
            sum(sales.quantidade_vendida) as Vendas_Totais,
            sales.comissao as Comissao
        FROM
            sales INNER JOIN compradores
            on sales.id_comprador = compradores.userid
            GROUP BY compradores.userid, compradores.Nome_Completo, sales.comissao
            ORDER BY vendas_totais DESC
            LIMIT 10
    )

    select * from top_10_compradores
  );
[0m20:31:05.152504 [debug] [Thread-1  ]: SQL status: SELECT in 0.24 seconds
[0m20:31:05.158190 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.158560 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores" rename to "tb_10_compradores__dbt_backup"
[0m20:31:05.275589 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:05.282602 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.283118 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m20:31:05.400363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:05.404665 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:31:05.405059 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.405328 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:31:05.560216 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:31:05.561293 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.561770 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:31:05.678022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:05.684413 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.684938 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m20:31:05.804679 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m20:31:05.806340 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:31:05.806627 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.806917 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:31:05.951231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:31:05.951798 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:31:05.952233 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:31:06.069630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:06.070735 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:06.071087 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:31:06.186829 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:31:06.188844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e15d9ad60>]}
[0m20:31:06.189885 [info ] [Thread-1  ]: 4 of 5 OK created table model public.tb_10_compradores ......................... [[32mSELECT[0m in 2.45s]
[0m20:31:06.190945 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:31:06.191503 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:31:06.192648 [info ] [Thread-1  ]: 5 of 5 START table model public.tb_vendas_trimestre_1 .......................... [RUN]
[0m20:31:06.193908 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:06.194764 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:31:06.195246 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_trimestre_1
[0m20:31:06.210174 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:06.211203 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:06.211686 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:31:06.226163 [debug] [Thread-1  ]: Writing runtime SQL for node "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:06.227722 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:06.228191 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:31:06.228550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:31:06.228967 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:31:07.355944 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m20:31:07.356454 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:07.356838 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */


  create  table
    "dev"."public"."tb_vendas_trimestre_1__dbt_tmp"
    
    
    
  as (
    -- define as variáveis: meses e ano




-- cria a fonte com os dados de Date e converte nome das colunas
with source_date as (
    SELECT dateid as id_date,
        month as mes,
        year as ano
    FROM date
),

-- cria uma fonte de dados unindo a tebela sales com date
sales_date as (
    SELECT source_date.mes,
           sum(quantidade_vendida)
    FROM "dev"."public"."vw_sales" sales INNER JOIN source_date
    on sales.id_date = source_date.id_date
    where source_date.mes in ('JAN', 'FEB', 'MAR')
    and source_date.ano = '2008'
    group by source_date.mes
)
select * from sales_date
  );
[0m20:31:07.542185 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m20:31:07.547838 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:07.548244 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
alter table "dev"."public"."tb_vendas_trimestre_1" rename to "tb_vendas_trimestre_1__dbt_backup"
[0m20:31:07.664714 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:07.672085 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:07.672570 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
alter table "dev"."public"."tb_vendas_trimestre_1__dbt_tmp" rename to "tb_vendas_trimestre_1"
[0m20:31:07.790697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m20:31:07.794463 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:31:07.794803 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:07.795128 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:31:07.950245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m20:31:07.951057 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:07.951339 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:31:08.072893 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:08.078268 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:08.078842 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_trimestre_1"} */
drop table if exists "dev"."public"."tb_vendas_trimestre_1__dbt_backup" cascade
[0m20:31:08.209402 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m20:31:08.211125 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:31:08.211437 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:08.211736 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: COMMIT
[0m20:31:08.356477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m20:31:08.356957 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_trimestre_1"
[0m20:31:08.357287 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: BEGIN
[0m20:31:08.474847 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m20:31:08.475993 [debug] [Thread-1  ]: finished collecting timing info
[0m20:31:08.476381 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: ROLLBACK
[0m20:31:08.601616 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_trimestre_1: Close
[0m20:31:08.603358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fd5656-9644-487c-81da-7ec187d73ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e144a7550>]}
[0m20:31:08.604169 [info ] [Thread-1  ]: 5 of 5 OK created table model public.tb_vendas_trimestre_1 ..................... [[32mSELECT[0m in 2.41s]
[0m20:31:08.605148 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_trimestre_1
[0m20:31:08.609180 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:31:08.609827 [debug] [MainThread]: Using redshift connection "master"
[0m20:31:08.610320 [debug] [MainThread]: On master: BEGIN
[0m20:31:08.610767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:08.611266 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:31:09.697451 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:31:09.697913 [debug] [MainThread]: On master: COMMIT
[0m20:31:09.698238 [debug] [MainThread]: Using redshift connection "master"
[0m20:31:09.698554 [debug] [MainThread]: On master: COMMIT
[0m20:31:09.814560 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:31:09.815084 [debug] [MainThread]: On master: Close
[0m20:31:09.816433 [info ] [MainThread]: 
[0m20:31:09.817246 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 19.09 seconds (19.09s).
[0m20:31:09.818075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:09.818465 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_trimestre_1' was properly closed.
[0m20:31:09.842124 [info ] [MainThread]: 
[0m20:31:09.842911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:09.843891 [info ] [MainThread]: 
[0m20:31:09.844625 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:31:09.845650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e166690a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e16669070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e15d75df0>]}


============================== 2022-08-15 20:34:55.558086 | 5da2b0a1-367c-4d86-8a86-c90b51534b2e ==============================
[0m20:34:55.558120 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:34:55.558988 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:34:55.559336 [debug] [MainThread]: Tracking: tracking
[0m20:34:55.594130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c432220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c4322e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c432310>]}
[0m20:34:55.744224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:34:55.744912 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/test_singular_nao_negativo.sql
[0m20:34:55.825805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5da2b0a1-367c-4d86-8a86-c90b51534b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c312fd0>]}
[0m20:34:55.841985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5da2b0a1-367c-4d86-8a86-c90b51534b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c3b4ee0>]}
[0m20:34:55.842758 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:34:55.843269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da2b0a1-367c-4d86-8a86-c90b51534b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c3b4f10>]}
[0m20:34:55.848993 [info ] [MainThread]: 
[0m20:34:55.850268 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:34:55.854251 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:34:55.902985 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:34:55.903603 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:34:55.904135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:55.904749 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:34:57.155271 [debug] [ThreadPool]: SQL status: BEGIN in 1.25 seconds
[0m20:34:57.155950 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:34:57.156494 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:34:57.287994 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:34:57.293445 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:34:57.412765 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:34:57.423573 [debug] [MainThread]: Using redshift connection "master"
[0m20:34:57.423918 [debug] [MainThread]: On master: BEGIN
[0m20:34:57.424190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:57.425222 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:34:58.525325 [debug] [MainThread]: SQL status: BEGIN in 1.1 seconds
[0m20:34:58.526633 [debug] [MainThread]: Using redshift connection "master"
[0m20:34:58.527666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:58.686447 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:34:58.694736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da2b0a1-367c-4d86-8a86-c90b51534b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c3b4c40>]}
[0m20:34:58.697020 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:58.817257 [debug] [MainThread]: Using redshift connection "master"
[0m20:34:58.819015 [debug] [MainThread]: On master: BEGIN
[0m20:34:59.057682 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:34:59.058377 [debug] [MainThread]: On master: COMMIT
[0m20:34:59.058904 [debug] [MainThread]: Using redshift connection "master"
[0m20:34:59.059342 [debug] [MainThread]: On master: COMMIT
[0m20:34:59.178518 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:34:59.179878 [debug] [MainThread]: On master: Close
[0m20:34:59.183848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:59.186495 [info ] [MainThread]: 
[0m20:34:59.216852 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:34:59.218067 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:34:59.220636 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:34:59.221595 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:34:59.222661 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:34:59.310638 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:34:59.311692 [debug] [Thread-1  ]: finished collecting timing info
[0m20:34:59.312117 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:34:59.401550 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:34:59.405205 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:34:59.411126 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:34:59.411674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:34:59.412111 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:00.523366 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:35:00.524018 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:35:00.524523 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:35:00.702985 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m20:35:00.708564 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:00.709163 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:35:00.874915 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:35:00.876563 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.66s]
[0m20:35:00.878149 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:35:00.878841 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:35:00.879689 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:35:00.880893 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:35:00.881480 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:35:00.882002 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:35:00.896948 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:35:00.898368 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:00.899199 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:35:00.908942 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:35:00.910189 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:35:00.910674 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:35:00.911026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:00.911413 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:02.098937 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m20:35:02.099641 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:35:02.100125 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:35:02.225482 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:35:02.230127 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:02.230719 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:35:02.349642 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:35:02.351262 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.47s]
[0m20:35:02.352382 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:35:02.352959 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:35:02.353729 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m20:35:02.355092 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:35:02.355620 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:35:02.356120 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:35:02.362115 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:35:02.432187 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:02.432766 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:35:02.440647 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:35:02.448956 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:35:02.450669 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:35:02.451912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:02.453185 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:03.603881 [debug] [Thread-1  ]: SQL status: BEGIN in 1.15 seconds
[0m20:35:03.604342 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:35:03.604695 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totias < 0
      
    ) dbt_internal_test
[0m20:35:03.735550 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "vendas_totias" does not exist in tb_10_compradores

[0m20:35:03.736021 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:35:03.857722 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:03.858195 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:35:03.859359 [debug] [Thread-1  ]: Database Error in test test_singular_nao_negativo (tests/test_singular_nao_negativo.sql)
  column "vendas_totias" does not exist in tb_10_compradores
  compiled SQL at target/run/analytics_dbt/tests/test_singular_nao_negativo.sql
[0m20:35:03.860077 [error] [Thread-1  ]: 3 of 5 ERROR test_singular_nao_negativo ........................................ [[31mERROR[0m in 1.51s]
[0m20:35:03.860958 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:35:03.861537 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:35:03.862043 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:35:03.863869 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:35:03.864433 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:35:03.864938 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:35:03.898178 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:35:03.899398 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:03.899951 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:35:03.912719 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:35:03.916132 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:35:03.917271 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:35:03.917781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:03.918238 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:05.011553 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:35:05.012098 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:35:05.012492 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:35:05.161595 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m20:35:05.164514 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:05.164914 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:35:05.282396 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:35:05.283784 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.42s]
[0m20:35:05.284858 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:35:05.285458 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:35:05.286318 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:35:05.287764 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:35:05.288356 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:35:05.288949 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:35:05.307738 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:35:05.309075 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:05.309487 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:35:05.319943 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:35:05.321116 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:35:05.321536 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:35:05.321862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:05.322242 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:06.436068 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:35:06.436595 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:35:06.437115 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:35:06.587603 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m20:35:06.590250 [debug] [Thread-1  ]: finished collecting timing info
[0m20:35:06.590605 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:35:06.706183 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:35:06.707722 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.42s]
[0m20:35:06.709057 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:35:06.712755 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:35:06.713410 [debug] [MainThread]: Using redshift connection "master"
[0m20:35:06.713881 [debug] [MainThread]: On master: BEGIN
[0m20:35:06.714273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:06.714712 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:07.939950 [debug] [MainThread]: SQL status: BEGIN in 1.23 seconds
[0m20:35:07.940507 [debug] [MainThread]: On master: COMMIT
[0m20:35:07.941020 [debug] [MainThread]: Using redshift connection "master"
[0m20:35:07.941389 [debug] [MainThread]: On master: COMMIT
[0m20:35:08.076412 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m20:35:08.077001 [debug] [MainThread]: On master: Close
[0m20:35:08.078608 [info ] [MainThread]: 
[0m20:35:08.079511 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 12.23 seconds (12.23s).
[0m20:35:08.080181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:08.080524 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:35:08.106152 [info ] [MainThread]: 
[0m20:35:08.107213 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:35:08.108199 [info ] [MainThread]: 
[0m20:35:08.109045 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:35:08.109946 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:35:08.113440 [info ] [MainThread]: 
[0m20:35:08.116168 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:35:08.118220 [info ] [MainThread]: 
[0m20:35:08.119150 [error] [MainThread]: [33mDatabase Error in test test_singular_nao_negativo (tests/test_singular_nao_negativo.sql)[0m
[0m20:35:08.119977 [error] [MainThread]:   column "vendas_totias" does not exist in tb_10_compradores
[0m20:35:08.120683 [error] [MainThread]:   compiled SQL at target/run/analytics_dbt/tests/test_singular_nao_negativo.sql
[0m20:35:08.121531 [info ] [MainThread]: 
[0m20:35:08.122240 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:35:08.123188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c3b4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c3b4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8c2bf580>]}


============================== 2022-08-15 20:35:56.097656 | fc39f132-fa5b-4f68-b562-1fee346d9cbc ==============================
[0m20:35:56.097690 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:35:56.098494 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:35:56.098910 [debug] [MainThread]: Tracking: tracking
[0m20:35:56.128556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe23250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe23310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe23340>]}
[0m20:35:56.264782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:56.265650 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
[0m20:35:56.341833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc39f132-fa5b-4f68-b562-1fee346d9cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fcd1430>]}
[0m20:35:56.357380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc39f132-fa5b-4f68-b562-1fee346d9cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fd15670>]}
[0m20:35:56.358164 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:35:56.358696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc39f132-fa5b-4f68-b562-1fee346d9cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe23400>]}
[0m20:35:56.365875 [info ] [MainThread]: 
[0m20:35:56.368366 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:35:56.371656 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:35:56.421221 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:35:56.421792 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:35:56.422197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:56.422633 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:57.916287 [debug] [ThreadPool]: SQL status: BEGIN in 1.49 seconds
[0m20:35:57.917017 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:35:57.917325 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:35:58.122175 [debug] [ThreadPool]: SQL status: SELECT in 0.2 seconds
[0m20:35:58.125311 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:35:58.307341 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:35:58.332256 [debug] [MainThread]: Using redshift connection "master"
[0m20:35:58.332842 [debug] [MainThread]: On master: BEGIN
[0m20:35:58.333210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:58.333639 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:35:59.666316 [debug] [MainThread]: SQL status: BEGIN in 1.33 seconds
[0m20:35:59.667446 [debug] [MainThread]: Using redshift connection "master"
[0m20:35:59.668204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:59.859173 [debug] [MainThread]: SQL status: SELECT in 0.19 seconds
[0m20:35:59.865105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc39f132-fa5b-4f68-b562-1fee346d9cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fd91640>]}
[0m20:35:59.866315 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:59.987661 [debug] [MainThread]: Using redshift connection "master"
[0m20:35:59.988951 [debug] [MainThread]: On master: BEGIN
[0m20:36:00.226892 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:36:00.228102 [debug] [MainThread]: On master: COMMIT
[0m20:36:00.228958 [debug] [MainThread]: Using redshift connection "master"
[0m20:36:00.229708 [debug] [MainThread]: On master: COMMIT
[0m20:36:00.348893 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:36:00.349497 [debug] [MainThread]: On master: Close
[0m20:36:00.350996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:00.351661 [info ] [MainThread]: 
[0m20:36:00.361808 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:36:00.362507 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:36:00.364053 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:36:00.364657 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:36:00.365277 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:36:00.451233 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:36:00.461574 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:00.462146 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:36:00.584555 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:36:00.585841 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:36:00.586371 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:36:00.586819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:00.587306 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:01.803497 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
[0m20:36:01.803935 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:36:01.804214 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:36:01.934197 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:36:01.939771 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:01.940261 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:36:02.056653 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:36:02.058568 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.70s]
[0m20:36:02.059866 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:36:02.060469 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:36:02.061201 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:36:02.062436 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:36:02.062997 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:36:02.063523 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:36:02.083440 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:36:02.084539 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:02.085058 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:36:02.100892 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:36:02.102373 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:36:02.103087 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:36:02.103541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:02.103969 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:03.289317 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m20:36:03.289866 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:36:03.290219 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:36:03.415136 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:36:03.422582 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:03.423069 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:36:03.539303 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:36:03.540713 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.48s]
[0m20:36:03.541784 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:36:03.542413 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:36:03.543355 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m20:36:03.544595 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:36:03.545282 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:36:03.545799 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:36:03.552782 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:36:03.557266 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:03.557893 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:36:03.565418 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:36:03.566556 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:36:03.568014 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:36:03.576142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:03.576722 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:04.651521 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m20:36:04.651990 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:36:04.652301 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:36:04.876449 [debug] [Thread-1  ]: SQL status: SELECT in 0.22 seconds
[0m20:36:04.879187 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:04.879585 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:36:04.996711 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:36:04.997939 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.45s]
[0m20:36:04.999389 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:36:05.000086 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:36:05.000995 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:36:05.002550 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:36:05.003121 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:36:05.003556 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:36:05.033049 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:36:05.036172 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:05.036834 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:36:05.048038 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:36:05.053856 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:36:05.054442 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:36:05.054956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:05.055455 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:06.200770 [debug] [Thread-1  ]: SQL status: BEGIN in 1.15 seconds
[0m20:36:06.201214 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:36:06.201529 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:36:06.321587 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:36:06.324413 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:06.324842 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:36:06.444639 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:36:06.446202 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.44s]
[0m20:36:06.447343 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:36:06.448066 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:36:06.448844 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:36:06.450207 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:36:06.450726 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:36:06.451371 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:36:06.467836 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:36:06.469020 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:06.469527 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:36:06.476443 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:36:06.477889 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:36:06.478376 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:36:06.478759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:06.481230 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:07.642553 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m20:36:07.643010 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:36:07.643295 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:36:07.763062 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:36:07.765776 [debug] [Thread-1  ]: finished collecting timing info
[0m20:36:07.766124 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:36:07.883583 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:36:07.885920 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.44s]
[0m20:36:07.887170 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:36:07.890359 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:36:07.892692 [debug] [MainThread]: Using redshift connection "master"
[0m20:36:07.894308 [debug] [MainThread]: On master: BEGIN
[0m20:36:07.897002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:07.900388 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:36:08.991611 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:36:08.992181 [debug] [MainThread]: On master: COMMIT
[0m20:36:08.992644 [debug] [MainThread]: Using redshift connection "master"
[0m20:36:08.992980 [debug] [MainThread]: On master: COMMIT
[0m20:36:09.111027 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:36:09.111520 [debug] [MainThread]: On master: Close
[0m20:36:09.112742 [info ] [MainThread]: 
[0m20:36:09.113323 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 12.74 seconds (12.74s).
[0m20:36:09.114009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:09.114407 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:36:09.142492 [info ] [MainThread]: 
[0m20:36:09.143328 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:36:09.144136 [info ] [MainThread]: 
[0m20:36:09.144879 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:36:09.151026 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:36:09.153736 [info ] [MainThread]: 
[0m20:36:09.154732 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:36:09.155474 [info ] [MainThread]: 
[0m20:36:09.156211 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:36:09.157273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe12c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fe234c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f447fca2670>]}


============================== 2022-08-15 20:37:09.912748 | de18cce5-5304-448e-bae3-9be44e299cf9 ==============================
[0m20:37:09.912784 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:37:09.913644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:37:09.914118 [debug] [MainThread]: Tracking: tracking
[0m20:37:09.965161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f188190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f188250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f188280>]}
[0m20:37:10.131356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:10.132577 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
[0m20:37:10.267758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de18cce5-5304-448e-bae3-9be44e299cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f039160>]}
[0m20:37:10.297120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de18cce5-5304-448e-bae3-9be44e299cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f10dfd0>]}
[0m20:37:10.298030 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:37:10.298925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de18cce5-5304-448e-bae3-9be44e299cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f064f40>]}
[0m20:37:10.305021 [info ] [MainThread]: 
[0m20:37:10.306743 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:37:10.314712 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:37:10.374068 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:37:10.375817 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:37:10.381490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:10.383636 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:12.254036 [debug] [ThreadPool]: SQL status: BEGIN in 1.87 seconds
[0m20:37:12.254504 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:37:12.254809 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:37:12.382520 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:37:12.385911 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:37:12.574795 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:37:12.590334 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:12.590752 [debug] [MainThread]: On master: BEGIN
[0m20:37:12.591129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:12.591503 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:13.831646 [debug] [MainThread]: SQL status: BEGIN in 1.24 seconds
[0m20:37:13.832244 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:13.832570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:37:14.038525 [debug] [MainThread]: SQL status: SELECT in 0.21 seconds
[0m20:37:14.041167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de18cce5-5304-448e-bae3-9be44e299cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f10dd60>]}
[0m20:37:14.041828 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:14.163431 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:14.164520 [debug] [MainThread]: On master: BEGIN
[0m20:37:14.468312 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
[0m20:37:14.468937 [debug] [MainThread]: On master: COMMIT
[0m20:37:14.469315 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:14.469607 [debug] [MainThread]: On master: COMMIT
[0m20:37:14.588942 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:37:14.589405 [debug] [MainThread]: On master: Close
[0m20:37:14.590368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:14.590944 [info ] [MainThread]: 
[0m20:37:14.607284 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:37:14.607943 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:37:14.609547 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:37:14.610111 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:37:14.610698 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:37:14.691868 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:37:14.692776 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:14.693109 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:37:14.741183 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:37:14.742128 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:37:14.742448 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:37:14.742715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:14.742994 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:16.001585 [debug] [Thread-1  ]: SQL status: BEGIN in 1.26 seconds
[0m20:37:16.003227 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:37:16.004133 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:37:16.230488 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
[0m20:37:16.236240 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:16.236614 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:37:16.353690 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:37:16.354840 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.75s]
[0m20:37:16.355843 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:37:16.356387 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:37:16.357092 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:37:16.358270 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:37:16.358836 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:37:16.359372 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:37:16.373710 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:37:16.375249 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:16.375914 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:37:16.386118 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:37:16.390574 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:37:16.390933 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:37:16.391206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:16.391523 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:17.802118 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m20:37:17.804115 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:37:17.805340 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:37:18.008376 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m20:37:18.011654 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:18.012008 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:37:18.139787 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:37:18.141180 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.78s]
[0m20:37:18.142136 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:37:18.143009 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:37:18.143974 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m20:37:18.145494 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:37:18.146114 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:37:18.146690 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:37:18.153023 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:37:18.158158 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:18.160009 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:37:18.172091 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:37:18.182444 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:37:18.183459 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:37:18.184240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:18.184917 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:19.473462 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
[0m20:37:19.475595 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:37:19.476426 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select count(*)
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:37:19.606347 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:37:19.609315 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:19.609740 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:37:19.780470 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:37:19.781614 [error] [Thread-1  ]: 3 of 5 FAIL 1 test_singular_nao_negativo ....................................... [[31mFAIL 1[0m in 1.64s]
[0m20:37:19.782537 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:37:19.783187 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:37:19.784128 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:37:19.786092 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:37:19.787740 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:37:19.795349 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:37:19.826314 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:37:19.827206 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:19.827497 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:37:19.832270 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:37:19.833203 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:37:19.833546 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:37:19.836922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:19.838375 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:20.943749 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:37:20.944697 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:37:20.945335 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:37:21.068856 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:37:21.077551 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:21.078531 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:37:21.196903 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:37:21.198135 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.41s]
[0m20:37:21.199125 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:37:21.200829 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:37:21.201682 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:37:21.203085 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:37:21.203732 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:37:21.204290 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:37:21.229322 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:37:21.230293 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:21.230675 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:37:21.244713 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:37:21.245756 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:37:21.246073 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:37:21.246337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:21.246653 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:22.391212 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m20:37:22.394292 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:37:22.396634 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:37:22.558950 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m20:37:22.561562 [debug] [Thread-1  ]: finished collecting timing info
[0m20:37:22.561912 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:37:22.685128 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:37:22.688331 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.49s]
[0m20:37:22.691697 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:37:22.702625 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:37:22.704099 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:22.705118 [debug] [MainThread]: On master: BEGIN
[0m20:37:22.714325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:22.714959 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:37:23.865208 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m20:37:23.866113 [debug] [MainThread]: On master: COMMIT
[0m20:37:23.866669 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:23.867213 [debug] [MainThread]: On master: COMMIT
[0m20:37:23.983520 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:37:23.984013 [debug] [MainThread]: On master: Close
[0m20:37:23.985062 [info ] [MainThread]: 
[0m20:37:23.985610 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 13.68 seconds (13.68s).
[0m20:37:23.986228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:23.986578 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:37:24.022834 [info ] [MainThread]: 
[0m20:37:24.024167 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:37:24.026434 [info ] [MainThread]: 
[0m20:37:24.027612 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:37:24.029661 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:37:24.030399 [info ] [MainThread]: 
[0m20:37:24.031084 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:37:24.031734 [info ] [MainThread]: 
[0m20:37:24.041300 [error] [MainThread]: [31mFailure in test test_singular_nao_negativo (tests/test_singular_nao_negativo.sql)[0m
[0m20:37:24.042231 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:37:24.042885 [info ] [MainThread]: 
[0m20:37:24.043496 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/tests/test_singular_nao_negativo.sql
[0m20:37:24.044154 [info ] [MainThread]: 
[0m20:37:24.044855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:37:24.045881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f188490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f17bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812f0155b0>]}


============================== 2022-08-15 20:40:01.849749 | 1ac68123-17ce-4bf4-a427-58a9fbb5a0a3 ==============================
[0m20:40:01.849788 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:40:01.850677 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:40:01.851069 [debug] [MainThread]: Tracking: tracking
[0m20:40:01.893202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d33c71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d33c72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d33c72e0>]}
[0m20:40:02.127521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:02.130848 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests/test_singular_nao_negativo.sql
[0m20:40:02.250751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac68123-17ce-4bf4-a427-58a9fbb5a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3279130>]}
[0m20:40:02.279946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac68123-17ce-4bf4-a427-58a9fbb5a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3345f70>]}
[0m20:40:02.280852 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:40:02.281732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac68123-17ce-4bf4-a427-58a9fbb5a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3276f10>]}
[0m20:40:02.289624 [info ] [MainThread]: 
[0m20:40:02.291335 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:40:02.331189 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:40:02.461954 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:40:02.463453 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:40:02.464114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:02.475511 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:03.985845 [debug] [ThreadPool]: SQL status: BEGIN in 1.52 seconds
[0m20:40:03.986457 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:40:03.986843 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:40:04.114834 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:40:04.118596 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:40:04.236496 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:40:04.252393 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:04.252851 [debug] [MainThread]: On master: BEGIN
[0m20:40:04.253168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:04.253480 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:05.394101 [debug] [MainThread]: SQL status: BEGIN in 1.14 seconds
[0m20:40:05.394712 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:05.395152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:05.552541 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:40:05.555213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac68123-17ce-4bf4-a427-58a9fbb5a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3345df0>]}
[0m20:40:05.555882 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:05.671759 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:05.672220 [debug] [MainThread]: On master: BEGIN
[0m20:40:05.920421 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
[0m20:40:05.920980 [debug] [MainThread]: On master: COMMIT
[0m20:40:05.921282 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:05.921558 [debug] [MainThread]: On master: COMMIT
[0m20:40:06.036188 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m20:40:06.037006 [debug] [MainThread]: On master: Close
[0m20:40:06.039097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:06.040029 [info ] [MainThread]: 
[0m20:40:06.058850 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:40:06.059703 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:40:06.061459 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:40:06.062040 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:40:06.062841 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:40:06.242937 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:40:06.244295 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:06.245035 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:40:06.410922 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:40:06.412595 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:40:06.423515 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:40:06.425537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:06.426312 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:07.532198 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:40:07.533634 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:40:07.534561 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:40:07.654168 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:40:07.658494 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:07.658981 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:40:07.774682 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:40:07.776139 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.72s]
[0m20:40:07.777721 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:40:07.778436 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:40:07.779271 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:40:07.780817 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:40:07.781704 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:40:07.782252 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:40:07.797812 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:40:07.801499 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:07.803605 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:40:07.814707 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:40:07.816376 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:40:07.817035 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:40:07.817607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:07.818147 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:08.954630 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m20:40:08.955274 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:40:08.955722 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:40:09.081941 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:40:09.087257 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:09.090788 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:40:09.208893 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:40:09.210579 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.43s]
[0m20:40:09.212012 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:40:09.212701 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:40:09.213498 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m20:40:09.215006 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:40:09.215774 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:40:09.216600 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:40:09.223477 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:40:09.231605 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:09.232322 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:40:09.243204 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:40:09.250238 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:40:09.251027 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:40:09.251438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:09.251922 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:10.356257 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:40:10.356871 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:40:10.357242 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:40:10.479181 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:40:10.483406 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:10.484404 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:40:10.606166 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:40:10.607583 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.39s]
[0m20:40:10.608688 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:40:10.609253 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:40:10.610150 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:40:10.611283 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:40:10.611837 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:40:10.612313 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:40:10.635685 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:40:10.639813 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:10.640433 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:40:10.654399 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:40:10.655696 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:40:10.656148 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:40:10.656551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:10.656990 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:11.766017 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:40:11.766576 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:40:11.767069 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:11.891254 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:40:11.893844 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:11.894194 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:40:12.012430 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:40:12.013548 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.40s]
[0m20:40:12.014480 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:40:12.015114 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:40:12.015738 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:40:12.016752 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:40:12.017304 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:40:12.017827 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:40:12.035194 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:40:12.036640 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:12.038935 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:40:12.057279 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:40:12.058748 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:40:12.059286 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:40:12.059612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:12.059956 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:13.150115 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:40:13.150571 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:40:13.150898 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:13.271491 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:40:13.279668 [debug] [Thread-1  ]: finished collecting timing info
[0m20:40:13.280445 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:40:13.397801 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:40:13.399120 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.38s]
[0m20:40:13.400147 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:40:13.403616 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:40:13.404376 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:13.404879 [debug] [MainThread]: On master: BEGIN
[0m20:40:13.406504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:13.408162 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:40:14.864604 [debug] [MainThread]: SQL status: BEGIN in 1.46 seconds
[0m20:40:14.865181 [debug] [MainThread]: On master: COMMIT
[0m20:40:14.865601 [debug] [MainThread]: Using redshift connection "master"
[0m20:40:14.865923 [debug] [MainThread]: On master: COMMIT
[0m20:40:14.981794 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:40:14.982240 [debug] [MainThread]: On master: Close
[0m20:40:14.983347 [info ] [MainThread]: 
[0m20:40:14.983899 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 12.69 seconds (12.69s).
[0m20:40:14.984553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:14.984893 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:40:15.020422 [info ] [MainThread]: 
[0m20:40:15.021209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:15.022257 [info ] [MainThread]: 
[0m20:40:15.023126 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:40:15.024233 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:40:15.024949 [info ] [MainThread]: 
[0m20:40:15.025724 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:40:15.026527 [info ] [MainThread]: 
[0m20:40:15.027233 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:40:15.028297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d33e44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d33e44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3258580>]}


============================== 2022-08-15 20:47:41.918554 | e425cb46-8890-473e-a9ce-5b27b7827327 ==============================
[0m20:47:41.918587 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:47:41.919480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:47:41.919881 [debug] [MainThread]: Tracking: tracking
[0m20:47:41.958882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda497220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda4972e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda497310>]}
[0m20:47:42.085244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:47:42.085970 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros/test_nao_negativo.sql
[0m20:47:42.086598 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
[0m20:47:42.086938 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m20:47:42.234454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e425cb46-8890-473e-a9ce-5b27b7827327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda333be0>]}
[0m20:47:42.254234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e425cb46-8890-473e-a9ce-5b27b7827327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda38af10>]}
[0m20:47:42.254942 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:47:42.255470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e425cb46-8890-473e-a9ce-5b27b7827327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda38afd0>]}
[0m20:47:42.265550 [info ] [MainThread]: 
[0m20:47:42.267479 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:47:42.273241 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:47:42.341174 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:47:42.341975 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:47:42.343295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:42.344069 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:43.652028 [debug] [ThreadPool]: SQL status: BEGIN in 1.31 seconds
[0m20:47:43.652542 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:47:43.652818 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:47:43.783907 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:47:43.788185 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:47:43.904057 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:47:43.919008 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:43.919363 [debug] [MainThread]: On master: BEGIN
[0m20:47:43.919643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:43.919962 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:44.991543 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m20:47:44.992450 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:44.994892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:45.151753 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:47:45.154341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e425cb46-8890-473e-a9ce-5b27b7827327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda4094c0>]}
[0m20:47:45.155005 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:45.270881 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:45.271280 [debug] [MainThread]: On master: BEGIN
[0m20:47:45.504998 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m20:47:45.507297 [debug] [MainThread]: On master: COMMIT
[0m20:47:45.508119 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:45.508882 [debug] [MainThread]: On master: COMMIT
[0m20:47:45.627177 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:47:45.627652 [debug] [MainThread]: On master: Close
[0m20:47:45.629522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:45.631136 [info ] [MainThread]: 
[0m20:47:45.646608 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:47:45.647356 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m20:47:45.650617 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:47:45.652328 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:47:45.653282 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:47:45.859911 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:45.861675 [debug] [Thread-1  ]: Compilation Error in test nao_negativo_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:47:45.863765 [error] [Thread-1  ]: 1 of 7 ERROR nao_negativo_tb_10_compradores_vendas_totais ...................... [[31mERROR[0m in 0.21s]
[0m20:47:45.867143 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:47:45.871782 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:47:45.878616 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:47:45.882362 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:47:45.883372 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:47:45.884328 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:47:45.964081 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:47:45.967108 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:45.971417 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:47:46.030507 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:47:46.036283 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:47:46.038452 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:47:46.039211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:46.039703 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:47.128448 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:47:47.128945 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:47:47.129188 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:47:47.247647 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:47:47.254909 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:47.255341 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:47:47.440450 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:47:47.442454 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.56s]
[0m20:47:47.444446 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:47:47.445148 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:47:47.446856 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:47:47.448536 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:47:47.449188 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:47:47.449756 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:47:47.478129 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:47:47.489773 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:47.490428 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:47:47.497421 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:47:47.509054 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:47:47.509670 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:47:47.510143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:47.510557 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:48.679489 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m20:47:48.679986 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:47:48.680324 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:47:48.806411 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:47:48.810488 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:48.811042 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:47:48.929717 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:47:48.931038 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.48s]
[0m20:47:48.932114 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:47:48.932783 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:47:48.933583 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m20:47:48.936381 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:47:48.937956 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:47:48.939136 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:47:48.952102 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:47:48.954152 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:48.954614 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:47:48.963166 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:47:48.964242 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:47:48.964553 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m20:47:48.964830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:48.965139 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:50.067580 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:47:50.069374 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:47:50.070436 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m20:47:50.356748 [debug] [Thread-1  ]: SQL status: SELECT in 0.29 seconds
[0m20:47:50.360271 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:50.360695 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m20:47:50.477194 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m20:47:50.478631 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.54s]
[0m20:47:50.479914 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:47:50.480574 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:47:50.481374 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m20:47:50.482767 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:47:50.483350 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:47:50.483878 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:47:50.494358 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:47:50.495723 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:50.496336 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:47:50.517987 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:47:50.521433 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:47:50.522180 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:47:50.523513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:50.525446 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:51.696154 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m20:47:51.696863 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:47:51.697356 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:47:51.818248 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:47:51.824889 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:51.827415 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:47:51.948294 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:47:51.950114 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.47s]
[0m20:47:51.951867 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:47:51.952837 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:47:51.954096 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:47:51.957497 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:47:51.958509 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:47:51.959413 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:47:51.998163 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:47:51.999061 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:51.999463 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:47:52.010669 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:47:52.011902 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:47:52.012357 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:47:52.012737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:52.013287 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:53.099328 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:47:53.099755 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:47:53.100084 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:47:53.219431 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:47:53.225783 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:53.228225 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:47:53.345631 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:47:53.347556 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.39s]
[0m20:47:53.349209 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:47:53.350073 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:47:53.351258 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:47:53.353464 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:47:53.354294 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:47:53.355086 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:47:53.381125 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:47:53.382261 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:53.382907 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:47:53.400116 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:47:53.401034 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:47:53.401349 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:47:53.401706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:53.401977 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:54.741984 [debug] [Thread-1  ]: SQL status: BEGIN in 1.34 seconds
[0m20:47:54.743376 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:47:54.745811 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:47:54.868443 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:47:54.871355 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:54.871709 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:47:54.989528 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:47:54.990899 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.64s]
[0m20:47:54.993650 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:47:54.998750 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:47:54.999472 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:55.001362 [debug] [MainThread]: On master: BEGIN
[0m20:47:55.001877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:55.002305 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:47:56.120192 [debug] [MainThread]: SQL status: BEGIN in 1.12 seconds
[0m20:47:56.120650 [debug] [MainThread]: On master: COMMIT
[0m20:47:56.120917 [debug] [MainThread]: Using redshift connection "master"
[0m20:47:56.121187 [debug] [MainThread]: On master: COMMIT
[0m20:47:56.241409 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:47:56.242758 [debug] [MainThread]: On master: Close
[0m20:47:56.245775 [info ] [MainThread]: 
[0m20:47:56.247927 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 13.98 seconds (13.98s).
[0m20:47:56.251440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:56.253400 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:47:56.284680 [info ] [MainThread]: 
[0m20:47:56.285284 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:47:56.286207 [info ] [MainThread]: 
[0m20:47:56.287105 [error] [MainThread]: [33mCompilation Error in test nao_negativo_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
[0m20:47:56.287907 [error] [MainThread]:   'test_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:47:56.288704 [info ] [MainThread]: 
[0m20:47:56.289359 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:47:56.290129 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:47:56.297423 [info ] [MainThread]: 
[0m20:47:56.299766 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:47:56.300715 [info ] [MainThread]: 
[0m20:47:56.301714 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m20:47:56.302824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda38af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda38a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dda38ac40>]}


============================== 2022-08-15 20:49:03.327560 | bf18079f-4b00-4c43-b060-9fcbe93041d8 ==============================
[0m20:49:03.327595 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:49:03.328498 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:49:03.329994 [debug] [MainThread]: Tracking: tracking
[0m20:49:03.366201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c479a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c479a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c479a340>]}
[0m20:49:03.652456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:03.655592 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/test_nao_negativo.sql
[0m20:49:03.657233 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m20:49:03.694452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf18079f-4b00-4c43-b060-9fcbe93041d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c46adc40>]}
[0m20:49:03.711872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf18079f-4b00-4c43-b060-9fcbe93041d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c4697bb0>]}
[0m20:49:03.714902 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 290 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:49:03.715792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf18079f-4b00-4c43-b060-9fcbe93041d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c46fa4c0>]}
[0m20:49:03.721630 [info ] [MainThread]: 
[0m20:49:03.723270 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:49:03.738002 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:49:03.829085 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:49:03.829679 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:49:03.830072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.830501 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:05.123128 [debug] [ThreadPool]: SQL status: BEGIN in 1.29 seconds
[0m20:49:05.123799 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:49:05.124129 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:49:05.253630 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:49:05.258106 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:49:05.376723 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:49:05.393085 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:05.393663 [debug] [MainThread]: On master: BEGIN
[0m20:49:05.393998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:05.394466 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:06.486292 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:49:06.486889 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:06.487277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:06.644713 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:49:06.648193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf18079f-4b00-4c43-b060-9fcbe93041d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c4697670>]}
[0m20:49:06.648934 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:06.764877 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:06.765452 [debug] [MainThread]: On master: BEGIN
[0m20:49:07.000075 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m20:49:07.000621 [debug] [MainThread]: On master: COMMIT
[0m20:49:07.000948 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:07.001219 [debug] [MainThread]: On master: COMMIT
[0m20:49:07.117269 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:49:07.117871 [debug] [MainThread]: On master: Close
[0m20:49:07.119164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:07.119813 [info ] [MainThread]: 
[0m20:49:07.128986 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:07.130121 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m20:49:07.131554 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:07.132136 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:07.132700 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:07.176406 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:07.177807 [debug] [Thread-1  ]: Compilation Error in test nao_negativo_tb_10_compradores_vendas_totais (models/example/schema.yml)
  'test_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:49:07.178857 [error] [Thread-1  ]: 1 of 7 ERROR nao_negativo_tb_10_compradores_vendas_totais ...................... [[31mERROR[0m in 0.05s]
[0m20:49:07.184318 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:07.185417 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:07.186721 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:49:07.189403 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:07.191629 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:07.192375 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:07.264617 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:07.266006 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:07.266526 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:07.415995 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:07.417271 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:07.425101 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:49:07.425815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:07.426313 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:08.519484 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:49:08.519940 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:08.520241 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:49:08.639115 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:08.643878 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:08.644304 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:49:08.760640 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:49:08.762487 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.57s]
[0m20:49:08.763673 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:08.764284 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:08.765037 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:49:08.766218 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:08.766744 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:08.767267 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:08.786096 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:08.787183 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:08.791234 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:08.799550 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:08.800737 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:08.801138 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:49:08.801516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:08.801887 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:09.911610 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m20:49:09.912216 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:09.912574 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:49:10.043619 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:49:10.048904 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:10.049637 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:49:10.168857 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:49:10.170640 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.40s]
[0m20:49:10.171980 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:10.172648 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:10.173129 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m20:49:10.174901 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:10.175611 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:10.176224 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:10.204554 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:10.206119 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:10.206786 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:10.218953 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:10.220408 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:10.222157 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m20:49:10.222765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:10.223365 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:11.356426 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m20:49:11.356862 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:11.357188 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m20:49:11.479244 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:11.487152 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:11.488454 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m20:49:11.612593 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m20:49:11.615675 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.44s]
[0m20:49:11.618439 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:11.620270 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:11.622484 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m20:49:11.626053 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:11.627555 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:11.632190 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:49:11.645065 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:11.646490 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:11.647087 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:11.654027 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:11.655250 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:11.655702 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:49:11.656062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:11.656377 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:12.751625 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:49:12.752265 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:12.752722 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:49:12.881378 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:49:12.889612 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:12.890606 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:49:13.013684 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:49:13.016672 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.39s]
[0m20:49:13.019154 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:13.020729 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:13.023049 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:49:13.029729 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:13.030793 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:13.031643 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:13.061772 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:13.062716 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:13.063114 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:13.069757 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:13.071244 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:13.071950 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:49:13.072481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:13.072954 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:14.368786 [debug] [Thread-1  ]: SQL status: BEGIN in 1.3 seconds
[0m20:49:14.370105 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:14.370899 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:14.493879 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:14.502347 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:14.503355 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:49:14.641169 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:49:14.644205 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.62s]
[0m20:49:14.646810 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:14.648376 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:14.650688 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:49:14.660235 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:14.662028 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:14.663250 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:14.683413 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:14.684786 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:14.685335 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:14.694003 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:14.695152 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:14.695648 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:49:14.696007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:14.696377 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:16.009927 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
[0m20:49:16.010368 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:16.010605 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:16.234965 [debug] [Thread-1  ]: SQL status: SELECT in 0.22 seconds
[0m20:49:16.237655 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:16.238010 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:49:16.359675 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:49:16.362891 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.71s]
[0m20:49:16.365855 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:16.378315 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:49:16.380370 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:16.381458 [debug] [MainThread]: On master: BEGIN
[0m20:49:16.382480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:16.383503 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:17.616231 [debug] [MainThread]: SQL status: BEGIN in 1.23 seconds
[0m20:49:17.617376 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.618152 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:17.618933 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.750560 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m20:49:17.751393 [debug] [MainThread]: On master: Close
[0m20:49:17.753371 [info ] [MainThread]: 
[0m20:49:17.754397 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 14.03 seconds (14.03s).
[0m20:49:17.755716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:17.756305 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:49:17.789182 [info ] [MainThread]: 
[0m20:49:17.789976 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:49:17.791091 [info ] [MainThread]: 
[0m20:49:17.791867 [error] [MainThread]: [33mCompilation Error in test nao_negativo_tb_10_compradores_vendas_totais (models/example/schema.yml)[0m
[0m20:49:17.792620 [error] [MainThread]:   'test_nao_negativo' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:49:17.793240 [info ] [MainThread]: 
[0m20:49:17.794048 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:49:17.794832 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:49:17.795584 [info ] [MainThread]: 
[0m20:49:17.796318 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:49:17.798149 [info ] [MainThread]: 
[0m20:49:17.800273 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m20:49:17.802168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c469b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c3e28ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c3e28700>]}


============================== 2022-08-15 20:49:49.355315 | da15284d-2f43-4684-99c7-6f1913f0b184 ==============================
[0m20:49:49.355348 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:49:49.356144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:49:49.356523 [debug] [MainThread]: Tracking: tracking
[0m20:49:49.389809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b93160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b93220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b93250>]}
[0m20:49:49.529646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:49.530572 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/test_nao_negativo.sql
[0m20:49:49.530931 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m20:49:49.560368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da15284d-2f43-4684-99c7-6f1913f0b184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99a53c10>]}
[0m20:49:49.576184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da15284d-2f43-4684-99c7-6f1913f0b184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b0efd0>]}
[0m20:49:49.576873 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:49:49.577386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da15284d-2f43-4684-99c7-6f1913f0b184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b0ef40>]}
[0m20:49:49.583025 [info ] [MainThread]: 
[0m20:49:49.584524 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:49:49.588739 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:49:49.636652 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:49:49.637100 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:49:49.637424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:49.637737 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:50.740583 [debug] [ThreadPool]: SQL status: BEGIN in 1.1 seconds
[0m20:49:50.741666 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:49:50.742469 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:49:50.869989 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:49:50.875140 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:49:50.991565 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:49:51.005226 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:51.005668 [debug] [MainThread]: On master: BEGIN
[0m20:49:51.006013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:51.006298 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:52.089652 [debug] [MainThread]: SQL status: BEGIN in 1.08 seconds
[0m20:49:52.090740 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:52.091511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:52.248903 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:49:52.256451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da15284d-2f43-4684-99c7-6f1913f0b184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b0eb50>]}
[0m20:49:52.257996 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:52.375999 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:52.377113 [debug] [MainThread]: On master: BEGIN
[0m20:49:52.611000 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m20:49:52.612169 [debug] [MainThread]: On master: COMMIT
[0m20:49:52.612953 [debug] [MainThread]: Using redshift connection "master"
[0m20:49:52.613674 [debug] [MainThread]: On master: COMMIT
[0m20:49:52.729867 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:49:52.730624 [debug] [MainThread]: On master: Close
[0m20:49:52.732318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:52.733348 [info ] [MainThread]: 
[0m20:49:52.750230 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:52.751086 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m20:49:52.752398 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:52.753025 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:52.753682 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:52.785758 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:52.786997 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:52.790720 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:52.964395 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:52.965832 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:52.966279 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m20:49:52.966653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:52.967032 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:54.043527 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m20:49:54.045187 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:49:54.046360 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
[0m20:49:54.169211 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:54.182129 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:54.183737 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m20:49:54.305386 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m20:49:54.307800 [info ] [Thread-1  ]: 1 of 7 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 1.56s]
[0m20:49:54.309703 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:49:54.310672 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:54.311970 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:49:54.313644 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:54.314455 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:54.315373 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:54.345935 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:54.346836 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:54.347224 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:54.353548 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:54.355145 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:54.356363 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:49:54.357207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:54.358145 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:55.453867 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:49:55.455008 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:55.455731 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:49:55.577199 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:55.584657 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:55.585786 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:49:55.704636 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:49:55.705895 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.39s]
[0m20:49:55.706897 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:55.707444 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:55.707922 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:49:55.709475 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:55.710003 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:55.710510 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:55.722509 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:55.723643 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:55.724214 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:55.731625 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:55.732924 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:55.733417 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:49:55.733775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:55.734184 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:56.871335 [debug] [Thread-1  ]: SQL status: BEGIN in 1.14 seconds
[0m20:49:56.872476 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:56.873341 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:49:57.000204 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:49:57.008040 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:57.009276 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:49:57.130057 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:49:57.132986 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.42s]
[0m20:49:57.135372 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:57.137000 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:57.139131 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m20:49:57.150572 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:57.152139 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:57.153248 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:57.165752 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:57.171217 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:57.171855 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:57.180203 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:57.182381 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:57.183118 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m20:49:57.183608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:57.184136 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:58.272946 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:49:58.274039 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:49:58.274793 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m20:49:58.396394 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:58.404215 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:58.405213 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m20:49:58.523345 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m20:49:58.524919 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.38s]
[0m20:49:58.525833 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:49:58.526398 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:58.527284 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m20:49:58.528448 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:58.529028 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:58.529590 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:49:58.534684 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:58.535734 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:58.536205 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:58.545257 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:58.546525 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:58.546880 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:49:58.547193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:58.547509 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:49:59.642427 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m20:49:59.642882 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:49:59.643167 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:49:59.763105 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:49:59.771347 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:59.772892 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:49:59.894263 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:49:59.896246 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.37s]
[0m20:49:59.897469 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:49:59.898497 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:59.899564 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:49:59.901223 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:59.901934 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:59.902805 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:59.926463 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:59.927723 [debug] [Thread-1  ]: finished collecting timing info
[0m20:49:59.928417 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:49:59.939944 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:59.941222 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:59.941693 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:49:59.942067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:59.942395 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:50:01.031395 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:50:01.031824 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:01.032130 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:01.152864 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:50:01.156958 [debug] [Thread-1  ]: finished collecting timing info
[0m20:50:01.157639 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:50:01.275777 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:50:01.277238 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.38s]
[0m20:50:01.278505 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:50:01.279305 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:01.280191 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:50:01.281629 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:01.282098 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:01.282483 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:01.298048 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:01.299446 [debug] [Thread-1  ]: finished collecting timing info
[0m20:50:01.300145 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:01.317477 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:01.318996 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:01.319502 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:50:01.319946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:01.320393 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:50:02.409185 [debug] [Thread-1  ]: SQL status: BEGIN in 1.09 seconds
[0m20:50:02.409635 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:02.409943 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:02.529269 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:50:02.532502 [debug] [Thread-1  ]: finished collecting timing info
[0m20:50:02.532919 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:50:02.651956 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:50:02.653792 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.37s]
[0m20:50:02.654926 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:02.658857 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:50:02.659528 [debug] [MainThread]: Using redshift connection "master"
[0m20:50:02.660023 [debug] [MainThread]: On master: BEGIN
[0m20:50:02.660447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:02.660896 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:50:03.749075 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:50:03.749762 [debug] [MainThread]: On master: COMMIT
[0m20:50:03.750178 [debug] [MainThread]: Using redshift connection "master"
[0m20:50:03.750585 [debug] [MainThread]: On master: COMMIT
[0m20:50:03.870820 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:50:03.871275 [debug] [MainThread]: On master: Close
[0m20:50:03.872706 [info ] [MainThread]: 
[0m20:50:03.873447 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m20:50:03.874257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:03.874761 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:50:03.899297 [info ] [MainThread]: 
[0m20:50:03.900410 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:03.901246 [info ] [MainThread]: 
[0m20:50:03.902024 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:50:03.903011 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:50:03.903662 [info ] [MainThread]: 
[0m20:50:03.904440 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:03.905282 [info ] [MainThread]: 
[0m20:50:03.910098 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:50:03.913496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd98167490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b0ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd99b0ed90>]}


============================== 2022-08-15 20:54:55.643645 | 162add6e-7a1b-4c9c-8722-b56c79d86b52 ==============================
[0m20:54:55.643679 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:54:55.644498 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:54:55.645248 [debug] [MainThread]: Tracking: tracking
[0m20:54:55.694652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf525700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf525f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf517070>]}
[0m20:54:55.855822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:55.857678 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
[0m20:54:56.121566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162add6e-7a1b-4c9c-8722-b56c79d86b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf3a9f40>]}
[0m20:54:56.155435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162add6e-7a1b-4c9c-8722-b56c79d86b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf409ac0>]}
[0m20:54:56.156216 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:54:56.156815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162add6e-7a1b-4c9c-8722-b56c79d86b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf409bb0>]}
[0m20:54:56.163350 [info ] [MainThread]: 
[0m20:54:56.164797 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:54:56.170787 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m20:54:56.247734 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:54:56.248527 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:54:56.249730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:56.262354 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:54:57.606217 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
[0m20:54:57.606855 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:54:57.607258 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:54:57.736284 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m20:54:57.741173 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:54:57.858137 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:54:57.872849 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:57.873224 [debug] [MainThread]: On master: BEGIN
[0m20:54:57.873454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:57.873698 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:54:58.960228 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m20:54:58.961033 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:58.961697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:59.121186 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m20:54:59.125400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162add6e-7a1b-4c9c-8722-b56c79d86b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf409f10>]}
[0m20:54:59.126067 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:59.244589 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:59.245573 [debug] [MainThread]: On master: BEGIN
[0m20:54:59.484801 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m20:54:59.485976 [debug] [MainThread]: On master: COMMIT
[0m20:54:59.486654 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:59.487150 [debug] [MainThread]: On master: COMMIT
[0m20:54:59.606784 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:54:59.607470 [debug] [MainThread]: On master: Close
[0m20:54:59.608515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:59.609254 [info ] [MainThread]: 
[0m20:54:59.624391 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:54:59.625060 [info ] [Thread-1  ]: 1 of 11 START test nao_negativo_tb_10_compradores_vendas_totais ................ [RUN]
[0m20:54:59.626481 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:54:59.626960 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:54:59.627496 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:54:59.647252 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:54:59.648579 [debug] [Thread-1  ]: finished collecting timing info
[0m20:54:59.649157 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:54:59.733325 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:54:59.734528 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:54:59.736106 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m20:54:59.736700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:54:59.737081 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:00.814126 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m20:55:00.814522 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m20:55:00.814842 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."tb_10_compradores"
    where vendas_totais < 0


      
    ) dbt_internal_test
[0m20:55:00.942413 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:55:00.948546 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:00.949169 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m20:55:01.092888 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m20:55:01.094368 [info ] [Thread-1  ]: 1 of 11 PASS nao_negativo_tb_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.47s]
[0m20:55:01.095886 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m20:55:01.096582 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m20:55:01.097496 [info ] [Thread-1  ]: 2 of 11 START test nao_negativo_vw_sales_comissao .............................. [RUN]
[0m20:55:01.099185 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m20:55:01.099808 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m20:55:01.100365 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m20:55:01.117880 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m20:55:01.119036 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:01.119658 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m20:55:01.137309 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m20:55:01.139304 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m20:55:01.141127 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
[0m20:55:01.142618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:01.144168 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:02.511043 [debug] [Thread-1  ]: SQL status: BEGIN in 1.37 seconds
[0m20:55:02.511645 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m20:55:02.512219 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where comissao < 0


      
    ) dbt_internal_test
[0m20:55:06.472037 [debug] [Thread-1  ]: SQL status: SELECT in 3.96 seconds
[0m20:55:06.475174 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:06.475865 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
[0m20:55:06.595903 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
[0m20:55:06.599003 [info ] [Thread-1  ]: 2 of 11 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 5.50s]
[0m20:55:06.600419 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m20:55:06.601096 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m20:55:06.601898 [info ] [Thread-1  ]: 3 of 11 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
[0m20:55:06.603333 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m20:55:06.603825 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m20:55:06.604370 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m20:55:06.618821 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m20:55:06.620234 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:06.620754 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m20:55:06.627398 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m20:55:06.665344 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m20:55:06.667116 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
[0m20:55:06.667989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:06.668492 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:07.983774 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
[0m20:55:07.984842 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m20:55:07.985606 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "dev"."public"."vw_sales"
    where valor_pago < 0


      
    ) dbt_internal_test
[0m20:55:12.093647 [debug] [Thread-1  ]: SQL status: SELECT in 4.11 seconds
[0m20:55:12.096641 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:12.097032 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
[0m20:55:12.250077 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
[0m20:55:12.254090 [info ] [Thread-1  ]: 3 of 11 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 5.65s]
[0m20:55:12.255516 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m20:55:12.256081 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:55:12.256543 [info ] [Thread-1  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m20:55:12.258187 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:55:12.258845 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:55:12.259328 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:55:12.287198 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:55:12.292416 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:12.293263 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:55:12.301716 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:55:12.305850 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:55:12.309544 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:55:12.311978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:12.312643 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:13.469831 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m20:55:13.470420 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:55:13.470912 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:55:13.615754 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
[0m20:55:13.622237 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:13.623359 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:55:13.753377 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:55:13.758583 [error] [Thread-1  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.50s]
[0m20:55:13.760431 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:55:13.761168 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:55:13.761831 [info ] [Thread-1  ]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m20:55:13.763025 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:55:13.763439 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:55:13.763918 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:55:13.792717 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:55:13.794017 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:13.794915 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:55:13.812651 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:55:13.813847 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:55:13.814298 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:55:13.814652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:13.815061 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:15.143667 [debug] [Thread-1  ]: SQL status: BEGIN in 1.33 seconds
[0m20:55:15.144088 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m20:55:15.144347 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:55:15.274365 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:55:15.280584 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:15.281227 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:55:15.398094 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:55:15.399456 [info ] [Thread-1  ]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.64s]
[0m20:55:15.400348 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m20:55:15.401076 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:55:15.402007 [info ] [Thread-1  ]: 6 of 11 START test not_null_tb_10_compradores_vendas_totais .................... [RUN]
[0m20:55:15.403464 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:55:15.404115 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:55:15.404633 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:55:15.425985 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:55:15.427890 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:15.428693 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:55:15.437117 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:55:15.439592 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:55:15.441651 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m20:55:15.443265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:15.444198 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:16.562858 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m20:55:16.563444 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m20:55:16.563799 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m20:55:16.692105 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:55:16.696339 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:16.696738 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m20:55:16.829174 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m20:55:16.831207 [info ] [Thread-1  ]: 6 of 11 PASS not_null_tb_10_compradores_vendas_totais .......................... [[32mPASS[0m in 1.43s]
[0m20:55:16.832678 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m20:55:16.833434 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m20:55:16.834324 [info ] [Thread-1  ]: 7 of 11 START test not_null_vw_sales_comissao .................................. [RUN]
[0m20:55:16.835814 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m20:55:16.836432 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m20:55:16.836953 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m20:55:16.863308 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m20:55:16.881960 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:16.882538 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m20:55:16.896544 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m20:55:16.901746 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m20:55:16.902236 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
[0m20:55:16.902721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:16.903113 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:18.033427 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m20:55:18.033888 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m20:55:18.034381 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
[0m20:55:18.254281 [debug] [Thread-1  ]: SQL status: SELECT in 0.22 seconds
[0m20:55:18.258533 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:18.260559 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
[0m20:55:18.378915 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
[0m20:55:18.380467 [info ] [Thread-1  ]: 7 of 11 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 1.55s]
[0m20:55:18.381838 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m20:55:18.382549 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m20:55:18.383550 [info ] [Thread-1  ]: 8 of 11 START test not_null_vw_sales_valor_pago ................................ [RUN]
[0m20:55:18.384957 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m20:55:18.385566 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m20:55:18.386111 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m20:55:18.409451 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m20:55:18.413268 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:18.414732 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m20:55:18.422693 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m20:55:18.426984 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m20:55:18.428633 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
[0m20:55:18.430012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:18.430868 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:19.593052 [debug] [Thread-1  ]: SQL status: BEGIN in 1.16 seconds
[0m20:55:19.594372 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m20:55:19.595404 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
[0m20:55:19.745013 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m20:55:19.750024 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:19.750392 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
[0m20:55:19.868624 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
[0m20:55:19.869962 [info ] [Thread-1  ]: 8 of 11 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 1.49s]
[0m20:55:19.870896 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m20:55:19.871704 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m20:55:19.872494 [info ] [Thread-1  ]: 9 of 11 START test test_singular_nao_negativo .................................. [RUN]
[0m20:55:19.873613 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:55:19.874137 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m20:55:19.874659 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m20:55:19.887497 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:55:19.888449 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:19.888850 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m20:55:19.898339 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m20:55:19.899546 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:55:19.899995 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m20:55:19.900333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:19.900731 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:21.085118 [debug] [Thread-1  ]: SQL status: BEGIN in 1.18 seconds
[0m20:55:21.086469 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m20:55:21.087216 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- testa se existe valores menores que 0 (negativos)

select *
    FROM tb_10_compradores
    WHERE vendas_totais < 0
      
    ) dbt_internal_test
[0m20:55:21.211451 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:55:21.222702 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:21.223538 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m20:55:21.341795 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m20:55:21.343129 [info ] [Thread-1  ]: 9 of 11 PASS test_singular_nao_negativo ........................................ [[32mPASS[0m in 1.47s]
[0m20:55:21.344727 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m20:55:21.346151 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:55:21.347621 [info ] [Thread-1  ]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m20:55:21.351315 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:55:21.352052 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:55:21.354738 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:55:21.389374 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:55:21.390213 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:21.390530 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:55:21.402483 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:55:21.404022 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:55:21.404613 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:55:21.405113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:21.405596 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:22.527620 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m20:55:22.528724 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m20:55:22.529697 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:55:22.660794 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m20:55:22.667801 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:22.668870 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:55:22.802455 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:55:22.803594 [info ] [Thread-1  ]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.45s]
[0m20:55:22.804525 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m20:55:22.805049 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:55:22.805713 [info ] [Thread-1  ]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m20:55:22.806925 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:55:22.807417 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:55:22.807928 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:55:22.824394 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:55:22.825752 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:22.826423 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:55:22.836111 [debug] [Thread-1  ]: Writing runtime SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:55:22.838438 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:55:22.840403 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:55:22.841050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:22.841588 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:24.233373 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m20:55:24.234709 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:55:24.235518 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:55:24.359542 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m20:55:24.372410 [debug] [Thread-1  ]: finished collecting timing info
[0m20:55:24.373653 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:55:24.495959 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:55:24.498093 [info ] [Thread-1  ]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.69s]
[0m20:55:24.501194 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m20:55:24.510011 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m20:55:24.510982 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:24.511752 [debug] [MainThread]: On master: BEGIN
[0m20:55:24.512396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:24.513042 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m20:55:25.669679 [debug] [MainThread]: SQL status: BEGIN in 1.16 seconds
[0m20:55:25.671077 [debug] [MainThread]: On master: COMMIT
[0m20:55:25.671514 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:25.671808 [debug] [MainThread]: On master: COMMIT
[0m20:55:25.789715 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m20:55:25.790273 [debug] [MainThread]: On master: Close
[0m20:55:25.791793 [info ] [MainThread]: 
[0m20:55:25.792429 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 29.63 seconds (29.63s).
[0m20:55:25.793054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:25.793430 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:55:25.819502 [info ] [MainThread]: 
[0m20:55:25.822198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:55:25.823198 [info ] [MainThread]: 
[0m20:55:25.828559 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m20:55:25.841882 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:55:25.842657 [info ] [MainThread]: 
[0m20:55:25.843431 [info ] [MainThread]:   compiled SQL at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:55:25.844362 [info ] [MainThread]: 
[0m20:55:25.845172 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m20:55:25.846353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf357340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf357550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98cf357700>]}
